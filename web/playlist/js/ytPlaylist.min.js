function debugMsg(e){DEBUG_MODE&&console.log("ytPlaylist::DEBUG::"+e)}function logMsg(e){console.log("ytPlaylist::"+e)}function handleNewSong(e,t,i,a){debugMsg("handleNewSong("+e+", "+t+", "+i+")"),$("#currentSongTable").html("<tr><th>Song Title</th><th>Requester</th><th>Duration</th><th>YouTube ID</th></tr><tr><td>"+e+"</td><td>"+i+"</td><td>"+t+"</td><td>"+a+"</td></tr>")}function handlePlayList(e){debugMsg("handlePlayList("+e+")"),$("#playlistTableTitle").html("Current Playlist: "+e.playlistname);var t="<tr><th>Song Title</th><th>Duration</th><th>YouTube ID</th></tr>";for(var i in e.playlist){var a=e.playlist[i].song,n=e.playlist[i].title,o=e.playlist[i].duration;t+="<tr><td>"+n+"</td><td>"+o+"</td><td>"+a+"</td></tr>"}$("#playlistTable").html(t)}function handleSongList(e){debugMsg("handleSongList("+e+")");var t="<tr><th>Song Title</th><th>Requester</th><th>Duration</th><th>YouTube ID</th></tr>";for(var i in e.songlist){var a=e.songlist[i].song,n=e.songlist[i].title,o=e.songlist[i].duration,r=e.songlist[i].requester;t+="<tr><td>"+n+"</td><td>"+r+"</td><td>"+o+"</td><td>"+a+"</td></tr>"}$("#songTable").html(t)}function newAlert(e,t,i,a){debugMsg("newAlert("+e+", "+t+", "+i+", "+a+")"),$(".alert").fadeIn(1e3),$("#newAlert").show().html('<div class="alert alert-'+i+'"><button type="button" class="close" data-dismiss="alert" aria-hidden="true"></button><span>'+e+" ["+t+"]</span></div>"),0!=a&&$(".alert-"+i).delay(a).fadeOut(1e3,function(){$(this).remove()})}function refreshData(){var e={};connectedToWS&&(e.query="currentsong",connection.send(JSON.stringify(e)),e.query="songlist",connection.send(JSON.stringify(e)),e.query="playlist",connection.send(JSON.stringify(e)))}var DEBUG_MODE=!1,connectedToWS=!1,url=window.location.host.split(":"),addr="ws://"+url[0]+":"+getPlayerPort(),connection=new WebSocket(addr,[]),currentVolume=0;connection.onopen=function(e){var t={};debugMsg("connection.onopen()"),connectedToWS=!0;var t={};t.readauth=getAuth(),connection.send(JSON.stringify(t)),debugMsg("onPlayerReady::connection.send("+JSON.stringify(t)+")")},connection.onclose=function(e){debugMsg("connection.onclose()"),connectedToWS=!1},connection.onmessage=function(e){try{var t=JSON.parse(e.data)}catch(i){return void logMsg("connection.onmessage: badJson("+e.data+"): "+i.message)}debugMsg("connection.onmessage("+e.data+")");{if(t.authresult!==!1)return t.authresult===!0&&refreshData(),void 0!==t.command&&void 0!==t.command.play?(handleNewSong(t.command.title,t.command.duration,t.command.requester),void refreshData()):void 0!==t.currentsong?void handleNewSong(t.currentsong.title,t.currentsong.duration,t.currentsong.requester,t.currentsong.song):void 0!==t.songlist?void handleSongList(t):void 0!==t.playlist?void handlePlayList(t):void 0;if(!t.authresult)return void newAlert("WS Auth Failed","Reload page, if that fails, let the caster know","danger",0)}},setInterval(refreshData,2e4);