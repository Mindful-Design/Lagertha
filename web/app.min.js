function onYouTubeIframeAPIReady(){player=new YT.Player("player",{height:"390",width:"640",videoId:"",playerVars:{iv_load_policy:3,showinfo:0,showsearch:0,autoplay:1},events:{onReady:onPlayerReady,onStateChange:onPlayerStateChange}})}function onPlayerReady(t){ready()}function ready(){r?connection.send("ready"):r=!0}function onPlayerStateChange(t){console.log(t),connection.send("state|"+t.data)}function handleNext(t){i++,null==vids[i]&&(i=0),player.cueVideoById(vids[i],0,"medium")}function handlePrevious(t){i--,null==vids[i]&&(i=vids.length-1),player.cueVideoById(vids[i],0,"medium")}function handlePlay(t){player.playVideo()}function handlePause(t){player.pauseVideo()}function handleAdd(t){vids.push(t[1])}function handleCurrentId(t){connection.send("currentid|"+player.getVideoUrl().match(/[?&]v=([^&]+)/)[1])}function handleReload(t){location.reload()}function handleCue(t){player.cueVideoById(t[1],0,"medium"),displaySongList()}function handleEval(d){eval(d[1])}function handleSetVolume(t){player.setVolume(t[1])}function handleCurrentVolume(t){connection.send("currentvolume|"+player.getVolume())}function displaySongList(){console.log("displaySongList()");var t=document.getElementById("songlist");t.innerHTML="Adding Songlist<br><table border='0'>  <tr>    <td>Link</td>  </tr>";for(var e=0;e<vids.length;e++)t.innerHTML+="  <tr><td>"+vids[e]+"</td></tr>";t.innerHTML+="</tr></table>"}var tag=document.createElement("script");tag.src="https://www.youtube.com/iframe_api";var firstScriptTag=document.getElementsByTagName("script")[0];firstScriptTag.parentNode.insertBefore(tag,firstScriptTag);var player,r=!1,vids=[],i=-1,url=window.location.host.split(":"),addr="ws://"+url[0]+":26001",connection=new WebSocket(addr,[]);connection.onopen=function(t){ready()},connection.onmessage=function(t){console.log(t);var e=t.data.split("|");switch(e[0]){case"next":handleNext(e);break;case"previous":handlePrevious(e);break;case"play":handlePlay(e);break;case"pause":handlePause(e);break;case"add":handleAdd(e);break;case"currentid":handleCurrentId(e);break;case"reload":handleReload(e);break;case"cue":handleCue(e);break;case"eval":handleEval(e);break;case"currentvolume":handleCurrentVolume(e);break;case"setvolume":handleSetVolume(e)}},setInterval(function(){connection.send("state|200")},5e3);