!function(){function y(e){var t;try{t=JSON.parse(e.data)}catch(n){return}if(panelHasQuery(t)){var p="",y="";if(panelCheckQuery(t,"greetings_greeting"))for(idx in t.results)p=t.results[idx].key,y=t.results[idx].value,panelMatch(p,"autoGreetEnabled")&&(a=y,$("#globalGreetings").html(i[y])),panelMatch(p,"defaultJoin")&&$("#greetingDefaultInput").val(y),panelMatch(p,"cooldown")&&$("#greetingCooldownInput").val(y/36e5);if(panelCheckQuery(t,"greetings_followReward")&&$("#followerRewardInput").val(t.results.followReward),panelCheckQuery(t,"greetings_followMessage")&&$("#followerGreetingInput").val(t.results.followMessage),panelCheckQuery(t,"greetings_followToggle")&&(followToggle=t.results.followToggle,$("#followerGreetings").html(i[t.results.followToggle])),panelCheckQuery(t,"greetings_followDelay")&&$("#followDelay").val(t.results.followDelay),panelCheckQuery(t,"greetings_donation"))for(idx in t.results)p=t.results[idx].key,y=t.results[idx].value,panelMatch(p,"announce")&&(s=y,$("#donationGreetings").html(i[y])),panelMatch(p,"donationGroup")&&(u=y,$("#donationGroup").html(i[y])),panelMatch(p,"donationGroupMin")&&$("#donationGroupMin").val(y),panelMatch(p,"reward")&&$("#donateRewardInput").val(y),panelMatch(p,"message")&&$("#donateGreetingInput").val(y);if(panelCheckQuery(t,"greetings_donationstreamtip"))for(idx in t.results)p=t.results[idx].key,y=t.results[idx].value,panelMatch(p,"announce")&&(l=y,$("#streamtipGreetings").html(i[y])),panelMatch(p,"donationGroup")&&(h=y,$("#streamtipdonationGroup").html(i[y])),panelMatch(p,"donationGroupMin")&&$("#streamtipdonationGroupMin").val(y),panelMatch(p,"reward")&&$("#streamtipdonateRewardInput").val(y),panelMatch(p,"message")&&$("#streamtipdonateGreetingInput").val(y);if(panelCheckQuery(t,"greetings_tipeeestream"))for(idx in t.results)p=t.results[idx].key,y=t.results[idx].value,panelMatch(p,"toggle")&&(m=y,$("#tipeeestreamGreetings").html(i[y])),panelMatch(p,"group")&&(g=y,$("#tipeeestreamdonationGroup").html(i[y])),panelMatch(p,"groupMin")&&$("#tipeeestreamdonationGroupMin").val(y),panelMatch(p,"reward")&&$("#tipeeestreamdonateRewardInput").val(y),panelMatch(p,"message")&&$("#tipeeestreamdonateGreetingInput").val(y);if(panelCheckQuery(t,"greetings_subscribers"))for(idx in t.results)p=t.results[idx].key,y=t.results[idx].value,panelMatch(p,"subscribeMessage")&&$("#subGreetingInput").val(y),panelMatch(p,"primeSubscribeMessage")&&$("#primeSubGreetingInput").val(y),panelMatch(p,"reSubscribeReward")&&$("#reSubRewardInput").val(y),panelMatch(p,"reSubscribeMessage")&&$("#resubGreetingInput").val(y),panelMatch(p,"subscriberWelcomeToggle")&&(o=y,$("#subscriptionGreetings").html(i[y])),panelMatch(p,"primeSubscriberWelcomeToggle")&&(d=y,$("#primeSubscriptionGreetings").html(i[y])),panelMatch(p,"reSubscriberWelcomeToggle")&&(r=y,$("#resubscriptionGreetings").html(i[y])),panelMatch(p,"subscribeReward")&&$("#subRewardInput").val(y),panelMatch(p,"resubEmote")&&$("#resubEmoteInput").val(y);if(panelCheckQuery(t,"greetings_gamewisp"))for(idx in t.results)p=t.results[idx].key,y=t.results[idx].value,panelMatch(p,"subscriberShowMessages")&&(c=y,$("#gameWispGreetings").html(i[y])),panelMatch(p,"subscribeMessage")&&$("#gwSubGreetingInput").val(y),panelMatch(p,"reSubscribeMessage")&&$("#gwResubGreetingInput").val(y),panelMatch(p,"tierUpMessage")&&$("#gwTierupGreetingInput").val(y),panelMatch(p,"subscribeReward")&&$("#gwSubRewardInput").val(y),panelMatch(p,"reSubscribeReward")&&$("#gwResubRewardInput").val(y);if(panelCheckQuery(t,"greetings_bits"))for(idx in t.results)p=t.results[idx].key,y=t.results[idx].value,panelMatch(p,"toggle")&&(f=y,$("#bitsToggle").html(i[y])),panelMatch(p,"message")&&$("#bitsMessage").val(y),panelMatch(p,"minimum")&&$("#bitsMinimum").val(y);if(panelCheckQuery(t,"greetings_gamewispTiers")){var v="",S="",b="<table class='table table-hover table-striped'>",k="<table class='table table-hover table-striped'>",T="<table class='table table-hover table-striped'>";for(idx in t.results)p=t.results[idx].key,y=t.results[idx].value,v=p[p.indexOf("_")+1],S="<tr >    <td>Tier "+v+'</td>    <td>        <input type="number" min="0" id="inline_'+p+'"               placeholder="'+y+'" value="'+y+'"               style="width: 8em" />        <button type="button" class="btn btn-info btn-fill btn-xs"                onclick="$.updateGWTierData(\''+p+'\')"><i class="fa fa-pencil" />        </button>    </td></tr>',p.startsWith("songrequest_")===!0&&(b+=S),p.startsWith("bonuspoints_")===!0&&(k+=S),p.startsWith("subbonuspoints_")===!0&&(T+=S);$("#gameWispSongRequests").html(b),$("#gameWispBonusPoints").html(k),$("#gameWispSubBonusPoints").html(T),handleInputFocus()}}}function v(){sendDBKeys("greetings_greeting","greeting"),sendDBQuery("greetings_followReward","settings","followReward"),sendDBQuery("greetings_followMessage","settings","followMessage"),sendDBQuery("greetings_followToggle","settings","followToggle"),sendDBQuery("greetings_followDelay","settings","followDelay"),sendDBKeys("greetings_donation","donations"),sendDBKeys("greetings_donationstreamtip","streamtip"),sendDBKeys("greetings_subscribers","subscribeHandler"),sendDBKeys("greetings_gamewisp","gameWispSubHandler"),sendDBKeys("greetings_gamewispTiers","gameWispTiers"),sendDBKeys("greetings_bits","bitsSettings"),sendDBKeys("greetings_tipeeestream","tipeeeStreamHandler")}function S(e){var t=$("#inline_"+e).val();t.length>0&&(sendDBUpdate("greetings_updateTier","gameWispTiers",e,t),setTimeout(function(){sendCommand("gamewisppanelupdate"),v()},TIMEOUT_WAIT_TIME))}function b(e,i){panelMatch(e,"greeting")&&($("#globalGreetings").html(t),"true"==a?sendDBUpdate("greetings_greeting","greeting","autoGreetEnabled","false"):sendDBUpdate("greetings_greeting","greeting","autoGreetEnabled","true"),setTimeout(function(){sendCommand("greetingspanelupdate")},TIMEOUT_WAIT_TIME)),panelMatch(e,"settings")&&($("#followerGreetings").html(t),"true"==followToggle?sendDBUpdate("greetings_greeting","settings","followToggle","false"):sendDBUpdate("greetings_greeting","settings","followToggle","true"),setTimeout(function(){sendCommand("followerpanelupdate")},TIMEOUT_WAIT_TIME)),panelMatch(e,"donations")&&($("#donationGreetings").html(t),"true"==s?sendDBUpdate("greetings_greeting","donations","announce","false"):sendDBUpdate("greetings_greeting","donations","announce","true"),setTimeout(function(){sendCommand("donationpanelupdate")},TIMEOUT_WAIT_TIME)),panelMatch(e,"streamtip")&&($("#streamtipGreetings").html(t),"true"==l?sendDBUpdate("greetings_greeting","streamtip","announce","false"):sendDBUpdate("greetings_greeting","streamtip","announce","true"),setTimeout(function(){sendCommand("donationpanelupdatestreamtip")},TIMEOUT_WAIT_TIME)),panelMatch(e,"tipeeestream")&&($("#tipeeestreamGreetings").html(t),"true"==m?sendDBUpdate("greetings_greeting","tipeeeStreamHandler","toggle","false"):sendDBUpdate("greetings_greeting","tipeeeStreamHandler","toggle","true"),setTimeout(function(){sendCommand("tipeeestreamreload")},TIMEOUT_WAIT_TIME)),panelMatch(e,"donationGroup")&&($("#donationGroup").html(t),"true"==u?sendDBUpdate("greetings_greeting","donations","donationGroup","false"):sendDBUpdate("greetings_greeting","donations","donationGroup","true"),setTimeout(function(){sendCommand("donationpanelupdate")},TIMEOUT_WAIT_TIME)),panelMatch(e,"streamtipdonationGroup")&&($("#streamtipdonationGroup").html(t),"true"==h?sendDBUpdate("greetings_greeting","streamtip","donationGroup","false"):sendDBUpdate("greetings_greeting","streamtip","donationGroup","true"),setTimeout(function(){sendCommand("donationpanelupdatestreamtip")},TIMEOUT_WAIT_TIME)),panelMatch(e,"tipeeestreamdonationGroup")&&($("#tipeeestreamdonationGroup").html(t),"true"==g?sendDBUpdate("greetings_greeting","tipeeeStreamHandler","group","false"):sendDBUpdate("greetings_greeting","tipeeeStreamHandler","group","true"),setTimeout(function(){sendCommand("tipeeestreamreload")},TIMEOUT_WAIT_TIME)),panelMatch(e,"subscribeHandler")&&panelMatch(i,"subscriberWelcomeToggle")&&($("#subscriptionGreetings").html(t),"true"==o?sendDBUpdate("greetings_greeting","subscribeHandler","subscriberWelcomeToggle","false"):sendDBUpdate("greetings_greeting","subscribeHandler","subscriberWelcomeToggle","true"),setTimeout(function(){sendCommand("subscriberpanelupdate")},TIMEOUT_WAIT_TIME)),panelMatch(e,"subscribeHandler")&&panelMatch(i,"primeSubscriberWelcomeToggle")&&($("#primeSubscriptionGreetings").html(t),"true"==d?sendDBUpdate("greetings_greeting","subscribeHandler","primeSubscriberWelcomeToggle","false"):sendDBUpdate("greetings_greeting","subscribeHandler","primeSubscriberWelcomeToggle","true"),setTimeout(function(){sendCommand("subscriberpanelupdate")},TIMEOUT_WAIT_TIME)),panelMatch(e,"subscribeHandler")&&panelMatch(i,"reSubscriberWelcomeToggle")&&($("#resubscriptionGreetings").html(t),"true"==r?sendDBUpdate("greetings_greeting","subscribeHandler","reSubscriberWelcomeToggle","false"):sendDBUpdate("greetings_greeting","subscribeHandler","reSubscriberWelcomeToggle","true"),setTimeout(function(){sendCommand("subscriberpanelupdate")},TIMEOUT_WAIT_TIME)),panelMatch(e,"bitsSettings")&&panelMatch(i,"toggle")&&($("#bitsToggle").html(t),"true"==f?sendDBUpdate("greetings_bits","bitsSettings","toggle","false"):sendDBUpdate("greetings_bits","bitsSettings","toggle","true"),setTimeout(function(){sendCommand("reloadbits")},TIMEOUT_WAIT_TIME)),panelMatch(e,"bitsSettings")&&panelMatch(i,"rewardMultToggle")&&($("#bitsRewardMultToggle").html(t),"true"==p?sendDBUpdate("greetings_bits","bitsSettings","rewardMultToggle","false"):sendDBUpdate("greetings_bits","bitsSettings","rewardMultToggle","true"),setTimeout(function(){sendCommand("reloadbits")},TIMEOUT_WAIT_TIME)),panelMatch(e,"gameWispSubHandler")&&($("#gameWispGreetings").html(t),"true"==c?sendDBUpdate("greetings_greeting","gameWispSubHandler","subscriberShowMessages","false"):sendDBUpdate("greetings_greeting","gameWispSubHandler","subscriberShowMessages","true"),setTimeout(function(){sendCommand("gamewisppanelupdate")},TIMEOUT_WAIT_TIME)),setTimeout(function(){v()},TIMEOUT_WAIT_TIME)}function k(e,t,i){var a=$("#"+e).val();return"greetingCooldownInput"==e&&a.length>0?(a=String(36e5*a),sendDBUpdate("greetings_update","greeting","cooldown",a),void setTimeout(function(){v(),sendCommand("greetingspanelupdate")},TIMEOUT_WAIT_TIME)):void(a.length>0&&(sendDBUpdate("greetings_update",t,i,a),panelMatch(t,"greeting")&&sendCommand("greetingspanelupdate"),panelMatch(t,"settings")&&sendCommand("followerpanelupdate"),panelMatch(t,"donations")&&sendCommand("donationpanelupdate"),panelMatch(t,"streamtip")&&sendCommand("donationpanelupdatestreamtip"),panelMatch(t,"subscribeHandler")&&sendCommand("subscriberpanelupdate"),panelMatch(t,"bitsSettings")&&sendCommand("reloadbits"),panelMatch(t,"tipeeeStreamHandler")&&sendCommand("tipeeestreamreload"),panelMatch(t,"gameWispSubHandler")&&sendCommand("gamewisppanelupdate"),setTimeout(function(){v()},2*TIMEOUT_WAIT_TIME)))}var t='<i  class="fa fa-spinner fa-spin" />',i=[];i["false"]='<i  class="fa fa-circle-o" />',i["true"]='<i  class="fa fa-circle text-success"/>';var a=!1,o=!1,r=!1,s=!1,l=!1,u=!1,h=!1,c=!1,d=!1,f=!1,p=!1,m=!1,g=!1;$("#greetingsPanel").load("/panel/greetings.html");var T=setInterval(function(){if(isConnected&&TABS_INITIALIZED){var e=$("#tabs").tabs("option","active");8==e&&(v(),clearInterval(T))}},INITIAL_WAIT_TIME);setInterval(function(){var e=$("#tabs").tabs("option","active");8==e&&isConnected&&!isInputFocus()&&(newPanelAlert("Refreshing Greeting Data","success",1e3),v())},3e4),$.greetingsOnMessage=y,$.greetingsDoQuery=v,$.toggleGreetings=b,$.updateGreetingData=k,$.updateGWTierData=S}();