!function(){function y(e){var t;try{t=JSON.parse(e.data)}catch(o){return}if(panelHasQuery(t)){var m="",y="";if(panelCheckQuery(t,"greetings_greeting"))for(idx in t.results)m=t.results[idx].key,y=t.results[idx].value,panelMatch(m,"autoGreetEnabled")&&(i=y,$("#globalGreetings").html(a[y])),panelMatch(m,"defaultJoin")&&$("#greetingDefaultInput").val(y),panelMatch(m,"cooldown")&&$("#greetingCooldownInput").val(y/36e5);if(panelCheckQuery(t,"greetings_followReward")&&$("#followerRewardInput").val(t.results.followReward),panelCheckQuery(t,"greetings_followMessage")&&$("#followerGreetingInput").val(t.results.followMessage),panelCheckQuery(t,"greetings_followToggle")&&(followToggle=t.results.followToggle,$("#followerGreetings").html(a[t.results.followToggle])),panelCheckQuery(t,"greetings_followDelay")&&$("#followDelay").val(t.results.followDelay),panelCheckQuery(t,"greetings_donation"))for(idx in t.results)m=t.results[idx].key,y=t.results[idx].value,panelMatch(m,"announce")&&(s=y,$("#donationGreetings").html(a[y])),panelMatch(m,"donationGroup")&&(u=y,$("#donationGroup").html(a[y])),panelMatch(m,"donationGroupMin")&&$("#donationGroupMin").val(y),panelMatch(m,"reward")&&$("#donateRewardInput").val(y),panelMatch(m,"message")&&$("#donateGreetingInput").val(y);if(panelCheckQuery(t,"greetings_donationstreamtip"))for(idx in t.results)m=t.results[idx].key,y=t.results[idx].value,panelMatch(m,"announce")&&(l=y,$("#streamtipGreetings").html(a[y])),panelMatch(m,"donationGroup")&&(h=y,$("#streamtipdonationGroup").html(a[y])),panelMatch(m,"donationGroupMin")&&$("#streamtipdonationGroupMin").val(y),panelMatch(m,"reward")&&$("#streamtipdonateRewardInput").val(y),panelMatch(m,"message")&&$("#streamtipdonateGreetingInput").val(y);if(panelCheckQuery(t,"greetings_tipeeestream"))for(idx in t.results)m=t.results[idx].key,y=t.results[idx].value,panelMatch(m,"toggle")&&(g=y,$("#tipeeestreamGreetings").html(a[y])),panelMatch(m,"group")&&(p=y,$("#tipeeestreamdonationGroup").html(a[y])),panelMatch(m,"groupMin")&&$("#tipeeestreamdonationGroupMin").val(y),panelMatch(m,"reward")&&$("#tipeeestreamdonateRewardInput").val(y),panelMatch(m,"message")&&$("#tipeeestreamdonateGreetingInput").val(y);if(panelCheckQuery(t,"greetings_subscribers"))for(idx in t.results)m=t.results[idx].key,y=t.results[idx].value,panelMatch(m,"subscribeMessage")&&$("#subGreetingInput").val(y),panelMatch(m,"primeSubscribeMessage")&&$("#primeSubGreetingInput").val(y),panelMatch(m,"reSubscribeReward")&&$("#reSubRewardInput").val(y),panelMatch(m,"reSubscribeMessage")&&$("#resubGreetingInput").val(y),panelMatch(m,"subscriberWelcomeToggle")&&(n=y,$("#subscriptionGreetings").html(a[y])),panelMatch(m,"primeSubscriberWelcomeToggle")&&(d=y,$("#primeSubscriptionGreetings").html(a[y])),panelMatch(m,"reSubscriberWelcomeToggle")&&(r=y,$("#resubscriptionGreetings").html(a[y])),panelMatch(m,"subscribeReward")&&$("#subRewardInput").val(y),panelMatch(m,"resubEmote")&&$("#resubEmoteInput").val(y);if(panelCheckQuery(t,"greetings_gamewisp"))for(idx in t.results)m=t.results[idx].key,y=t.results[idx].value,panelMatch(m,"subscriberShowMessages")&&(c=y,$("#gameWispGreetings").html(a[y])),panelMatch(m,"subscribeMessage")&&$("#gwSubGreetingInput").val(y),panelMatch(m,"reSubscribeMessage")&&$("#gwResubGreetingInput").val(y),panelMatch(m,"tierUpMessage")&&$("#gwTierupGreetingInput").val(y),panelMatch(m,"subscribeReward")&&$("#gwSubRewardInput").val(y),panelMatch(m,"reSubscribeReward")&&$("#gwResubRewardInput").val(y);if(panelCheckQuery(t,"greetings_bits"))for(idx in t.results)m=t.results[idx].key,y=t.results[idx].value,panelMatch(m,"toggle")&&(f=y,$("#bitsToggle").html(a[y])),panelMatch(m,"message")&&$("#bitsMessage").val(y),panelMatch(m,"minimum")&&$("#bitsMinimum").val(y);if(panelCheckQuery(t,"greetings_gamewispTiers")){var S="",T="",k="<table class='table table-hover table-striped'>",v="<table class='table table-hover table-striped'>",b="<table class='table table-hover table-striped'>";for(idx in t.results)m=t.results[idx].key,y=t.results[idx].value,S=m[m.indexOf("_")+1],T="<tr >    <td>Tier "+S+'</td>    <td>        <input type="number" min="0" id="inline_'+m+'"               placeholder="'+y+'" value="'+y+'"               style="width: 8em" />        <button type="button" class="btn btn-info btn-fill btn-xs"                onclick="$.updateGWTierData(\''+m+'\')"><i class="fa fa-pencil" />        </button>    </td></tr>',m.startsWith("songrequest_")===!0&&(k+=T),m.startsWith("bonuspoints_")===!0&&(v+=T),m.startsWith("subbonuspoints_")===!0&&(b+=T);$("#gameWispSongRequests").html(k),$("#gameWispBonusPoints").html(v),$("#gameWispSubBonusPoints").html(b),handleInputFocus()}}}function S(){sendDBKeys("greetings_greeting","greeting"),sendDBQuery("greetings_followReward","settings","followReward"),sendDBQuery("greetings_followMessage","settings","followMessage"),sendDBQuery("greetings_followToggle","settings","followToggle"),sendDBQuery("greetings_followDelay","settings","followDelay"),sendDBKeys("greetings_donation","donations"),sendDBKeys("greetings_donationstreamtip","streamtip"),sendDBKeys("greetings_subscribers","subscribeHandler"),sendDBKeys("greetings_gamewisp","gameWispSubHandler"),sendDBKeys("greetings_gamewispTiers","gameWispTiers"),sendDBKeys("greetings_bits","bitsSettings"),sendDBKeys("greetings_tipeeestream","tipeeeStreamHandler")}function T(e){var t=$("#inline_"+e).val();t.length>0&&(sendDBUpdate("greetings_updateTier","gameWispTiers",e,t),setTimeout(function(){sendCommand("gamewisppanelupdate"),S()},TIMEOUT_WAIT_TIME))}function k(e,a){panelMatch(e,"greeting")&&($("#globalGreetings").html(t),"true"==i?sendDBUpdate("greetings_greeting","greeting","autoGreetEnabled","false"):sendDBUpdate("greetings_greeting","greeting","autoGreetEnabled","true"),setTimeout(function(){sendCommand("greetingspanelupdate")},TIMEOUT_WAIT_TIME)),panelMatch(e,"settings")&&($("#followerGreetings").html(t),"true"==followToggle?sendDBUpdate("greetings_greeting","settings","followToggle","false"):sendDBUpdate("greetings_greeting","settings","followToggle","true"),setTimeout(function(){sendCommand("followerpanelupdate")},TIMEOUT_WAIT_TIME)),panelMatch(e,"donations")&&($("#donationGreetings").html(t),"true"==s?sendDBUpdate("greetings_greeting","donations","announce","false"):sendDBUpdate("greetings_greeting","donations","announce","true"),setTimeout(function(){sendCommand("donationpanelupdate")},TIMEOUT_WAIT_TIME)),panelMatch(e,"streamtip")&&($("#streamtipGreetings").html(t),"true"==l?sendDBUpdate("greetings_greeting","streamtip","announce","false"):sendDBUpdate("greetings_greeting","streamtip","announce","true"),setTimeout(function(){sendCommand("donationpanelupdatestreamtip")},TIMEOUT_WAIT_TIME)),panelMatch(e,"tipeeestream")&&($("#tipeeestreamGreetings").html(t),"true"==g?sendDBUpdate("greetings_greeting","tipeeeStreamHandler","toggle","false"):sendDBUpdate("greetings_greeting","tipeeeStreamHandler","toggle","true"),setTimeout(function(){sendCommand("tipeeestreamreload")},TIMEOUT_WAIT_TIME)),panelMatch(e,"donationGroup")&&($("#donationGroup").html(t),"true"==u?sendDBUpdate("greetings_greeting","donations","donationGroup","false"):sendDBUpdate("greetings_greeting","donations","donationGroup","true"),setTimeout(function(){sendCommand("donationpanelupdate")},TIMEOUT_WAIT_TIME)),panelMatch(e,"streamtipdonationGroup")&&($("#streamtipdonationGroup").html(t),"true"==h?sendDBUpdate("greetings_greeting","streamtip","donationGroup","false"):sendDBUpdate("greetings_greeting","streamtip","donationGroup","true"),setTimeout(function(){sendCommand("donationpanelupdatestreamtip")},TIMEOUT_WAIT_TIME)),panelMatch(e,"tipeeestreamdonationGroup")&&($("#tipeeestreamdonationGroup").html(t),"true"==p?sendDBUpdate("greetings_greeting","tipeeeStreamHandler","group","false"):sendDBUpdate("greetings_greeting","tipeeeStreamHandler","group","true"),setTimeout(function(){sendCommand("tipeeestreamreload")},TIMEOUT_WAIT_TIME)),panelMatch(e,"subscribeHandler")&&panelMatch(a,"subscriberWelcomeToggle")&&($("#subscriptionGreetings").html(t),"true"==n?sendDBUpdate("greetings_greeting","subscribeHandler","subscriberWelcomeToggle","false"):sendDBUpdate("greetings_greeting","subscribeHandler","subscriberWelcomeToggle","true"),setTimeout(function(){sendCommand("subscriberpanelupdate")},TIMEOUT_WAIT_TIME)),panelMatch(e,"subscribeHandler")&&panelMatch(a,"primeSubscriberWelcomeToggle")&&($("#primeSubscriptionGreetings").html(t),"true"==d?sendDBUpdate("greetings_greeting","subscribeHandler","primeSubscriberWelcomeToggle","false"):sendDBUpdate("greetings_greeting","subscribeHandler","primeSubscriberWelcomeToggle","true"),setTimeout(function(){sendCommand("subscriberpanelupdate")},TIMEOUT_WAIT_TIME)),panelMatch(e,"subscribeHandler")&&panelMatch(a,"reSubscriberWelcomeToggle")&&($("#resubscriptionGreetings").html(t),"true"==r?sendDBUpdate("greetings_greeting","subscribeHandler","reSubscriberWelcomeToggle","false"):sendDBUpdate("greetings_greeting","subscribeHandler","reSubscriberWelcomeToggle","true"),setTimeout(function(){sendCommand("subscriberpanelupdate")},TIMEOUT_WAIT_TIME)),panelMatch(e,"bitsSettings")&&panelMatch(a,"toggle")&&($("#bitsToggle").html(t),"true"==f?sendDBUpdate("greetings_bits","bitsSettings","toggle","false"):sendDBUpdate("greetings_bits","bitsSettings","toggle","true"),setTimeout(function(){sendCommand("reloadbits")},TIMEOUT_WAIT_TIME)),panelMatch(e,"bitsSettings")&&panelMatch(a,"rewardMultToggle")&&($("#bitsRewardMultToggle").html(t),"true"==m?sendDBUpdate("greetings_bits","bitsSettings","rewardMultToggle","false"):sendDBUpdate("greetings_bits","bitsSettings","rewardMultToggle","true"),setTimeout(function(){sendCommand("reloadbits")},TIMEOUT_WAIT_TIME)),panelMatch(e,"gameWispSubHandler")&&($("#gameWispGreetings").html(t),"true"==c?sendDBUpdate("greetings_greeting","gameWispSubHandler","subscriberShowMessages","false"):sendDBUpdate("greetings_greeting","gameWispSubHandler","subscriberShowMessages","true"),setTimeout(function(){sendCommand("gamewisppanelupdate")},TIMEOUT_WAIT_TIME)),setTimeout(function(){S()},TIMEOUT_WAIT_TIME)}function v(e,t,a){var i=$("#"+e).val();return"greetingCooldownInput"==e&&i.length>0?(i=String(36e5*i),sendDBUpdate("greetings_update","greeting","cooldown",i),void setTimeout(function(){S(),sendCommand("greetingspanelupdate")},TIMEOUT_WAIT_TIME)):void(i.length>0&&(sendDBUpdate("greetings_update",t,a,i),panelMatch(t,"greeting")&&sendCommand("greetingspanelupdate"),panelMatch(t,"settings")&&sendCommand("followerpanelupdate"),panelMatch(t,"donations")&&sendCommand("donationpanelupdate"),panelMatch(t,"streamtip")&&sendCommand("donationpanelupdatestreamtip"),panelMatch(t,"subscribeHandler")&&sendCommand("subscriberpanelupdate"),panelMatch(t,"bitsSettings")&&sendCommand("reloadbits"),panelMatch(t,"tipeeeStreamHandler")&&sendCommand("tipeeestreamreload"),panelMatch(t,"gameWispSubHandler")&&sendCommand("gamewisppanelupdate"),setTimeout(function(){S()},2*TIMEOUT_WAIT_TIME)))}var t='<i  class="fa fa-spinner fa-spin" />',a=[];a["false"]='<i  class="fa fa-circle text-warning" />',a["true"]='<i  class="fa fa-circle text-success"/>';var i=!1,n=!1,r=!1,s=!1,l=!1,u=!1,h=!1,c=!1,d=!1,f=!1,m=!1,g=!1,p=!1;$("#greetingsPanel").load("/panel/greetings.html");var b=setInterval(function(){if(isConnected&&TABS_INITIALIZED){var e=$("#tabs").tabs("option","active");8==e&&(S(),clearInterval(b))}},INITIAL_WAIT_TIME);setInterval(function(){var e=$("#tabs").tabs("option","active");8==e&&isConnected&&!isInputFocus()&&(newPanelAlert("Refreshing Greeting Data","success",1e3),S())},3e4),$.greetingsOnMessage=y,$.greetingsDoQuery=S,$.toggleGreetings=k,$.updateGreetingData=v,$.updateGWTierData=T}();