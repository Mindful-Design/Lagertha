!function(){function T(e){var a;try{a=JSON.parse(e.data)}catch(i){return}if(panelHasQuery(a)){var g="",T="";if(panelCheckQuery(a,"greetings_greeting"))for(idx in a.results)g=a.results[idx].key,T=a.results[idx].value,panelMatch(g,"autoGreetEnabled")&&(r=T,$("#globalGreetings").html(o[T])),panelMatch(g,"defaultJoin")&&$("#greetingDefaultInput").val(T),panelMatch(g,"cooldown")&&$("#greetingCooldownInput").val(T/36e5);if(panelCheckQuery(a,"greetings_followReward")&&$("#followerRewardInput").val(a.results.followReward),panelCheckQuery(a,"greetings_followMessage")&&$("#followerGreetingInput").val(a.results.followMessage),panelCheckQuery(a,"greetings_followToggle")&&(followToggle=a.results.followToggle,$("#followerGreetings").html(o[a.results.followToggle])),panelCheckQuery(a,"greetings_followDelay")&&$("#followDelay").val(a.results.followDelay),panelCheckQuery(a,"greetings_donation"))for(idx in a.results)g=a.results[idx].key,T=a.results[idx].value,panelMatch(g,"announce")&&(s=T,$("#donationGreetings").html(o[T])),panelMatch(g,"donationGroup")&&(u=T,$("#donationGroup").html(o[T])),panelMatch(g,"donationGroupMin")&&$("#donationGroupMin").val(T),panelMatch(g,"reward")&&$("#donateRewardInput").val(T),panelMatch(g,"message")&&$("#donateGreetingInput").val(T);if(panelCheckQuery(a,"greetings_donationstreamtip"))for(idx in a.results)g=a.results[idx].key,T=a.results[idx].value,panelMatch(g,"announce")&&(l=T,$("#streamtipGreetings").html(o[T])),panelMatch(g,"donationGroup")&&(h=T,$("#streamtipdonationGroup").html(o[T])),panelMatch(g,"donationGroupMin")&&$("#streamtipdonationGroupMin").val(T),panelMatch(g,"reward")&&$("#streamtipdonateRewardInput").val(T),panelMatch(g,"message")&&$("#streamtipdonateGreetingInput").val(T);if(panelCheckQuery(a,"greetings_tipeeestream"))for(idx in a.results)g=a.results[idx].key,T=a.results[idx].value,panelMatch(g,"toggle")&&(S=T,$("#tipeeestreamGreetings").html(o[T])),panelMatch(g,"group")&&(y=T,$("#tipeeestreamdonationGroup").html(o[T])),panelMatch(g,"groupMin")&&$("#tipeeestreamdonationGroupMin").val(T),panelMatch(g,"reward")&&$("#tipeeestreamdonateRewardInput").val(T),panelMatch(g,"message")&&$("#tipeeestreamdonateGreetingInput").val(T);if(panelCheckQuery(a,"greetings_subscribers"))for(idx in a.results)g=a.results[idx].key,T=a.results[idx].value,panelMatch(g,"subscribeMessage")&&$("#subGreetingInput").val(T),panelMatch(g,"primeSubscribeMessage")&&$("#primeSubGreetingInput").val(T),panelMatch(g,"reSubscribeReward")&&$("#reSubRewardInput").val(T),panelMatch(g,"reSubscribeMessage")&&$("#resubGreetingInput").val(T),panelMatch(g,"subscriberWelcomeToggle")&&(n=T,$("#subscriptionGreetings").html(o[T])),panelMatch(g,"primeSubscriberWelcomeToggle")&&(c=T,$("#primeSubscriptionGreetings").html(o[T])),panelMatch(g,"reSubscriberWelcomeToggle")&&(t=T,$("#resubscriptionGreetings").html(o[T])),panelMatch(g,"subscribeReward")&&$("#subRewardInput").val(T),panelMatch(g,"resubEmote")&&$("#resubEmoteInput").val(T);if(panelCheckQuery(a,"greetings_gamewisp"))for(idx in a.results)g=a.results[idx].key,T=a.results[idx].value,panelMatch(g,"subscriberShowMessages")&&(d=T,$("#gameWispGreetings").html(o[T])),panelMatch(g,"subscribeMessage")&&$("#gwSubGreetingInput").val(T),panelMatch(g,"reSubscribeMessage")&&$("#gwResubGreetingInput").val(T),panelMatch(g,"tierUpMessage")&&$("#gwTierupGreetingInput").val(T),panelMatch(g,"subscribeReward")&&$("#gwSubRewardInput").val(T),panelMatch(g,"reSubscribeReward")&&$("#gwResubRewardInput").val(T);if(panelCheckQuery(a,"greetings_bits"))for(idx in a.results)g=a.results[idx].key,T=a.results[idx].value,panelMatch(g,"toggle")&&(m=T,$("#bitsToggle").html(o[T])),panelMatch(g,"message")&&$("#bitsMessage").val(T),panelMatch(g,"minimum")&&$("#bitsMinimum").val(T);if(panelCheckQuery(a,"greetings_gamewispTiers")){var k="",p="",f="<table class='table table-hover table-striped'>",C="<table class='table table-hover table-striped'>",M="<table class='table table-hover table-striped'>";for(idx in a.results)g=a.results[idx].key,T=a.results[idx].value,k=g[g.indexOf("_")+1],p="<tr >    <td>Tier "+k+'</td>    <td>        <input type="number" min="0" id="inline_'+g+'"               placeholder="'+T+'" value="'+T+'"               style="width: 8em" />        <button type="button" class="btn btn-info btn-fill btn-xs"                onclick="$.updateGWTierData(\''+g+'\')"><i class="fa fa-pencil" />        </button>    </td></tr>',g.startsWith("songrequest_")===!0&&(f+=p),g.startsWith("bonuspoints_")===!0&&(C+=p),g.startsWith("subbonuspoints_")===!0&&(M+=p);$("#gameWispSongRequests").html(f),$("#gameWispBonusPoints").html(C),$("#gameWispSubBonusPoints").html(M),handleInputFocus()}}}function k(){sendDBKeys("greetings_greeting","greeting"),sendDBQuery("greetings_followReward","settings","followReward"),sendDBQuery("greetings_followMessage","settings","followMessage"),sendDBQuery("greetings_followToggle","settings","followToggle"),sendDBQuery("greetings_followDelay","settings","followDelay"),sendDBKeys("greetings_donation","donations"),sendDBKeys("greetings_donationstreamtip","streamtip"),sendDBKeys("greetings_subscribers","subscribeHandler"),sendDBKeys("greetings_gamewisp","gameWispSubHandler"),sendDBKeys("greetings_gamewispTiers","gameWispTiers"),sendDBKeys("greetings_bits","bitsSettings"),sendDBKeys("greetings_tipeeestream","tipeeeStreamHandler")}function p(e){var a=$("#inline_"+e).val();a.length>0&&(sendDBUpdate("greetings_updateTier","gameWispTiers",e,a),setTimeout(function(){sendCommand("gamewisppanelupdate"),k()},TIMEOUT_WAIT_TIME))}function f(e,o){panelMatch(e,"greeting")&&($("#globalGreetings").html(a),"true"==r?sendDBUpdate("greetings_greeting","greeting","autoGreetEnabled","false"):sendDBUpdate("greetings_greeting","greeting","autoGreetEnabled","true"),setTimeout(function(){sendCommand("greetingspanelupdate")},TIMEOUT_WAIT_TIME)),panelMatch(e,"settings")&&($("#followerGreetings").html(a),"true"==followToggle?sendDBUpdate("greetings_greeting","settings","followToggle","false"):sendDBUpdate("greetings_greeting","settings","followToggle","true"),setTimeout(function(){sendCommand("followerpanelupdate")},TIMEOUT_WAIT_TIME)),panelMatch(e,"donations")&&($("#donationGreetings").html(a),"true"==s?sendDBUpdate("greetings_greeting","donations","announce","false"):sendDBUpdate("greetings_greeting","donations","announce","true"),setTimeout(function(){sendCommand("donationpanelupdate")},TIMEOUT_WAIT_TIME)),panelMatch(e,"streamtip")&&($("#streamtipGreetings").html(a),"true"==l?sendDBUpdate("greetings_greeting","streamtip","announce","false"):sendDBUpdate("greetings_greeting","streamtip","announce","true"),setTimeout(function(){sendCommand("donationpanelupdatestreamtip")},TIMEOUT_WAIT_TIME)),panelMatch(e,"tipeeestream")&&($("#tipeeestreamGreetings").html(a),"true"==S?sendDBUpdate("greetings_greeting","tipeeeStreamHandler","toggle","false"):sendDBUpdate("greetings_greeting","tipeeeStreamHandler","toggle","true"),setTimeout(function(){sendCommand("tipeeestreamreload")},TIMEOUT_WAIT_TIME)),panelMatch(e,"donationGroup")&&($("#donationGroup").html(a),"true"==u?sendDBUpdate("greetings_greeting","donations","donationGroup","false"):sendDBUpdate("greetings_greeting","donations","donationGroup","true"),setTimeout(function(){sendCommand("donationpanelupdate")},TIMEOUT_WAIT_TIME)),panelMatch(e,"streamtipdonationGroup")&&($("#streamtipdonationGroup").html(a),"true"==h?sendDBUpdate("greetings_greeting","streamtip","donationGroup","false"):sendDBUpdate("greetings_greeting","streamtip","donationGroup","true"),setTimeout(function(){sendCommand("donationpanelupdatestreamtip")},TIMEOUT_WAIT_TIME)),panelMatch(e,"tipeeestreamdonationGroup")&&($("#tipeeestreamdonationGroup").html(a),"true"==y?sendDBUpdate("greetings_greeting","tipeeeStreamHandler","group","false"):sendDBUpdate("greetings_greeting","tipeeeStreamHandler","group","true"),setTimeout(function(){sendCommand("tipeeestreamreload")},TIMEOUT_WAIT_TIME)),panelMatch(e,"subscribeHandler")&&panelMatch(o,"subscriberWelcomeToggle")&&($("#subscriptionGreetings").html(a),"true"==n?sendDBUpdate("greetings_greeting","subscribeHandler","subscriberWelcomeToggle","false"):sendDBUpdate("greetings_greeting","subscribeHandler","subscriberWelcomeToggle","true"),setTimeout(function(){sendCommand("subscriberpanelupdate")},TIMEOUT_WAIT_TIME)),panelMatch(e,"subscribeHandler")&&panelMatch(o,"primeSubscriberWelcomeToggle")&&($("#primeSubscriptionGreetings").html(a),"true"==c?sendDBUpdate("greetings_greeting","subscribeHandler","primeSubscriberWelcomeToggle","false"):sendDBUpdate("greetings_greeting","subscribeHandler","primeSubscriberWelcomeToggle","true"),setTimeout(function(){sendCommand("subscriberpanelupdate")},TIMEOUT_WAIT_TIME)),panelMatch(e,"subscribeHandler")&&panelMatch(o,"reSubscriberWelcomeToggle")&&($("#resubscriptionGreetings").html(a),"true"==t?sendDBUpdate("greetings_greeting","subscribeHandler","reSubscriberWelcomeToggle","false"):sendDBUpdate("greetings_greeting","subscribeHandler","reSubscriberWelcomeToggle","true"),setTimeout(function(){sendCommand("subscriberpanelupdate")},TIMEOUT_WAIT_TIME)),panelMatch(e,"bitsSettings")&&panelMatch(o,"toggle")&&($("#bitsToggle").html(a),"true"==m?sendDBUpdate("greetings_bits","bitsSettings","toggle","false"):sendDBUpdate("greetings_bits","bitsSettings","toggle","true"),setTimeout(function(){sendCommand("reloadbits")},TIMEOUT_WAIT_TIME)),panelMatch(e,"bitsSettings")&&panelMatch(o,"rewardMultToggle")&&($("#bitsRewardMultToggle").html(a),"true"==g?sendDBUpdate("greetings_bits","bitsSettings","rewardMultToggle","false"):sendDBUpdate("greetings_bits","bitsSettings","rewardMultToggle","true"),setTimeout(function(){sendCommand("reloadbits")},TIMEOUT_WAIT_TIME)),panelMatch(e,"gameWispSubHandler")&&($("#gameWispGreetings").html(a),"true"==d?sendDBUpdate("greetings_greeting","gameWispSubHandler","subscriberShowMessages","false"):sendDBUpdate("greetings_greeting","gameWispSubHandler","subscriberShowMessages","true"),setTimeout(function(){sendCommand("gamewisppanelupdate")},TIMEOUT_WAIT_TIME)),setTimeout(function(){k()},TIMEOUT_WAIT_TIME)}function C(e,a,o){var r=$("#"+e).val();return"greetingCooldownInput"==e&&r.length>0?(r=String(36e5*r),sendDBUpdate("greetings_update","greeting","cooldown",r),void setTimeout(function(){k(),sendCommand("greetingspanelupdate")},TIMEOUT_WAIT_TIME)):void(r.length>0&&(sendDBUpdate("greetings_update",a,o,r),panelMatch(a,"greeting")&&sendCommand("greetingspanelupdate"),panelMatch(a,"settings")&&sendCommand("followerpanelupdate"),panelMatch(a,"donations")&&sendCommand("donationpanelupdate"),panelMatch(a,"streamtip")&&sendCommand("donationpanelupdatestreamtip"),panelMatch(a,"subscribeHandler")&&sendCommand("subscriberpanelupdate"),panelMatch(a,"bitsSettings")&&sendCommand("reloadbits"),panelMatch(a,"tipeeeStreamHandler")&&sendCommand("tipeeestreamreload"),panelMatch(a,"gameWispSubHandler")&&sendCommand("gamewisppanelupdate"),setTimeout(function(){k()},2*TIMEOUT_WAIT_TIME)))}var a='<i  class="fa fa-spinner fa-spin" />',o=[];o["false"]='<i  class="fa fa-circle text-warning" />',o["true"]='<i  class="fa fa-circle text-success"/>';var r=!1,n=!1,t=!1,s=!1,l=!1,u=!1,h=!1,d=!1,c=!1,m=!1,g=!1,S=!1,y=!1;$("#greetingsPanel").load("/panel/greetings.html");var M=setInterval(function(){if(isConnected&&TABS_INITIALIZED){var e=$("#tabs").tabs("option","active");8==e&&(k(),clearInterval(M))}},INITIAL_WAIT_TIME);setInterval(function(){var e=$("#tabs").tabs("option","active");8==e&&isConnected&&!isInputFocus()&&(newPanelAlert("Refreshing Greeting Data","success",1e3),k())},3e4),$.greetingsOnMessage=T,$.greetingsDoQuery=k,$.toggleGreetings=f,$.updateGreetingData=C,$.updateGWTierData=p}();