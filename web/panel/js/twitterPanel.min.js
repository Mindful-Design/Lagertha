(function(){function t(t){var e;try{e=JSON.parse(t.data)}catch(t){return}if(panelHasQuery(e)&&panelCheckQuery(e,"twitter_config")){var i,a,l,d;l='<table class="table table-hover table-striped">',d='<table class="table table-hover table-striped">',rewardhtml='<table class="table table-hover table-striped">';for(idx in e.results){switch(i=e.results[idx].key,a=e.results[idx].value,i){case"message_online":case"message_gamechange":case"message_update":case"polldelay_mentions":case"polldelay_retweets":case"polldelay_hometimeline":case"polldelay_usertimeline":case"postdelay_update":case"reward_points":case"reward_cooldown":$("#"+i+"TweetInput").val(a)}"reward_points"!=i&&"reward_cooldown"!=i&&(0===i.indexOf("poll_")&&(l+="<tr >    <td>"+n[i]+'</td>    <td>        <div id="twitterStatus_"'+idx+'">'+o[a]+'</div>    </td>    <td>        <div data-toggle="tooltip" title="Enable" class="button"             onclick="$.toggleTwitter(\''+i+"', 'true', '"+idx+"')\">"+s.true+'        </div>    </td>    <td>        <div data-toggle="tooltip" title="Disable" class="button"             onclick="$.toggleTwitter(\''+i+"', 'false', '"+idx+"')\">"+s.false+"        </div>    </td></tr>"),0===i.indexOf("post_")&&(d+="<tr >    <td>"+n[i]+'</td>    <td>        <div id="twitterStatus_"'+idx+'">'+o[a]+'</div>    </td>    <td>        <div data-toggle="tooltip" title="Enable" class="button"             onclick="$.toggleTwitter(\''+i+"', 'true', '"+idx+"')\">"+s.true+'        </div>    </td>    <td>        <div data-toggle="tooltip" title="Disable" class="button"             onclick="$.toggleTwitter(\''+i+"', 'false', '"+idx+"')\">"+s.false+"        </div>    </td></tr>"),0===i.indexOf("reward_")&&(rewardhtml+='<tr class="textList">    <td>'+n[i]+'</td>    <td style="width: 25px">        <div id="twitterStatus_"'+idx+'">'+o[a]+'</div>    </td>    <td style="width: 25px">        <div data-toggle="tooltip" title="Enable" class="button"             onclick="$.toggleTwitter(\''+i+"', 'true', '"+idx+"')\">"+s.true+'        </div>    </td>    <td style="width: 25px">        <div data-toggle="tooltip" title="Disable" class="button"             onclick="$.toggleTwitter(\''+i+"', 'false', '"+idx+"')\">"+s.false+"        </div>    </td></tr>"))}l+="</table>",d+="</table>",rewardhtml+="</table>",$("#twitterPollTable").html(l),$("#twitterPostTable").html(d),$("#twitterRewardTable").html(rewardhtml),$('[data-toggle="tooltip"]').tooltip()}}function e(){sendDBKeys("twitter_config","twitter")}function i(t,i,a){$("#twitterStatus_"+a).html('<i  class="fa fa-spinner fa-spin" />'),sendDBUpdate("twitter_update","twitter",t,i),setTimeout(function(){e()},TIMEOUT_WAIT_TIME)}function a(){var t=$("#postTweetInput").val();t.length>0&&($("#postTweetInput").val(""),sendCommand("twitter post "+t))}function l(t){var i=$("#"+t+"TweetInput").val();return"reward_points"==t?(i>=0&&(sendDBUpdate("twitter_update","twitter",t,i),setTimeout(function(){e()},TIMEOUT_WAIT_TIME)),void setTimeout(function(){$("#"+t+"TweetInput").val("")},TIMEOUT_WAIT_TIME)):"reward_cooldown"==t?(i>=0&&(sendDBUpdate("twitter_update","twitter",t,i),setTimeout(function(){e()},TIMEOUT_WAIT_TIME)),void setTimeout(function(){$("#"+t+"TweetInput").val("")},TIMEOUT_WAIT_TIME)):"postdelay_update"==t?(i>=180&&(sendDBUpdate("twitter_update","twitter",t,i),setTimeout(function(){e()},TIMEOUT_WAIT_TIME)),void setTimeout(function(){$("#"+t+"TweetInput").val("")},TIMEOUT_WAIT_TIME)):"polldelay_mentions"==t?(i>=60&&(sendDBUpdate("twitter_update","twitter",t,i),setTimeout(function(){e()},TIMEOUT_WAIT_TIME)),void setTimeout(function(){$("#"+t+"TweetInput").val("")},TIMEOUT_WAIT_TIME)):"polldelay_retweets"==t?(i>=60&&(sendDBUpdate("twitter_update","twitter",t,i),setTimeout(function(){e()},TIMEOUT_WAIT_TIME)),void setTimeout(function(){$("#"+t+"TweetInput").val("")},TIMEOUT_WAIT_TIME)):"polldelay_hometimeline"==t?(i>=60&&(sendDBUpdate("twitter_update","twitter",t,i),setTimeout(function(){e()},TIMEOUT_WAIT_TIME)),void setTimeout(function(){$("#"+t+"TweetInput").val("")},TIMEOUT_WAIT_TIME)):"polldelay_usertimeline"==t?(i>=15&&(sendDBUpdate("twitter_update","twitter",t,i),setTimeout(function(){e()},TIMEOUT_WAIT_TIME)),void setTimeout(function(){$("#"+t+"TweetInput").val("")},TIMEOUT_WAIT_TIME)):void(i.length>0&&(sendDBUpdate("twitter_update","twitter",t,i),setTimeout(function(){e()},TIMEOUT_WAIT_TIME)))}var o=[],s=[],n=[];o.false='<i class="fa fa-circle text-warning"/>',o.true='<i class="fa fa-circle text-success"/>',s.false='<i class="fa fa-circle-o" />',s.true='<i class="fa fa-circle" />',n.poll_mentions="Poll Mentions",n.poll_retweets="Poll Retweets",n.poll_hometimeline="Poll Home Timeline",n.poll_usertimeline="Poll User Timeline",n.post_online="Post When Stream Goes Online",n.post_gamechange="Post Game Change",n.post_update="Post Timed Automatic Updates",n.reward_toggle="Toggle Rewards",n.reward_announce="Toggle Reward Announcements",$("#twitterPanel").load("/panel/twitter.html");var d=setInterval(function(){if(isConnected&&TABS_INITIALIZED){var t=$("#tabs").tabs("option","active");19==t&&(e(),clearInterval(d))}},INITIAL_WAIT_TIME);setInterval(function(){var t=$("#tabs").tabs("option","active");19==t&&isConnected&&!isInputFocus()&&(newPanelAlert("Refreshing Twitter Data","success",1e3),e())},3e4),$.twitterOnMessage=t,$.twitterDoQuery=e,$.toggleTwitter=i,$.postTweet=a,$.updateDataTwitter=l})();