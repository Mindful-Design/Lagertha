!function(){function i(i){var n;try{n=JSON.parse(i.data)}catch(r){return}if(panelHasQuery(n)&&panelCheckQuery(n,"twitter_config")){var t,s,l,u;l='<table class="table table-hover table-striped">',u='<table class="table table-hover table-striped">';for(idx in n.results){switch(t=n.results[idx].key,s=n.results[idx].value,t){case"message_online":case"message_gamechange":case"message_update":case"polldelay_mentions":case"polldelay_retweets":case"polldelay_hometimeline":case"polldelay_usertimeline":case"postdelay_update":$("#"+t+"TweetInput").val(s)}0===t.indexOf("poll_")&&(l+="<tr >    <td>"+o[t]+'</td>    <td>        <div id="twitterStatus_"'+idx+'">'+e[s]+'</div>    </td>    <td>        <div data-toggle="tooltip" title="Enable" class="button"             onclick="$.toggleTwitter(\''+t+"', 'true', '"+idx+"')\">"+a["true"]+'        </div>    </td>    <td>        <div data-toggle="tooltip" title="Disable" class="button"             onclick="$.toggleTwitter(\''+t+"', 'false', '"+idx+"')\">"+a["false"]+"        </div>    </td></tr>"),0===t.indexOf("post_")&&(u+="<tr >    <td>"+o[t]+'</td>    <td>        <div id="twitterStatus_"'+idx+'">'+e[s]+'</div>    </td>    <td>        <div data-toggle="tooltip" title="Enable" class="button"             onclick="$.toggleTwitter(\''+t+"', 'true', '"+idx+"')\">"+a["true"]+'        </div>    </td>    <td>        <div data-toggle="tooltip" title="Disable" class="button"             onclick="$.toggleTwitter(\''+t+"', 'false', '"+idx+"')\">"+a["false"]+"        </div>    </td></tr>")}l+="</table>",u+="</table>",$("#twitterPollTable").html(l),$("#twitterPostTable").html(u),$('[data-toggle="tooltip"]').tooltip()}}function n(){sendDBKeys("twitter_config","twitter")}function r(e,a,o){$("#twitterStatus_"+o).html('<i  class="fa fa-spinner fa-spin" />'),sendDBUpdate("twitter_update","twitter",e,a),setTimeout(function(){n()},TIMEOUT_WAIT_TIME)}function t(){var e=$("#postTweetInput").val();e.length>0&&($("#postTweetInput").val(""),sendCommand("twitter post "+e))}function s(e){var a=$("#"+e+"TweetInput").val();return"postdelay_update"==e?(a>=180&&(sendDBUpdate("twitter_update","twitter",e,a),setTimeout(function(){n()},TIMEOUT_WAIT_TIME)),void setTimeout(function(){$("#"+e+"TweetInput").val("")},TIMEOUT_WAIT_TIME)):"polldelay_mentions"==e?(a>=60&&(sendDBUpdate("twitter_update","twitter",e,a),setTimeout(function(){n()},TIMEOUT_WAIT_TIME)),void setTimeout(function(){$("#"+e+"TweetInput").val("")},TIMEOUT_WAIT_TIME)):"polldelay_retweets"==e?(a>=60&&(sendDBUpdate("twitter_update","twitter",e,a),setTimeout(function(){n()},TIMEOUT_WAIT_TIME)),void setTimeout(function(){$("#"+e+"TweetInput").val("")},TIMEOUT_WAIT_TIME)):"polldelay_hometimeline"==e?(a>=60&&(sendDBUpdate("twitter_update","twitter",e,a),setTimeout(function(){n()},TIMEOUT_WAIT_TIME)),void setTimeout(function(){$("#"+e+"TweetInput").val("")},TIMEOUT_WAIT_TIME)):"polldelay_usertimeline"==e?(a>=15&&(sendDBUpdate("twitter_update","twitter",e,a),setTimeout(function(){n()},TIMEOUT_WAIT_TIME)),void setTimeout(function(){$("#"+e+"TweetInput").val("")},TIMEOUT_WAIT_TIME)):void(a.length>0&&(sendDBUpdate("twitter_update","twitter",e,a),setTimeout(function(){n()},TIMEOUT_WAIT_TIME)))}var e=[],a=[],o=[];e["false"]='<i class="fa fa-circle text-warning"/>',e["true"]='<i class="fa fa-circle text-success"/>',a["false"]='<i class="fa fa-circle-o" />',a["true"]='<i class="fa fa-circle" />',o.poll_mentions="Poll Mentions",o.poll_retweets="Poll Retweets",o.poll_hometimeline="Poll Home Timeline",o.poll_usertimeline="Poll User Timeline",o.post_online="Post When Stream Goes Online",o.post_gamechange="Post Game Change",o.post_update="Post Timed Automatic Updates",$("#twitterPanel").load("/panel/twitter.html");var l=setInterval(function(){if(isConnected&&TABS_INITIALIZED){var e=$("#tabs").tabs("option","active");19==e&&(n(),clearInterval(l))}},INITIAL_WAIT_TIME);setInterval(function(){var e=$("#tabs").tabs("option","active");19==e&&isConnected&&!isInputFocus()&&(newPanelAlert("Refreshing Twitter Data","success",1e3),n())},3e4),$.twitterOnMessage=i,$.twitterDoQuery=n,$.toggleTwitter=r,$.postTweet=t,$.updateDataTwitter=s}();