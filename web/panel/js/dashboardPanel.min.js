!function(){function v(e){var t;try{t=JSON.parse(e.data)}catch(n){return}if(panelHasQuery(t)){if(panelMatch(t.query_id,"dashboard_highlights")){var a="";for(var o in t.results){var s=t.results[o].value;a+=s+" @ "+t.results[o].key+"<br>"}0==a.length?$("#showHighlights").html("No Highlights Found"):$("#showHighlights").html(a)}if(panelCheckQuery(t,"dashboard_modules")){var l='<table class="table table-hover table-striped">',p='<table class="table table-hover table-striped">',v=t.results,T="",_="";$.disablePanels(v),v.sort(C);for(idx in v)T=v[idx].key,_=v[idx].value,-1===T.indexOf("/core/")&&-1===T.indexOf("/lang/")&&(-1===T.indexOf("./discord")?l+="<tr>    <td>"+T.replace(/.\/commands\/|.\/games\/|.\/handlers\/|.\/systems\//gi,function(e){return h[e]})+'</td>    <td>        <div id="moduleStatus_'+idx+'">'+u[_]+'</div>    </td>    <td>        <div data-toggle="tooltip" title="Enable" class="button"             onclick="$.enableModule(\''+T+"', "+idx+')">'+f["true"]+'        </div>    </td>    <td>        <div data-toggle="tooltip" title="Disable" class="button"             onclick="$.disableModule(\''+T+"', "+idx+')">'+f["false"]+"        </div>    </td></tr>":p+="<tr>    <td>"+T.replace(/.\/discord\/commands\/|.\/discord\/games\/|.\/discord\/handlers\/|.\/discord\/systems\//gi,function(e){return g[e]})+'</td>    <td>        <div id="moduleStatus_'+idx+'">'+u[_]+'</div>    </td>    <td>        <div data-toggle="tooltip" title="Enable" class="button"             onclick="$.enableModule(\''+T+"', "+idx+')">'+f["true"]+'        </div>    </td>    <td>        <div data-toggle="tooltip" title="Disable" class="button"             onclick="$.disableModule(\''+T+"', "+idx+')">'+f["false"]+"        </div>    </td></tr>");l+="</table>",p+="</table>",$("#modulesList").html(l),$("#discordModulesList").html(p),$('[data-toggle="tooltip"]').tooltip({trigger:"hover"})}if(panelCheckQuery(t,"dashboard_chatCount")){var I="",w="",y="";d=[];for(var o=0,M=10;9>=o;o++,M--){new Date;I=$.format.date(Date.now()-24*o*36e5,"MM.dd.yy"),w="chat_"+I,y="0";for(idx in t.results)if(panelMatch(t.results[idx].key,w)){y=t.results[idx].value;break}$("#chatDate-"+o).html("<span>"+I+"</span>"),$("#chatCount-"+o).html("<spam>"+y+"</span>"),d.push([M,y])}}if(panelCheckQuery(t,"dashboard_modCount")){var D="",k="",S="";i=[];for(var o=0,M=10;9>=o;o++,M--){new Date;D=$.format.date(Date.now()-24*o*36e5,"MM.dd.yy"),k="mod_"+D,S="0";for(idx in t.results)if(panelMatch(t.results[idx].key,k)){S=t.results[idx].value;break}$("#modCount-"+o).html("<spam>"+S+"</span>"),i.push([M,S])}}if(i.length>0&&d.length>0){var A={series:{shadowSize:0,curvedLines:{apply:!0,active:!0,monotonicFit:!0},lines:{show:!1,lineWidth:0}},grid:{borderWidth:0,labelMargin:10,hoverable:!0,clickable:!0,mouseActiveRadius:6},xaxis:{tickDecimals:0,ticks:!1},yaxis:{tickDecimals:0,ticks:!1},legend:{show:!1}};$.plot($("#panelStatsGraph"),[{data:d,lines:{show:!0,fill:.85},curvedLines:{apply:!0},label:"Messages",stack:!0,color:"#1DC7EA"},{data:i,lines:{show:!0,fill:.98},label:"Timeouts",stack:!0,color:"#FF4A55"}],A),$(".flot-chart")[0]&&$(".flot-chart").bind("plothover",function(e,t,n){if(n){var a=n.datapoint[0].toFixed(2),o=Math.round(n.datapoint[1].toFixed(2)),s=Date.today().add(a-10).day().toString("dddd");$(".flot-tooltip").html(n.series.label+" on "+s+": "+o).css({top:n.pageY+5,left:n.pageX+5}).show()}else $(".flot-tooltip").hide()})}if(panelCheckQuery(t,"dashboard_panelStatsEnabled")&&(panelMatch(t.results.enabled,"true")?panelStatsEnabled||(panelStatsEnabled=!0,b()):$("#panelStatsEnabled").html("<span>Panel Stats are Disabled</span>")),panelCheckQuery(t,"dashboard_streamTitle")&&(void 0===t.results.title||null===t.results.title?$("#streamTitleInput").val("Title"):$("#streamTitleInput").val(t.results.title)),panelCheckQuery(t,"dashboard_streamlastfollow")&&(null==t.results.lastFollow?$("#lastFollow").html(""):$("#lastFollow").html("<spam>Latest Follow: "+t.results.lastFollow+" </spam>")),panelCheckQuery(t,"dashboard_streamlastresub")&&(null==t.results.lastReSub?$("#lastReSub").html(""):$("#lastReSub").html("<spam>Latest ReSub: "+t.results.lastReSub+" </spam>")),panelCheckQuery(t,"dashboard_streamlastsub")&&(null==t.results.lastSub?$("#lastSub").html(""):$("#lastSub").html("<spam>Latest Sub: "+t.results.lastSub+" </spam>")),panelCheckQuery(t,"dashboard_streamlastdonator")&&(null==t.results.lastDonator?$("#lastDonator").html(""):$("#lastDonator").html("<spam>Latest Donator: "+t.results.lastDonator+" </spam>")),panelCheckQuery(t,"dashboard_gameTitle")&&(gameTitle=t.results.game,(void 0===gameTitle||null===gameTitle)&&(gameTitle="Some Game"),$("#gameTitleInput").val(gameTitle),sendDBQuery("dashboard_deathctr","deaths",gameTitle)),panelCheckQuery(t,"dashboard_loggingModeEvent")&&(r=t.results["log.event"],$("#logEvent").html(u[r])),panelCheckQuery(t,"dashboard_loggingModeFile")&&(c=t.results["log.file"],$("#logFile").html(u[c])),panelCheckQuery(t,"dashboard_loggingModeErr")&&(m=t.results["log.error"],$("#logError").html(u[m])),panelCheckQuery(t,"dashboard_deathctr")){if(amount=t.results[gameTitle],null==gameTitle||null==amount)return void $("#deathCounterValue").html("0");$("#deathCounterValue").html(t.results[gameTitle])}panelCheckQuery(t,"dashboard_dsChannels")&&(void 0!==t.results.otherChannels&&null!==t.results.otherChannels?$("#multiLinkInput").val(t.results.otherChannels.replace(/\//g," ")):$("#multiLinkInput").attr("placeholder","Channel-1 Channel-2")),panelCheckQuery(t,"dashboard_dsInterval")&&(void 0!==t.results.timerInterval&&null!==t.results.timerInterval?$("#multiLinkTimerInput").attr("placeholder",t.results.timerInterval):$("#multiLinkTimerInput").attr("placeholder","Minutes")),panelCheckQuery(t,"dashboard_dsReqMsgs")&&(void 0!==t.results.reqMessages&&null!==t.results.reqMessages?$("#multiLinkReqMsgsInput").attr("placeholder",t.results.reqMessages):$("#multiLinkReqMsgsInput").attr("placeholder","Message Count")),panelCheckQuery(t,"dashboard_logRotate")&&$("#logRotateInput").val(t.results.log_rotate_days)}}function b(){sendDBQuery("dashboard_streamTitle","streamInfo","title"),sendDBQuery("dashboard_streamlastfollow","streamInfo","lastFollow"),sendDBQuery("dashboard_streamlastresub","streamInfo","lastReSub"),sendDBQuery("dashboard_streamlastsub","streamInfo","lastSub"),sendDBQuery("dashboard_streamlastdonator","streamInfo","lastDonator"),sendDBQuery("dashboard_gameTitle","streamInfo","game"),sendDBQuery("dashboard_loggingModeEvent","settings","log.event"),sendDBQuery("dashboard_loggingModeFile","settings","log.file"),sendDBQuery("dashboard_loggingModeErr","settings","log.error"),sendDBQuery("dashboard_logRotate","settings","log_rotate_days"),sendDBQuery("dashboard_dsChannels","dualStreamCommand","otherChannels"),sendDBQuery("dashboard_dsInterval","dualStreamCommand","timerInterval"),sendDBQuery("dashboard_dsReqMsgs","dualStreamCommand","reqMessages"),sendDBQuery("dashboard_deathctr","deaths",gameTitle),sendDBKeys("dashboard_highlights","highlights"),sendDBKeys("dashboard_modules","modules"),panelStatsEnabled?(sendDBKeys("dashboard_chatCount","panelchatstats"),sendDBKeys("dashboard_modCount","panelmodstats")):sendDBQuery("dashboard_panelStatsEnabled","panelstats","enabled")}function T(){var e=$("#logRotateInput").val();e.length>0&&(sendDBUpdate("dashboard_updateLogRotate","settings","log_rotate_days",e),setTimeout(function(){sendDBQuery("dashboard_logRotate","settings","log_rotate_days")},TIMEOUT_WAIT_TIME))}function _(e){panelMatch(gameTitle,"__not_loaded__")||($("#deathCounterValue").html('<i  class="fa fa-spinner fa-spin" />'),sendCommand("deathctr "+e),setTimeout(function(){sendDBQuery("dashboard_deathctr","deaths",gameTitle)},TIMEOUT_WAIT_TIME))}function C(e,t){return panelStrcmp(e.key,t.key)}function I(e,t){$("#moduleStatus_"+t).html('<i  class="fa fa-spinner fa-spin" />'),sendCommand("module enablesilent "+e),setTimeout(function(){b()},TIMEOUT_WAIT_TIME)}function w(e,t){$("#moduleStatus_"+t).html('<i  class="fa fa-spinner fa-spin" />'),sendCommand("module disablesilent "+e),setTimeout(function(){b()},TIMEOUT_WAIT_TIME)}function y(e){$("#"+e).html('<i class="fa fa-spinner fa-spin" />'),"logFile"==e&&(console.log(e),"true"==c?sendDBUpdate("dashboard_loggingModeFile","settings","log.file","false"):sendDBUpdate("dashboard_loggingModeFile","settings","log.file","true")),"logError"==e&&("true"==m?sendDBUpdate("dashboard_loggingModeFile","settings","log.error","false"):sendDBUpdate("dashboard_loggingModeFile","settings","log.error","true")),"logEvent"==e&&("true"==r?sendDBUpdate("dashboard_loggingModeFile","settings","log.event","false"):sendDBUpdate("dashboard_loggingModeFile","settings","log.event","true")),sendCommand("reloadlogs"),setTimeout(function(){b()},TIMEOUT_WAIT_TIME)}function M(e){panelMatch(e,"pausecommands")&&(e+=$.globalPauseMode?" clear":" 300"),sendCommand(e),setTimeout(function(){$.globalDoQuery()},TIMEOUT_WAIT_TIME)}function E(){var e=$("#streamTitleInput").val();e.length>0&&(sendCommand("settitlesilent "+e),$("#streamTitleInput").val(e))}function D(){var e=$("#gameTitleInput").val();e.length>0&&(sendCommand("setgamesilent "+e),$("#gameTitleInput").val(e),gameTitle=e)}function k(){sendCommand("reconnect")}function S(){sendCommand("disconnect")}function A(){$("#showHighlights").html('<i  class="fa fa-spinner fa-spin" />'),sendCommand("highlightpanel "+$("#highlightInput").val()),$("#highlightInput").val(""),setTimeout(function(){sendDBKeys("dashboard_highlights","highlights")},TIMEOUT_WAIT_TIME)}function x(){$("#showHighlightspanel").html('<i  class="fa fa-spinner fa-spin" />'),sendCommand("clearhighlights"),setTimeout(function(){sendDBKeys("dashboard_highlights","highlights")},TIMEOUT_WAIT_TIME)}function P(e,t){var n=$(e).val();n.length>0&&(sendDBUpdate("multiLinkInput","dualStreamCommand",t,n.replace(/\s+/g,"/")),$(e).val(""),$(e).attr("placeholder",n).blur(),setTimeout(function(){sendCommand("reloadmulti")},TIMEOUT_WAIT_TIME),setTimeout(function(){b()},2*TIMEOUT_WAIT_TIME))}function O(e,t){var n=$(e).val();parseInt(n)>=5&&n.length>0&&(sendDBUpdate("multiLinkTimerInput","dualStreamCommand",t,n),$(e).val(""),$(e).attr("placeholder",n).blur(),setTimeout(function(){sendCommand("reloadmulti")},TIMEOUT_WAIT_TIME),setTimeout(function(){b()},2*TIMEOUT_WAIT_TIME))}function U(e,t){var n=$(e).val();n.length>0&&(sendDBUpdate("multiLinkReqMsgsInput","dualStreamCommand",t,n),$(e).val(""),$(e).attr("placeholder",n).blur(),setTimeout(function(){sendCommand("reloadmulti")},TIMEOUT_WAIT_TIME),setTimeout(function(){b()},2*TIMEOUT_WAIT_TIME))}function B(){sendDBUpdate("multiLinkClear","dualStreamCommand","otherChannels","Channel-1 Channel-2"),sendDBUpdate("multiLinkClear","dualStreamCommand","timerToggle","false"),setTimeout(function(){sendCommand("reloadmulti")},TIMEOUT_WAIT_TIME),setTimeout(function(){b()},2*TIMEOUT_WAIT_TIME)}function L(){$("#multiStatus").html('<span class="purplePill" data-toggle="tooltip" title="Multi-Link Enabled"><i class="fa fa-link fa-lg" /></span>'),$('[data-toggle="tooltip"]').tooltip(),sendDBUpdate("multiLinkClear","dualStreamCommand","timerToggle","true"),setTimeout(function(){sendCommand("reloadmulti")},TIMEOUT_WAIT_TIME),setTimeout(function(){b()},2*TIMEOUT_WAIT_TIME)}function W(){$("#multiStatus").html(""),sendDBUpdate("multiLinkClear","dualStreamCommand","timerToggle","false"),setTimeout(function(){sendCommand("reloadmulti")},TIMEOUT_WAIT_TIME),setTimeout(function(){b()},2*TIMEOUT_WAIT_TIME)}function Q(){$("#shoutOutInput").val().length>0&&(sendCommand("shoutout "+$("#shoutOutInput").val()),$("#shoutOutInput").val(""))}function R(){$("#chatsidebar").is(":visible")?($("#chatsidebar").fadeOut(1e3),setTimeout(function(){$(".tab-pane").css("width","100%")},1e3),$(window).resize(function(){$(".tab-pane").css("width","100%")})):($("#chatsidebar").fadeIn(1e3),$(window).resize(function(){$(".tab-pane").css("width","100%").css("width","-=300px")}),$(".tab-pane").css("width","100%").css("width","-=300px"))}function z(){$("#disableVideo").is(":visible")?($("#disableVideo").fadeOut(1e3),player.pause()):($("#disableVideo").fadeIn(1e3),player.play())}function F(e){sendCommand("queue "+e)}function N(e,t){$("#amountQueue").val().length>0?sendCommand("queue "+e+" "+$("#amountQueue").val()):sendCommand("queue "+e+" 1"),$("#amountQueue").val("")}var i=[],d=[],r=!1,m=!1,c=!1,u=[],f=[];gameTitle="__not_loaded__",u["false"]='<i class="fa fa-circle text-warning"/>',u["true"]='<i class="fa fa-circle text-success"/>',f["false"]='<i class="fa fa-circle-o" />',f["true"]='<i class="fa fa-circle" />';var h={"./commands/":"","./games/":"","./handlers/":"","./systems/":""},g={"./discord/commands/":"","./discord/games/":"","./discord/handlers/":"","./discord/systems/":""};$("#dashboardPanel").load("/panel/dashboard.html");var q=setInterval(function(){if(isConnected&&TABS_INITIALIZED){var e=$("#tabs").tabs("option","active");0==e&&(b(),clearInterval(q))}},INITIAL_WAIT_TIME);setInterval(function(){var e=$("#tabs").tabs("option","active");0==e&&isConnected&&!isInputFocus()&&(newPanelAlert("Refreshing Dashboard Data","success",1e3),b())},3e4),$.dashboardOnMessage=v,$.dashboardDoQuery=b,$.setStreamTitle=E,$.setGameTitle=D,$.chatReconnect=k,$.setHighlight=A,$.clearHighlights=x,$.setMultiLink=P,$.setMultiLinkTimer=O,$.setMultiReqMsgs=U,$.clearMultiLink=B,$.multiLinkTimerOn=L,$.multiLinkTimerOff=W,$.toggleCommand=M,$.toggleTwitchChat=R,$.toggleTwitchVideo=z,$.toggleLog=y,$.enableModule=I,$.disableModule=w,$.adjustDeathCounter=_,$.shoutOut=Q,$.disconnect=S,$.queueCMD=F,$.queueCMDNext=N,$.setLogRotate=T}();