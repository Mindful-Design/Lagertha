!function(){function y(e){var t;try{t=JSON.parse(e.data)}catch(i){return}if(panelHasQuery(t)){if(panelMatch(t.query_id,"dashboard_highlights")){var n="";for(var a in t.results){var o=t.results[a].value;n+=o+" @ "+t.results[a].key+"<br>"}0==n.length?$("#showHighlights").html("No Highlights Found"):$("#showHighlights").html(n)}if(panelCheckQuery(t,"dashboard_modules")){var s='<table class="table table-hover table-striped">',p='<table class="table table-hover table-striped">',y=t.results,b="",S="";$.disablePanels(y),y.sort(k);for(idx in y)b=y[idx].key,S=y[idx].value,-1===b.indexOf("/core/")&&-1===b.indexOf("/lang/")&&(-1===b.indexOf("./discord")?s+="<tr>    <td>"+b.replace(/.\/commands\/|.\/games\/|.\/handlers\/|.\/systems\//gi,function(e){return m[e]})+'</td>    <td>        <div id="moduleStatus_'+idx+'">'+d[S]+'</div>    </td>    <td>        <div data-toggle="tooltip" title="Enable" class="button"             onclick="$.enableModule(\''+b+"', "+idx+')">'+f["true"]+'        </div>    </td>    <td>        <div data-toggle="tooltip" title="Disable" class="button"             onclick="$.disableModule(\''+b+"', "+idx+')">'+f["false"]+"        </div>    </td></tr>":p+="<tr>    <td>"+b.replace(/.\/discord\/commands\/|.\/discord\/games\/|.\/discord\/handlers\/|.\/discord\/systems\//gi,function(e){return g[e]})+'</td>    <td>        <div id="moduleStatus_'+idx+'">'+d[S]+'</div>    </td>    <td>        <div data-toggle="tooltip" title="Enable" class="button"             onclick="$.enableModule(\''+b+"', "+idx+')">'+f["true"]+'        </div>    </td>    <td>        <div data-toggle="tooltip" title="Disable" class="button"             onclick="$.disableModule(\''+b+"', "+idx+')">'+f["false"]+"        </div>    </td></tr>");s+="</table>",p+="</table>",$("#modulesList").html(s),$("#discordModulesList").html(p),$('[data-toggle="tooltip"]').tooltip({trigger:"hover"})}if(panelCheckQuery(t,"dashboard_chatCount")){var T="",C="",D="";l=[];for(var a=0,M=10;9>=a;a++,M--){new Date;T=$.format.date(Date.now()-24*a*36e5,"MM.dd.yy"),C="chat_"+T,D="0";for(idx in t.results)if(panelMatch(t.results[idx].key,C)){D=t.results[idx].value;break}$("#chatDate-"+a).html("<span>"+T+"</span>"),$("#chatCount-"+a).html("<spam>"+D+"</span>"),l.push([M,D])}}if(panelCheckQuery(t,"dashboard_modCount")){var _="",A="",x="";r=[];for(var a=0,M=10;9>=a;a++,M--){new Date;_=$.format.date(Date.now()-24*a*36e5,"MM.dd.yy"),A="mod_"+_,x="0";for(idx in t.results)if(panelMatch(t.results[idx].key,A)){x=t.results[idx].value;break}$("#modCount-"+a).html("<spam>"+x+"</span>"),r.push([M,x])}}if(r.length>0&&l.length>0){var P={series:{shadowSize:0,curvedLines:{apply:!0,active:!0,monotonicFit:!0},lines:{show:!1,lineWidth:0}},grid:{borderWidth:0,labelMargin:10,hoverable:!0,clickable:!0,mouseActiveRadius:6},xaxis:{tickDecimals:0,ticks:!1},yaxis:{tickDecimals:0,ticks:!1},legend:{show:!1}};$.plot($("#panelStatsGraph"),[{data:l,lines:{show:!0,fill:.85},curvedLines:{apply:!0},label:"Messages",stack:!0,color:"#1DC7EA"},{data:r,lines:{show:!0,fill:.98},label:"Timeouts",stack:!0,color:"#FF4A55"}],P),$(".flot-chart")[0]&&$(".flot-chart").bind("plothover",function(e,t,i){if(i){var n=i.datapoint[0].toFixed(2),a=Math.round(i.datapoint[1].toFixed(2)),o=Date.today().add(n-10).day().toString("dddd");$(".flot-tooltip").html(i.series.label+" on "+o+": "+a).css({top:i.pageY+5,left:i.pageX+5}).show()}else $(".flot-tooltip").hide()})}if(panelCheckQuery(t,"dashboard_panelStatsEnabled")&&(panelMatch(t.results.enabled,"true")?panelStatsEnabled||(panelStatsEnabled=!0,v()):$("#panelStatsEnabled").html("<span>Panel Stats are Disabled</span>")),panelCheckQuery(t,"dashboard_streamTitle")&&(void 0===t.results.title||null===t.results.title?$("#streamTitleInput").val("Title"):$("#streamTitleInput").val(t.results.title)),panelCheckQuery(t,"dashboard_streamlastfollow")&&(null==t.results.lastFollow?$("#lastFollow").html(""):$("#lastFollow").html("<spam>Latest Follow: "+t.results.lastFollow+"</spam>")),panelCheckQuery(t,"dashboard_streamlastresub")&&(null==t.results.lastReSub?$("#lastReSub").html(""):$("#lastReSub").html("<spam>Latest ReSub: "+t.results.lastReSub+"</spam>")),panelCheckQuery(t,"dashboard_streamlastsub")&&(null==t.results.lastSub?$("#lastSub").html(""):$("#lastSub").html("<spam>Latest Sub: "+t.results.lastSub+"</spam>")),panelCheckQuery(t,"dashboard_streamlastdonator")&&(null==t.results.lastDonator?$("#lastDonator").html(""):$("#lastDonator").html("<spam>Latest Donator: "+t.results.lastDonator+"</spam>")),panelCheckQuery(t,"dashboard_gameTitle")&&(gameTitle=t.results.game,(void 0===gameTitle||null===gameTitle)&&(gameTitle="Some Game"),$("#gameTitleInput").val(gameTitle),sendDBQuery("dashboard_deathctr","deaths",gameTitle)),panelCheckQuery(t,"dashboard_loggingModeEvent")&&(u=t.results["log.event"],$("#logEvent").html(d[u])),panelCheckQuery(t,"dashboard_loggingModeFile")&&(c=t.results["log.file"],$("#logFile").html(d[c])),panelCheckQuery(t,"dashboard_loggingModeErr")&&(h=t.results["log.error"],$("#logError").html(d[h])),panelCheckQuery(t,"dashboard_deathctr")){if(amount=t.results[gameTitle],null==gameTitle||null==amount)return void $("#deathCounterValue").html("0");$("#deathCounterValue").html(t.results[gameTitle])}panelCheckQuery(t,"dashboard_dsChannels")&&(void 0!==t.results.otherChannels&&null!==t.results.otherChannels?$("#multiLinkInput").val(t.results.otherChannels.replace(/\//g," ")):$("#multiLinkInput").attr("placeholder","Channel-1 Channel-2")),panelCheckQuery(t,"dashboard_dsInterval")&&(void 0!==t.results.timerInterval&&null!==t.results.timerInterval?$("#multiLinkTimerInput").attr("placeholder",t.results.timerInterval):$("#multiLinkTimerInput").attr("placeholder","Minutes")),panelCheckQuery(t,"dashboard_dsReqMsgs")&&(void 0!==t.results.reqMessages&&null!==t.results.reqMessages?$("#multiLinkReqMsgsInput").attr("placeholder",t.results.reqMessages):$("#multiLinkReqMsgsInput").attr("placeholder","Message Count")),panelCheckQuery(t,"dashboard_logRotate")&&$("#logRotateInput").val(t.results.log_rotate_days)}}function v(){sendDBQuery("dashboard_streamTitle","streamInfo","title"),sendDBQuery("dashboard_streamlastfollow","streamInfo","lastFollow"),sendDBQuery("dashboard_streamlastresub","streamInfo","lastReSub"),sendDBQuery("dashboard_streamlastsub","streamInfo","lastSub"),sendDBQuery("dashboard_streamlastdonator","streamInfo","lastDonator"),sendDBQuery("dashboard_gameTitle","streamInfo","game"),sendDBQuery("dashboard_loggingModeEvent","settings","log.event"),sendDBQuery("dashboard_loggingModeFile","settings","log.file"),sendDBQuery("dashboard_loggingModeErr","settings","log.error"),sendDBQuery("dashboard_logRotate","settings","log_rotate_days"),sendDBQuery("dashboard_dsChannels","dualStreamCommand","otherChannels"),sendDBQuery("dashboard_dsInterval","dualStreamCommand","timerInterval"),sendDBQuery("dashboard_dsReqMsgs","dualStreamCommand","reqMessages"),sendDBQuery("dashboard_deathctr","deaths",gameTitle),sendDBKeys("dashboard_highlights","highlights"),sendDBKeys("dashboard_modules","modules"),panelStatsEnabled?(sendDBKeys("dashboard_chatCount","panelchatstats"),sendDBKeys("dashboard_modCount","panelmodstats")):sendDBQuery("dashboard_panelStatsEnabled","panelstats","enabled")}function b(){var e=$("#logRotateInput").val();e.length>0&&(sendDBUpdate("dashboard_updateLogRotate","settings","log_rotate_days",e),setTimeout(function(){sendDBQuery("dashboard_logRotate","settings","log_rotate_days")},TIMEOUT_WAIT_TIME))}function S(e){panelMatch(gameTitle,"__not_loaded__")||($("#deathCounterValue").html('<i  class="fa fa-spinner fa-spin" />'),sendCommand("deathctr "+e),setTimeout(function(){sendDBQuery("dashboard_deathctr","deaths",gameTitle)},TIMEOUT_WAIT_TIME))}function k(e,t){return panelStrcmp(e.key,t.key)}function T(e,t){$("#moduleStatus_"+t).html('<i  class="fa fa-spinner fa-spin" />'),sendCommand("module enablesilent "+e),setTimeout(function(){v()},TIMEOUT_WAIT_TIME)}function C(e,t){$("#moduleStatus_"+t).html('<i  class="fa fa-spinner fa-spin" />'),sendCommand("module disablesilent "+e),setTimeout(function(){v()},TIMEOUT_WAIT_TIME)}function D(e){$("#"+e).html('<i class="fa fa-spinner fa-spin" />'),"logFile"==e&&(console.log(e),"true"==c?sendDBUpdate("dashboard_loggingModeFile","settings","log.file","false"):sendDBUpdate("dashboard_loggingModeFile","settings","log.file","true")),"logError"==e&&("true"==h?sendDBUpdate("dashboard_loggingModeFile","settings","log.error","false"):sendDBUpdate("dashboard_loggingModeFile","settings","log.error","true")),"logEvent"==e&&("true"==u?sendDBUpdate("dashboard_loggingModeFile","settings","log.event","false"):sendDBUpdate("dashboard_loggingModeFile","settings","log.event","true")),sendCommand("reloadlogs"),setTimeout(function(){v()},TIMEOUT_WAIT_TIME)}function M(e){panelMatch(e,"pausecommands")&&(e+=$.globalPauseMode?" clear":" 300"),sendCommand(e),setTimeout(function(){$.globalDoQuery()},TIMEOUT_WAIT_TIME)}function w(){var e=$("#streamTitleInput").val();e.length>0&&(sendCommand("settitlesilent "+e),$("#streamTitleInput").val(e))}function _(){var e=$("#gameTitleInput").val();e.length>0&&(sendCommand("setgamesilent "+e),$("#gameTitleInput").val(e),gameTitle=e)}function A(){sendCommand("reconnect")}function x(){sendCommand("disconnect")}function P(){$("#showHighlights").html('<i  class="fa fa-spinner fa-spin" />'),sendCommand("highlightpanel "+$("#highlightInput").val()),$("#highlightInput").val(""),setTimeout(function(){sendDBKeys("dashboard_highlights","highlights")},TIMEOUT_WAIT_TIME)}function I(){$("#showHighlightspanel").html('<i  class="fa fa-spinner fa-spin" />'),sendCommand("clearhighlights"),setTimeout(function(){sendDBKeys("dashboard_highlights","highlights")},TIMEOUT_WAIT_TIME)}function B(e,t){var i=$(e).val();i.length>0&&(sendDBUpdate("multiLinkInput","dualStreamCommand",t,i.replace(/\s+/g,"/")),$(e).val(""),$(e).attr("placeholder",i).blur(),setTimeout(function(){sendCommand("reloadmulti")},TIMEOUT_WAIT_TIME),setTimeout(function(){v()},2*TIMEOUT_WAIT_TIME))}function R(e,t){var i=$(e).val();parseInt(i)>=5&&i.length>0&&(sendDBUpdate("multiLinkTimerInput","dualStreamCommand",t,i),$(e).val(""),$(e).attr("placeholder",i).blur(),setTimeout(function(){sendCommand("reloadmulti")},TIMEOUT_WAIT_TIME),setTimeout(function(){v()},2*TIMEOUT_WAIT_TIME))}function F(e,t){var i=$(e).val();i.length>0&&(sendDBUpdate("multiLinkReqMsgsInput","dualStreamCommand",t,i),$(e).val(""),$(e).attr("placeholder",i).blur(),setTimeout(function(){sendCommand("reloadmulti")},TIMEOUT_WAIT_TIME),setTimeout(function(){v()},2*TIMEOUT_WAIT_TIME))}function E(){sendDBUpdate("multiLinkClear","dualStreamCommand","otherChannels","Channel-1 Channel-2"),sendDBUpdate("multiLinkClear","dualStreamCommand","timerToggle","false"),setTimeout(function(){sendCommand("reloadmulti")},TIMEOUT_WAIT_TIME),setTimeout(function(){v()},2*TIMEOUT_WAIT_TIME)}function H(){$("#multiStatus").html('<span class="purplePill" data-toggle="tooltip" title="Multi-Link Enabled"><i class="fa fa-link fa-lg" /></span>'),$('[data-toggle="tooltip"]').tooltip(),sendDBUpdate("multiLinkClear","dualStreamCommand","timerToggle","true"),setTimeout(function(){sendCommand("reloadmulti")},TIMEOUT_WAIT_TIME),setTimeout(function(){v()},2*TIMEOUT_WAIT_TIME)}function W(){$("#multiStatus").html(""),sendDBUpdate("multiLinkClear","dualStreamCommand","timerToggle","false"),setTimeout(function(){sendCommand("reloadmulti")},TIMEOUT_WAIT_TIME),setTimeout(function(){v()},2*TIMEOUT_WAIT_TIME)}function N(){$("#shoutOutInput").val().length>0&&(sendCommand("shoutout "+$("#shoutOutInput").val()),$("#shoutOutInput").val(""))}function G(){$("#chatsidebar").is(":visible")?($("#chatsidebar").fadeOut(1e3),setTimeout(function(){$(".tab-pane").css("width","100%")},1e3),$(window).resize(function(){$(".tab-pane").css("width","100%")})):($("#chatsidebar").fadeIn(1e3),$(window).resize(function(){$(".tab-pane").css("width","100%").css("width","-=300px")}),$(".tab-pane").css("width","100%").css("width","-=300px"))}function L(){$("#disableVideo").is(":visible")?($("#disableVideo").fadeOut(1e3),player.pause()):($("#disableVideo").fadeIn(1e3),player.play())}function O(e){sendCommand("queue "+e)}function z(e,t){$("#amountQueue").val().length>0?sendCommand("queue "+e+" "+$("#amountQueue").val()):sendCommand("queue "+e+" 1"),$("#amountQueue").val("")}var r=[],l=[],u=!1,h=!1,c=!1,d=[],f=[];gameTitle="__not_loaded__",d["false"]='<i class="fa fa-circle-o"/>',d["true"]='<i class="fa fa-circle text-success"/>',f["false"]='<i class="fa fa-circle-o" />',f["true"]='<i class="fa fa-circle text-success"/>';var m={"./commands/":"","./games/":"","./handlers/":"","./systems/":""},g={"./discord/commands/":"","./discord/games/":"","./discord/handlers/":"","./discord/systems/":""};$("#dashboardPanel").load("/panel/dashboard.html");var K=setInterval(function(){if(isConnected&&TABS_INITIALIZED){var e=$("#tabs").tabs("option","active");0==e&&(v(),clearInterval(K))}},INITIAL_WAIT_TIME);setInterval(function(){var e=$("#tabs").tabs("option","active");0==e&&isConnected&&!isInputFocus()&&(newPanelAlert("Refreshing Dashboard Data","success",1e3),v())},3e4),$.dashboardOnMessage=y,$.dashboardDoQuery=v,$.setStreamTitle=w,$.setGameTitle=_,$.chatReconnect=A,$.setHighlight=P,$.clearHighlights=I,$.setMultiLink=B,$.setMultiLinkTimer=R,$.setMultiReqMsgs=F,$.clearMultiLink=E,$.multiLinkTimerOn=H,$.multiLinkTimerOff=W,$.toggleCommand=M,$.toggleTwitchChat=G,$.toggleTwitchVideo=L,$.toggleLog=D,$.enableModule=T,$.disableModule=C,$.adjustDeathCounter=S,$.shoutOut=N,$.disconnect=x,$.queueCMD=O,$.queueCMDNext=z,$.setLogRotate=b}();