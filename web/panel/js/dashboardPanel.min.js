(function(){function e(e){var a;try{a=JSON.parse(e.data)}catch(e){return}if(panelHasQuery(a)){if(panelMatch(a.query_id,"dashboard_highlights")){var s="";for(var n in a.results){var o=a.results[n].value;s+=o+" @ "+a.results[n].key+"<br>"}0==s.length?$("#showHighlights").html("No Highlights Found"):$("#showHighlights").html(s)}if(panelCheckQuery(a,"dashboard_modules")){var d='<table class="table table-hover table-striped">',i='<table class="table table-hover table-striped">',r=a.results,u="",m="";$.disablePanels(r),r.sort(l);for(idx in r)u=r[idx].key,m=r[idx].value,u.indexOf("/core/")===-1&&u.indexOf("/lang/")===-1&&(u.indexOf("./discord")===-1?d+="<tr>    <td>"+u.replace(/.\/commands\/|.\/games\/|.\/handlers\/|.\/systems\//gi,function(e){return O[e]})+'</td>    <td>        <div id="moduleStatus_'+idx+'">'+w[m]+'</div>    </td>    <td>        <div data-toggle="tooltip" title="Enable" class="button"             onclick="$.enableModule(\''+u+"', "+idx+')">'+U.true+'        </div>    </td>    <td>        <div data-toggle="tooltip" title="Disable" class="button"             onclick="$.disableModule(\''+u+"', "+idx+')">'+U.false+"        </div>    </td></tr>":i+="<tr>    <td>"+u.replace(/.\/discord\/commands\/|.\/discord\/games\/|.\/discord\/handlers\/|.\/discord\/systems\//gi,function(e){return L[e]})+'</td>    <td>        <div id="moduleStatus_'+idx+'">'+w[m]+'</div>    </td>    <td>        <div data-toggle="tooltip" title="Enable" class="button"             onclick="$.enableModule(\''+u+"', "+idx+')">'+U.true+'        </div>    </td>    <td>        <div data-toggle="tooltip" title="Disable" class="button"             onclick="$.disableModule(\''+u+"', "+idx+')">'+U.false+"        </div>    </td></tr>");d+="</table>",i+="</table>",$("#modulesList").html(d),$("#discordModulesList").html(i),$('[data-toggle="tooltip"]').tooltip({trigger:"hover"})}if(panelCheckQuery(a,"dashboard_chatCount")){var h="",g="",c="";k=[];for(var n=0,p=10;n<=9;n++,p--){new Date;h=$.format.date(Date.now()-24*n*36e5,"MM.dd.yy"),g="chat_"+h,c="0";for(idx in a.results)if(panelMatch(a.results[idx].key,g)){c=a.results[idx].value;break}$("#chatDate-"+n).html("<span>"+h+"</span>"),$("#chatCount-"+n).html("<spam>"+c+"</span>"),k.push([p,c])}}if(panelCheckQuery(a,"dashboard_modCount")){var T="",f="",b="";E=[];for(var n=0,p=10;n<=9;n++,p--){new Date;T=$.format.date(Date.now()-24*n*36e5,"MM.dd.yy"),f="mod_"+T,b="0";for(idx in a.results)if(panelMatch(a.results[idx].key,f)){b=a.results[idx].value;break}$("#modCount-"+n).html("<spam>"+b+"</span>"),E.push([p,b])}}if(E.length>0&&k.length>0){var _={series:{shadowSize:0,curvedLines:{apply:!0,active:!0,monotonicFit:!0},lines:{show:!1,lineWidth:0}},grid:{borderWidth:0,labelMargin:10,hoverable:!0,clickable:!0,mouseActiveRadius:6},xaxis:{tickDecimals:0,ticks:!1},yaxis:{tickDecimals:0,ticks:!1},legend:{show:!1}};$.plot($("#panelStatsGraph"),[{data:k,lines:{show:!0,fill:.85},curvedLines:{apply:!0},label:"Messages",stack:!0,color:"#1DC7EA"},{data:E,lines:{show:!0,fill:.98},label:"Timeouts",stack:!0,color:"#FF4A55"}],_),$(".flot-chart")[0]&&$(".flot-chart").bind("plothover",function(e,t,a){if(a){var s=a.datapoint[0].toFixed(2),l=Math.round(a.datapoint[1].toFixed(2)),n=Date.today().add(s-10).day().toString("dddd");$(".flot-tooltip").html(a.series.label+" on "+n+": "+l).css({top:a.pageY+5,left:a.pageX+5}).show()}else $(".flot-tooltip").hide()})}if(panelCheckQuery(a,"dashboard_panelStatsEnabled")&&(panelMatch(a.results.enabled,"true")?panelStatsEnabled||(panelStatsEnabled=!0,t()):$("#panelStatsEnabled").html("<span>Panel Stats are Disabled</span>")),panelCheckQuery(a,"dashboard_streamTitle")&&(void 0===a.results.title||null===a.results.title?$("#streamTitleInput").val("Title"):$("#streamTitleInput").val(a.results.title)),panelCheckQuery(a,"dashboard_streamlastfollow")&&(null==a.results.lastFollow?$("#lastFollow").html(""):$("#lastFollow").html("<spam>Latest Follow: "+a.results.lastFollow+" </spam>")),panelCheckQuery(a,"dashboard_streamlastresub")&&(null==a.results.lastReSub?$("#lastReSub").html(""):$("#lastReSub").html("<spam>Latest ReSub: "+a.results.lastReSub+" </spam>")),panelCheckQuery(a,"dashboard_streamlastsub")&&(null==a.results.lastSub?$("#lastSub").html(""):$("#lastSub").html("<spam>Latest Sub: "+a.results.lastSub+" </spam>")),panelCheckQuery(a,"dashboard_streamlastdonator")&&(null==a.results.lastDonator?$("#lastDonator").html(""):$("#lastDonator").html("<spam>Latest Donator: "+a.results.lastDonator+" </spam>")),panelCheckQuery(a,"dashboard_gameTitle")&&(gameTitle=a.results.game,void 0!==gameTitle&&null!==gameTitle||(gameTitle="Some Game"),$("#gameTitleInput").val(gameTitle),sendDBQuery("dashboard_deathctr","deaths",gameTitle)),panelCheckQuery(a,"dashboard_loggingModeEvent")&&(S=a.results["log.event"],$("#logEvent").html(w[S])),panelCheckQuery(a,"dashboard_loggingModeFile")&&(B=a.results["log.file"],$("#logFile").html(w[B])),panelCheckQuery(a,"dashboard_loggingModeErr")&&(Q=a.results["log.error"],$("#logError").html(w[Q])),panelCheckQuery(a,"dashboard_deathctr")){if(amount=a.results[gameTitle],null==gameTitle||null==amount)return void $("#deathCounterValue").html("0");$("#deathCounterValue").html(a.results[gameTitle])}panelCheckQuery(a,"dashboard_dsChannels")&&(void 0!==a.results.otherChannels&&null!==a.results.otherChannels?$("#multiLinkInput").val(a.results.otherChannels.replace(/\//g," ")):$("#multiLinkInput").attr("placeholder","Channel-1 Channel-2")),panelCheckQuery(a,"dashboard_dsInterval")&&(void 0!==a.results.timerInterval&&null!==a.results.timerInterval?$("#multiLinkTimerInput").attr("placeholder",a.results.timerInterval):$("#multiLinkTimerInput").attr("placeholder","Minutes")),panelCheckQuery(a,"dashboard_dsReqMsgs")&&(void 0!==a.results.reqMessages&&null!==a.results.reqMessages?$("#multiLinkReqMsgsInput").attr("placeholder",a.results.reqMessages):$("#multiLinkReqMsgsInput").attr("placeholder","Message Count")),panelCheckQuery(a,"dashboard_logRotate")&&$("#logRotateInput").val(a.results.log_rotate_days)}}function t(){sendDBQuery("dashboard_streamTitle","streamInfo","title"),sendDBQuery("dashboard_streamlastfollow","streamInfo","lastFollow"),sendDBQuery("dashboard_streamlastresub","streamInfo","lastReSub"),sendDBQuery("dashboard_streamlastsub","streamInfo","lastSub"),sendDBQuery("dashboard_streamlastdonator","streamInfo","lastDonator"),sendDBQuery("dashboard_gameTitle","streamInfo","game"),sendDBQuery("dashboard_loggingModeEvent","settings","log.event"),sendDBQuery("dashboard_loggingModeFile","settings","log.file"),sendDBQuery("dashboard_loggingModeErr","settings","log.error"),sendDBQuery("dashboard_logRotate","settings","log_rotate_days"),sendDBQuery("dashboard_dsChannels","dualStreamCommand","otherChannels"),sendDBQuery("dashboard_dsInterval","dualStreamCommand","timerInterval"),sendDBQuery("dashboard_dsReqMsgs","dualStreamCommand","reqMessages"),sendDBQuery("dashboard_deathctr","deaths",gameTitle),sendDBKeys("dashboard_highlights","highlights"),sendDBKeys("dashboard_modules","modules"),panelStatsEnabled?(sendDBKeys("dashboard_chatCount","panelchatstats"),sendDBKeys("dashboard_modCount","panelmodstats")):sendDBQuery("dashboard_panelStatsEnabled","panelstats","enabled")}function a(){var e=$("#logRotateInput").val();e.length>0&&(sendDBUpdate("dashboard_updateLogRotate","settings","log_rotate_days",e),setTimeout(function(){sendDBQuery("dashboard_logRotate","settings","log_rotate_days")},TIMEOUT_WAIT_TIME))}function s(e){panelMatch(gameTitle,"__not_loaded__")||($("#deathCounterValue").html('<i  class="fa fa-spinner fa-spin" />'),sendCommand("deathctr "+e),setTimeout(function(){sendDBQuery("dashboard_deathctr","deaths",gameTitle)},TIMEOUT_WAIT_TIME))}function l(e,t){return panelStrcmp(e.key,t.key)}function n(e,a){$("#moduleStatus_"+a).html('<i  class="fa fa-spinner fa-spin" />'),sendCommand("module enablesilent "+e),setTimeout(function(){t()},TIMEOUT_WAIT_TIME)}function o(e,a){$("#moduleStatus_"+a).html('<i  class="fa fa-spinner fa-spin" />'),sendCommand("module disablesilent "+e),setTimeout(function(){t()},TIMEOUT_WAIT_TIME)}function d(e){$("#"+e).html('<i class="fa fa-spinner fa-spin" />'),"logFile"==e&&(console.log(e),"true"==B?sendDBUpdate("dashboard_loggingModeFile","settings","log.file","false"):sendDBUpdate("dashboard_loggingModeFile","settings","log.file","true")),"logError"==e&&("true"==Q?sendDBUpdate("dashboard_loggingModeFile","settings","log.error","false"):sendDBUpdate("dashboard_loggingModeFile","settings","log.error","true")),"logEvent"==e&&("true"==S?sendDBUpdate("dashboard_loggingModeFile","settings","log.event","false"):sendDBUpdate("dashboard_loggingModeFile","settings","log.event","true")),sendCommand("reloadlogs"),setTimeout(function(){t()},TIMEOUT_WAIT_TIME)}function i(e){panelMatch(e,"pausecommands")&&(e+=$.globalPauseMode?" clear":" 300"),sendCommand(e),setTimeout(function(){$.globalDoQuery()},TIMEOUT_WAIT_TIME)}function r(){var e=$("#streamTitleInput").val();e.length>0&&(sendCommand("settitlesilent "+e),$("#streamTitleInput").val(e))}function u(){var e=$("#gameTitleInput").val();e.length>0&&(sendCommand("setgamesilent "+e),$("#gameTitleInput").val(e),gameTitle=e)}function m(){sendCommand("reconnect")}function h(){sendCommand("disconnect")}function g(){$("#showHighlights").html('<i  class="fa fa-spinner fa-spin" />'),sendCommand("highlightpanel "+$("#highlightInput").val()),$("#highlightInput").val(""),setTimeout(function(){sendDBKeys("dashboard_highlights","highlights")},TIMEOUT_WAIT_TIME)}function c(){$("#showHighlightspanel").html('<i  class="fa fa-spinner fa-spin" />'),sendCommand("clearhighlights"),setTimeout(function(){sendDBKeys("dashboard_highlights","highlights")},TIMEOUT_WAIT_TIME)}function p(e,a){var s=$(e).val();s.length>0&&(sendDBUpdate("multiLinkInput","dualStreamCommand",a,s.replace(/\s+/g,"/")),$(e).val(""),$(e).attr("placeholder",s).blur(),setTimeout(function(){sendCommand("reloadmulti")},TIMEOUT_WAIT_TIME),setTimeout(function(){t()},2*TIMEOUT_WAIT_TIME))}function T(e,a){var s=$(e).val();parseInt(s)>=5&&s.length>0&&(sendDBUpdate("multiLinkTimerInput","dualStreamCommand",a,s),$(e).val(""),$(e).attr("placeholder",s).blur(),setTimeout(function(){sendCommand("reloadmulti")},TIMEOUT_WAIT_TIME),setTimeout(function(){t()},2*TIMEOUT_WAIT_TIME))}function f(e,a){var s=$(e).val();s.length>0&&(sendDBUpdate("multiLinkReqMsgsInput","dualStreamCommand",a,s),$(e).val(""),$(e).attr("placeholder",s).blur(),setTimeout(function(){sendCommand("reloadmulti")},TIMEOUT_WAIT_TIME),setTimeout(function(){t()},2*TIMEOUT_WAIT_TIME))}function b(){sendDBUpdate("multiLinkClear","dualStreamCommand","otherChannels","Channel-1 Channel-2"),sendDBUpdate("multiLinkClear","dualStreamCommand","timerToggle","false"),setTimeout(function(){sendCommand("reloadmulti")},TIMEOUT_WAIT_TIME),setTimeout(function(){t()},2*TIMEOUT_WAIT_TIME)}function _(){$("#multiStatus").html('<span class="purplePill" data-toggle="tooltip" title="Multi-Link Enabled"><i class="fa fa-link fa-lg" /></span>'),$('[data-toggle="tooltip"]').tooltip(),sendDBUpdate("multiLinkClear","dualStreamCommand","timerToggle","true"),setTimeout(function(){sendCommand("reloadmulti")},TIMEOUT_WAIT_TIME),setTimeout(function(){t()},2*TIMEOUT_WAIT_TIME)}function I(){$("#multiStatus").html(""),sendDBUpdate("multiLinkClear","dualStreamCommand","timerToggle","false"),setTimeout(function(){sendCommand("reloadmulti")},TIMEOUT_WAIT_TIME),setTimeout(function(){t()},2*TIMEOUT_WAIT_TIME)}function v(){$("#shoutOutInput").val().length>0&&(sendCommand("shoutout "+$("#shoutOutInput").val()),$("#shoutOutInput").val(""))}function M(){$("#chatsidebar").is(":visible")?($("#chatsidebar").fadeOut(1e3),setTimeout(function(){$(".tab-pane").css("width","100%")},1e3),$(window).resize(function(){$(".tab-pane").css("width","100%")})):($("#chatsidebar").fadeIn(1e3),$(window).resize(function(){$(".tab-pane").css("width","100%").css("width","-=300px")}),$(".tab-pane").css("width","100%").css("width","-=300px"))}function C(){$("#disableVideo").is(":visible")?($("#disableVideo").fadeOut(1e3),player.pause()):($("#disableVideo").fadeIn(1e3),player.play())}function y(e){sendCommand("queue "+e)}function D(e,t){$("#amountQueue").val().length>0?sendCommand("queue "+e+" "+$("#amountQueue").val()):sendCommand("queue "+e+" 1"),$("#amountQueue").val("")}var E=[],k=[],S=!1,Q=!1,B=!1,w=[],U=[];gameTitle="__not_loaded__",w.false='<i class="fa fa-circle text-warning"/>',w.true='<i class="fa fa-circle text-success"/>',U.false='<i class="fa fa-circle-o" />',U.true='<i class="fa fa-circle" />';var O={"./commands/":"","./games/":"","./handlers/":"","./systems/":""},L={"./discord/commands/":"","./discord/games/":"","./discord/handlers/":"","./discord/systems/":""};$("#dashboardPanel").load("/panel/dashboard.html");var x=setInterval(function(){if(isConnected&&TABS_INITIALIZED){var e=$("#tabs").tabs("option","active");0==e&&(t(),clearInterval(x))}},INITIAL_WAIT_TIME);setInterval(function(){var e=$("#tabs").tabs("option","active");0==e&&isConnected&&!isInputFocus()&&(newPanelAlert("Refreshing Dashboard Data","success",1e3),t())},3e4),$.dashboardOnMessage=e,$.dashboardDoQuery=t,$.setStreamTitle=r,$.setGameTitle=u,$.chatReconnect=m,$.setHighlight=g,$.clearHighlights=c,$.setMultiLink=p,$.setMultiLinkTimer=T,$.setMultiReqMsgs=f,$.clearMultiLink=b,$.multiLinkTimerOn=_,$.multiLinkTimerOff=I,$.toggleCommand=i,$.toggleTwitchChat=M,$.toggleTwitchVideo=C,$.toggleLog=d,$.enableModule=n,$.disableModule=o,$.adjustDeathCounter=s,$.shoutOut=v,$.disconnect=h,$.queueCMD=y,$.queueCMDNext=D,$.setLogRotate=a})();