!function(){function a(e){var a,n=["Caster","Administrator","Moderator","Subscriber","Donator","Regular","Viewer"];timezone="GMT";try{a=JSON.parse(e.data)}catch(o){return}if(panelHasQuery(a)){if(panelCheckQuery(a,"points_toplist")&&$("#topListAmountPoints").val(a.results.topListAmountPoints),panelCheckQuery(a,"points_settings"))for(p in a.results){var s="",l="";s=a.results[p].key,l=a.results[p].value,panelMatch(s,"onlineGain")?$("#setPointGainInput_setgain").val(l):panelMatch(s,"offlineGain")?$("#setPointGainInput_setofflinegain").val(l):panelMatch(s,"onlinePayoutInterval")?$("#setPointGainInput_setinterval").val(l):panelMatch(s,"offlinePayoutInterval")?$("#setPointGainInput_setofflineinterval").val(l):panelMatch(s,"pointNameSingle")?$("#setPointNameInput").val(l):panelMatch(s,"pointNameMultiple")?$("#setPointsNameInput").val(l):panelMatch(s,"pointsMessage")?$("#pointsMessageInput").val(l):panelMatch(s,"activeBonus")&&$("#setPointGainInput_setactivebonus").val(l)}if(panelCheckQuery(a,"points_pointstable")){var u=a.results,h="",c="",f="";$("#userPtsTableTitle").html("User Points Table (Refreshing <i class='fa fa-spinner fa-spin' aria-hidden='true'></i>)"),u.sort(r),f="<table class='table table-hover table-striped' data-paging='true' data-paging-size='8'       data-filtering='true' data-filter-delay='200'       data-sorting='true'       data-paging-count-format='Rows {PF}-{PL} / {TR}' data-show-header='true'>",f+="<thead><tr>    <th data-breakpoints='xs'>Username</th>    <th data-filterable='false' data-type='number'>Points</th></tr></thead><tbody>";for(var p=0;p<u.length;p++)h=u[p].key,c=u[p].value,f+="<tr onclick='$.copyUserPoints(\""+h+'", "'+c+"\")' >    <td>"+h+"</td>    <td>"+c+"</td></tr>";f+="</tbody></table>",$("#userPointsTable").html(f),$(".table").footable({on:{"postdraw.ft.table":function(e,t){$("#userPtsTableTitle").html("User Points Table")}}}),handleInputFocus()}if(panelCheckQuery(a,"points_pricecommods")){var l=a.results.pricecomMods;(null==l||void 0==l)&&(l="false"),t=l,$("#priceComMods").html(i[l])}if(panelCheckQuery(a,"points_grouppoints")){var m="",g="",y=[];f="<table class='table table-hover table-striped'>";for(var p=0;p<a.results.length;p++)m=a.results[p].key,g=a.results[p].value,y[m]=g;for(s in n)m=n[s],g=y[m],f+='<tr >    <td>   <button id="clearGroupPoints_" class="btn btn-default btn-fill btn-xs" type="button" onclick="$.updateGroupPoints(\''+m+'\', true, true)"><i class="fa fa-trash" /></button>    <td>'+m+'</td>    <td><form role="form" onkeypress="return event.keyCode != 13"><div class="input-group">        <input class="form-control" type="number" min="-1" id="inlineGroupPointsEdit_'+m+'"               value="'+g+'" style="width: 5em"/><span class="input-group-btn">        <button type="button" class="btn btn-default btn-fill btn-xs"               onclick="$.updateGroupPoints(\''+m+'\', true, false)"><i class="fa fa-pencil" /></button></span></div></form></td>',f+="</tr>";$("#groupPointsTable").html(f),handleInputFocus()}if(panelCheckQuery(a,"points_grouppointsoffline")){var m="",g="",y=[];f="<table class='table table-hover table-striped'>";for(var p=0;p<a.results.length;p++)m=a.results[p].key,g=a.results[p].value,y[m]=g;for(s in n)m=n[s],g=y[m],f+='<tr >    <td><button id="clearGroupPointsOffline_" class="btn btn-default btn-fill btn-xs" type="button" onclick="$.updateGroupPoints(\''+m+'\', false, true)"><i class="fa fa-trash" /></button>    <td>'+m+'</td>    <td>    <form role="form" lpformnum="9"  onkeypress="return event.keyCode != 13"><div class="input-group"><input type="number" min="-1" class="form-control" id="inlineGroupPointsOfflineEdit_'+m+'"value="'+g+'" /><span class="input-group-btn"><button type="button" class="btn btn-default btn-fill btn-xs"onclick="$.updateGroupPoints(\''+m+'\', false, false)"><i class="fa fa-pencil" /></button></span></div></form></td>',f+="</tr>";$("#groupPointsOfflineTable").html(f),handleInputFocus()}}}function n(){sendDBKeys("points_settings","pointSettings"),sendDBKeys("points_pointstable","points"),sendDBQuery("points_toplist","settings","topListAmountPoints"),sendDBKeys("points_grouppoints","grouppoints"),sendDBQuery("points_pricecommods","settings","pricecomMods"),sendDBKeys("points_grouppointsoffline","grouppointsoffline")}function o(){sendDBKeys("points_settings","pointSettings"),sendDBQuery("points_toplist","settings","topListAmountPoints"),sendDBKeys("points_grouppoints","grouppoints"),sendDBQuery("points_pricecommods","settings","pricecomMods"),sendDBKeys("points_grouppointsoffline","grouppointsoffline")}function r(e,t){return panelStrcmp(e.key,t.key)}function s(e,t,i){var a=t?"#inlineGroupPointsEdit_"+e:"#inlineGroupPointsOfflineEdit_"+e,n=i?"-1":$(a).val(),r=t?"grouppoints":"grouppointsoffline";n.length>0&&(sendDBUpdate("points_updateGroupPoints",r,e,n),setTimeout(function(){o()},TIMEOUT_WAIT_TIME),setTimeout(function(){sendCommand("reloadpoints")},TIMEOUT_WAIT_TIME))}function l(e,t){$("#adjustUserPointsNameInput").val(e),$("#adjustUserPointsInput").val(t),$("#adjustUserPointsNameInput").focus()}function u(){var e=$("#setPointNameInput").val(),t=$("#setPointsNameInput").val();return e.match(/\s/gi)||t.match(/\s/gi)?($("#setPointsNameInput").val("Your points name cannot contain a space."),void setTimeout(function(){o()},2*TIMEOUT_WAIT_TIME)):(0!=e.length&&sendDBUpdate("points_settings","pointSettings","pointNameSingle",e),0!=t.length&&sendDBUpdate("points_settings","pointSettings","pointNameMultiple",t),setTimeout(function(){o()},TIMEOUT_WAIT_TIME),void setTimeout(function(){sendCommand("reloadpoints")},TIMEOUT_WAIT_TIME))}function h(){sendDBUpdate("points_settings","pointSettings","pointNameMultiple","points"),sendDBUpdate("points_settings","pointSettings","pointNameSingle","point"),setTimeout(function(){o()},TIMEOUT_WAIT_TIME),setTimeout(function(){sendCommand("reloadpoints")},TIMEOUT_WAIT_TIME)}function c(e){var t=$("#setPointGainInput_"+e).val();return t.length<=0?void setTimeout(function(){$("#setPointGainInput_"+e).val("")},TIMEOUT_WAIT_TIME):("setgain"==e&&sendDBUpdate("points_settings","pointSettings","onlineGain",t),"setofflinegain"==e&&sendDBUpdate("points_settings","pointSettings","offlineGain",t),"setinterval"==e&&sendDBUpdate("points_settings","pointSettings","onlinePayoutInterval",t),"setofflineinterval"==e&&sendDBUpdate("points_settings","pointSettings","offlinePayoutInterval",t),"setactivebonus"==e&&sendDBUpdate("points_settings","pointSettings","activeBonus",t),setTimeout(function(){o()},TIMEOUT_WAIT_TIME),void setTimeout(function(){sendCommand("reloadpoints")},TIMEOUT_WAIT_TIME))}function d(){var e=$("#pointsMessageInput").val();e.length>0&&sendDBUpdate("points_settings","pointSettings","pointsMessage",e),setTimeout(function(){o()},TIMEOUT_WAIT_TIME),setTimeout(function(){sendCommand("reloadpoints")},TIMEOUT_WAIT_TIME)}function f(e){var t=$("#adjustUserPointsNameInput").val(),i=$("#adjustUserPointsInput").val();"take"==e&&t.length>0&&i.length>0&&sendDBDecr("points","points",t,i),"add"==e&&t.length>0&&i.length>0&&sendDBIncr("points","points",t,i),"set"==e&&t.length>0&&0!=i.length&&sendDBUpdate("points","points",t,i),$("#adjustUserPointsNameInput").val(""),$("#adjustUserPointsInput").val(""),setTimeout(function(){n()},TIMEOUT_WAIT_TIME),setTimeout(function(){sendCommand("reloadpoints")},TIMEOUT_WAIT_TIME)}function p(e){var t=$("#giftChatPointsInput").val(),i="";t.length>0&&(panelMatch(e,"all")&&(i="pointsallpanel "+t),panelMatch(e,"makeitrain")&&(i="makeitrain "+t),panelMatch(e,"bonus")&&(i="pointsbonuspanel "+t),panelMatch(e,"take")&&(i="pointstakeallpanel "+t),$("#giftChatPointsInput").val(""),sendCommand(i),setTimeout(function(){n()},2*TIMEOUT_WAIT_TIME))}function m(){var e=$("#penaltyUser").val(),t=$("#penaltyUserTime").val();0!=t.length&&0!=e.length?(sendCommand("penalty "+e+" "+t),$("#penaltyUser").val(e+" wont gain points for "+t+" minutes.")):$("#penaltyUser").val("Error."),$("#penaltyUserTime").val(""),setTimeout(function(){$("#penaltyUser").val("")},10*TIMEOUT_WAIT_TIME)}function g(){var e=$("#topListAmountPoints").val();0!=e.length&&sendDBUpdate("points_toplist","settings","topListAmountPoints",e),setTimeout(function(){o()},TIMEOUT_WAIT_TIME),setTimeout(function(){sendCommand("reloadtop")},TIMEOUT_WAIT_TIME)}function y(){$("#priceComMods").html('<i  class="fa fa-spinner fa-spin" />'),"true"==t?sendDBUpdate("points_modprice","settings","pricecomMods","false"):sendDBUpdate("points_modprice","settings","pricecomMods","true"),sendCommand("reloadinit"),setTimeout(function(){o()},TIMEOUT_WAIT_TIME)}var t=!1,i=[];i["false"]='<i class="fa fa-circle-o"/>',i["true"]='<i class="fa fa-circle text-success"/>',$("#pointsPanel").load("/panel/points.html");var v=setInterval(function(){if(isConnected&&TABS_INITIALIZED){var e=$("#tabs").tabs("option","active");3==e&&(n(),clearInterval(v))}},INITIAL_WAIT_TIME);setInterval(function(){var e=$("#tabs").tabs("option","active");3==e&&isConnected&&!isInputFocus()&&(newPanelAlert("Refreshing Points Data","success",1e3),o())},3e4),$.pointsOnMessage=a,$.pointsDoQuery=n,$.updateGroupPoints=s,$.setPointName=u,$.clearPointName=h,$.setPointGain=c,$.giftChatPoints=p,$.copyUserPoints=l,$.modifyUserPoints=f,$.penaltyUser=m,$.topListPoints=g,$.toggleModPriceCom=y,$.setInterval=setInterval,$.setPointsMessage=d}();