!function(){function i(e){var i,r=["Caster","Administrator","Moderator","Subscriber","Donator","Regular","Viewer"];timezone="GMT";try{i=JSON.parse(e.data)}catch(n){return}if(panelHasQuery(i)){if(panelCheckQuery(i,"points_toplist")&&$("#topListAmountPoints").val(i.results.topListAmountPoints),panelCheckQuery(i,"points_settings"))for(g in i.results){var s="",l="";s=i.results[g].key,l=i.results[g].value,panelMatch(s,"onlineGain")?$("#setPointGainInput_setgain").val(l):panelMatch(s,"offlineGain")?$("#setPointGainInput_setofflinegain").val(l):panelMatch(s,"onlinePayoutInterval")?$("#setPointGainInput_setinterval").val(l):panelMatch(s,"offlinePayoutInterval")?$("#setPointGainInput_setofflineinterval").val(l):panelMatch(s,"pointNameSingle")?$("#setPointNameInput").val(l):panelMatch(s,"pointNameMultiple")?$("#setPointsNameInput").val(l):panelMatch(s,"pointsMessage")?$("#pointsMessageInput").val(l):panelMatch(s,"activeBonus")&&$("#setPointGainInput_setactivebonus").val(l)}if(panelCheckQuery(i,"points_pointstable")){var u=i.results,d="",h="",m="";$("#userPtsTableTitle").html("User Points Table (Refreshing <i class='fa fa-spinner fa-spin' aria-hidden='true'></i>)"),u.sort(t),m="<table class='table table-hover table-striped' data-paging='true' data-paging-size='8'       data-filtering='true' data-filter-delay='200'       data-sorting='true'       data-paging-count-format='Rows {PF}-{PL} / {TR}' data-show-header='true'>",m+="<thead><tr>    <th data-breakpoints='xs'>Username</th>    <th data-filterable='false' data-type='number'>Points</th></tr></thead><tbody>";for(var g=0;g<u.length;g++)d=u[g].key,h=u[g].value,m+="<tr onclick='$.copyUserPoints(\""+d+'", "'+h+"\")' >    <td>"+d+"</td>    <td>"+h+"</td></tr>";m+="</tbody></table>",$("#userPointsTable").html(m),$(".table").footable({on:{"postdraw.ft.table":function(e,a){$("#userPtsTableTitle").html("User Points Table")}}}),handleInputFocus()}if(panelCheckQuery(i,"points_pricecommods")){var l=i.results.pricecomMods;(null==l||void 0==l)&&(l="false"),a=l,$("#priceComMods").html(o[l])}if(panelCheckQuery(i,"points_grouppoints")){var S="",p="",y=[];m="<table class='table table-hover table-striped'>";for(var g=0;g<i.results.length;g++)S=i.results[g].key,p=i.results[g].value,y[S]=p;for(s in r)S=r[s],p=y[S],m+='<tr >    <td>   <button id="clearGroupPoints_" class="btn btn-default btn-fill btn-xs" type="button" onclick="$.updateGroupPoints(\''+S+'\', true, true)"><i class="fa fa-trash" /></button>    <td>'+S+'</td>    <td><form role="form" onkeypress="return event.keyCode != 13"><div class="input-group">        <input class="form-control" type="number" min="-1" id="inlineGroupPointsEdit_'+S+'"               value="'+p+'" style="width: 5em"/><span class="input-group-btn">        <button type="button" class="btn btn-default btn-fill btn-xs"               onclick="$.updateGroupPoints(\''+S+'\', true, false)"><i class="fa fa-pencil" /></button></span></div></form></td>',m+="</tr>";$("#groupPointsTable").html(m),handleInputFocus()}if(panelCheckQuery(i,"points_grouppointsoffline")){var S="",p="",y=[];m="<table class='table table-hover table-striped'>";for(var g=0;g<i.results.length;g++)S=i.results[g].key,p=i.results[g].value,y[S]=p;for(s in r)S=r[s],p=y[S],m+='<tr >    <td><button id="clearGroupPointsOffline_" class="btn btn-default btn-fill btn-xs" type="button" onclick="$.updateGroupPoints(\''+S+'\', false, true)"><i class="fa fa-trash" /></button>    <td>'+S+'</td>    <td>    <form role="form" lpformnum="9"  onkeypress="return event.keyCode != 13"><div class="input-group"><input type="number" min="-1" class="form-control" id="inlineGroupPointsOfflineEdit_'+S+'"value="'+p+'" /><span class="input-group-btn"><button type="button" class="btn btn-default btn-fill btn-xs"onclick="$.updateGroupPoints(\''+S+'\', false, false)"><i class="fa fa-pencil" /></button></span></div></form></td>',m+="</tr>";$("#groupPointsOfflineTable").html(m),handleInputFocus()}}}function r(){sendDBKeys("points_settings","pointSettings"),sendDBKeys("points_pointstable","points"),sendDBQuery("points_toplist","settings","topListAmountPoints"),sendDBKeys("points_grouppoints","grouppoints"),sendDBQuery("points_pricecommods","settings","pricecomMods"),sendDBKeys("points_grouppointsoffline","grouppointsoffline")}function n(){sendDBKeys("points_settings","pointSettings"),sendDBQuery("points_toplist","settings","topListAmountPoints"),sendDBKeys("points_grouppoints","grouppoints"),sendDBQuery("points_pricecommods","settings","pricecomMods"),sendDBKeys("points_grouppointsoffline","grouppointsoffline")}function t(e,a){return panelStrcmp(e.key,a.key)}function s(e,a,o){var i=a?"#inlineGroupPointsEdit_"+e:"#inlineGroupPointsOfflineEdit_"+e,r=o?"-1":$(i).val(),t=a?"grouppoints":"grouppointsoffline";r.length>0&&(sendDBUpdate("points_updateGroupPoints",t,e,r),setTimeout(function(){n()},TIMEOUT_WAIT_TIME),setTimeout(function(){sendCommand("reloadpoints")},TIMEOUT_WAIT_TIME))}function l(e,a){$("#adjustUserPointsNameInput").val(e),$("#adjustUserPointsInput").val(a),$("#adjustUserPointsNameInput").focus()}function u(){var e=$("#setPointNameInput").val(),a=$("#setPointsNameInput").val();return e.match(/\s/gi)||a.match(/\s/gi)?($("#setPointsNameInput").val("Your points name cannot contain a space."),void setTimeout(function(){n()},2*TIMEOUT_WAIT_TIME)):(0!=e.length&&sendDBUpdate("points_settings","pointSettings","pointNameSingle",e),0!=a.length&&sendDBUpdate("points_settings","pointSettings","pointNameMultiple",a),setTimeout(function(){n()},TIMEOUT_WAIT_TIME),void setTimeout(function(){sendCommand("reloadpoints")},TIMEOUT_WAIT_TIME))}function d(){sendDBUpdate("points_settings","pointSettings","pointNameMultiple","points"),sendDBUpdate("points_settings","pointSettings","pointNameSingle","point"),setTimeout(function(){n()},TIMEOUT_WAIT_TIME),setTimeout(function(){sendCommand("reloadpoints")},TIMEOUT_WAIT_TIME)}function h(e){var a=$("#setPointGainInput_"+e).val();return a.length<=0?void setTimeout(function(){$("#setPointGainInput_"+e).val("")},TIMEOUT_WAIT_TIME):("setgain"==e&&sendDBUpdate("points_settings","pointSettings","onlineGain",a),"setofflinegain"==e&&sendDBUpdate("points_settings","pointSettings","offlineGain",a),"setinterval"==e&&sendDBUpdate("points_settings","pointSettings","onlinePayoutInterval",a),"setofflineinterval"==e&&sendDBUpdate("points_settings","pointSettings","offlinePayoutInterval",a),"setactivebonus"==e&&sendDBUpdate("points_settings","pointSettings","activeBonus",a),setTimeout(function(){n()},TIMEOUT_WAIT_TIME),void setTimeout(function(){sendCommand("reloadpoints")},TIMEOUT_WAIT_TIME))}function c(){var e=$("#pointsMessageInput").val();e.length>0&&sendDBUpdate("points_settings","pointSettings","pointsMessage",e),setTimeout(function(){n()},TIMEOUT_WAIT_TIME),setTimeout(function(){sendCommand("reloadpoints")},TIMEOUT_WAIT_TIME)}function m(e){var a=$("#adjustUserPointsNameInput").val(),o=$("#adjustUserPointsInput").val();"take"==e&&a.length>0&&o.length>0&&sendDBDecr("points","points",a,o),"add"==e&&a.length>0&&o.length>0&&sendDBIncr("points","points",a,o),"set"==e&&a.length>0&&0!=o.length&&sendDBUpdate("points","points",a,o),$("#adjustUserPointsNameInput").val(""),$("#adjustUserPointsInput").val(""),setTimeout(function(){r()},TIMEOUT_WAIT_TIME),setTimeout(function(){sendCommand("reloadpoints")},TIMEOUT_WAIT_TIME)}function g(e){var a=$("#giftChatPointsInput").val(),o="";a.length>0&&(panelMatch(e,"all")&&(o="pointsallpanel "+a),panelMatch(e,"makeitrain")&&(o="makeitrain "+a),panelMatch(e,"bonus")&&(o="pointsbonuspanel "+a),panelMatch(e,"take")&&(o="pointstakeallpanel "+a),$("#giftChatPointsInput").val(""),sendCommand(o),setTimeout(function(){r()},2*TIMEOUT_WAIT_TIME))}function S(){var e=$("#penaltyUser").val(),a=$("#penaltyUserTime").val();0!=a.length&&0!=e.length?(sendCommand("penalty "+e+" "+a),$("#penaltyUser").val(e+" wont gain points for "+a+" minutes.")):$("#penaltyUser").val("Error."),$("#penaltyUserTime").val(""),setTimeout(function(){$("#penaltyUser").val("")},10*TIMEOUT_WAIT_TIME)}function p(){var e=$("#topListAmountPoints").val();0!=e.length&&sendDBUpdate("points_toplist","settings","topListAmountPoints",e),setTimeout(function(){n()},TIMEOUT_WAIT_TIME),setTimeout(function(){sendCommand("reloadtop")},TIMEOUT_WAIT_TIME)}function y(){$("#priceComMods").html('<i  class="fa fa-spinner fa-spin" />'),"true"==a?sendDBUpdate("points_modprice","settings","pricecomMods","false"):sendDBUpdate("points_modprice","settings","pricecomMods","true"),sendCommand("reloadinit"),setTimeout(function(){n()},TIMEOUT_WAIT_TIME)}var a=!1,o=[];o["false"]='<i class="fa fa-circle text-warning"/>',o["true"]='<i class="fa fa-circle text-success"/>',$("#pointsPanel").load("/panel/points.html");var T=setInterval(function(){if(isConnected&&TABS_INITIALIZED){var e=$("#tabs").tabs("option","active");3==e&&(r(),clearInterval(T))}},INITIAL_WAIT_TIME);setInterval(function(){var e=$("#tabs").tabs("option","active");3==e&&isConnected&&!isInputFocus()&&(newPanelAlert("Refreshing Points Data","success",1e3),n())},3e4),$.pointsOnMessage=i,$.pointsDoQuery=r,$.updateGroupPoints=s,$.setPointName=u,$.clearPointName=d,$.setPointGain=h,$.giftChatPoints=g,$.copyUserPoints=l,$.modifyUserPoints=m,$.penaltyUser=S,$.topListPoints=p,$.toggleModPriceCom=y,$.setInterval=setInterval,$.setPointsMessage=c}();