!function(){function S(e){var t=parseInt(e),n=0,o=0,r=0,s="",l=function(e){return 10>e?"0"+e:e};return t>86400?(n=t/86400,t%=86400,s+=l(Math.floor(n))+":"):s+="00:",t>3600?(o=t/3600,t%=3600,s+=l(Math.floor(o))+":"):s+="00:",r=t/60,s+=l(Math.floor(r))}function v(e){return void 0==e?"No Data":$.format.date(parseInt(e),"MM.dd.yy hh:mm:ss")}function T(e){var t,T="",k="";htmlData=[];try{t=JSON.parse(e.data)}catch(b){return}if(panelHasQuery(t)){if(0===t.query_id.indexOf("viewers_"))for(A in t.results){var M=t.results[A].key,D=t.results[A].value;void 0===u[M]&&u.push(M),panelCheckQuery(t,"viewers_groups")&&(c[M]=D,0==D.indexOf("0")&&(c[M]="1")),panelCheckQuery(t,"viewers_time")&&(d[M]=D),panelCheckQuery(t,"viewers_points")&&(f[M]=D),panelCheckQuery(t,"viewers_lastseen")&&(h[M]=D),panelCheckQuery(t,"viewers_timeout")&&(m[M]=D),panelCheckQuery(t,"viewers_chat")&&(p[M]=D),panelCheckQuery(t,"viewers_followed")&&(g[M]=D)}if(a=a?!0:panelCheckQuery(t,"viewers_groups"),n=n?!0:panelCheckQuery(t,"viewers_time"),o=o?!0:panelCheckQuery(t,"viewers_points"),i=i?!0:panelCheckQuery(t,"viewers_lastseen"),l=l?!0:panelCheckQuery(t,"viewers_followed"),s=s?!0:panelCheckQuery(t,"viewers_timeout"),r=r?!0:panelCheckQuery(t,"viewers_chat"),i&&a&&n&&o&&l&&(!panelStatsEnabled||panelStatsEnabled&&r&&s)){u.sort(C);for(var A in u)T=u[A],void 0==c[T]&&(c[T]="7"),panelIsDefined(f[T])||(f[T]="0"),panelIsDefined(m[T])||(m[T]="0"),panelIsDefined(p[T])||(p[T]="0"),panelIsDefined(g[T])||(g[T]="false"),panelIsDefined(d[T])||(d[T]="0"),y[T]={group:c[T],time:d[T],points:f[T],lastseen:h[T],followed:g[T],timeout:panelStatsEnabled?m[T]:0,chat:panelStatsEnabled?p[T]:0};k="<table class='CLASS_STRING table table-hover table-striped' data-paging='true' data-paging-size='8'       data-filtering='true' data-filter-delay='200'       data-sorting='true'       data-paging-count-format='Rows {PF}-{PL} / {TR}' data-show-header='true'><thead><tr>    <th data-breakpoints='xs'>User</th>    <th data-type='Date'>Last Seen</th>    <th data-type='Date'>Time in Chat</th>    <th data-type='number' data-container='body' data-toggle='tooltip' title='Points'><i class='fa fa-money' /></th>    <th data-type='number' data-container='body' data-toggle='tooltip' title='Messages'><i class='fa fa-comment' /></th>    <th data-type='number' data-container='body' data-toggle='tooltip' title='Bans'><i class='fa fa-ban' /></th>    <th data-toggle='tooltip' data-container='body' title='Promotions'><i class='fa fa-heart' /></th></tr></thead><tbody>",htmlData[1]=k.replace("CLASS_STRING","table_1"),htmlData[2]=k.replace("CLASS_STRING","table_2"),htmlData[3]=k.replace("CLASS_STRING","table_3"),htmlData[4]=k.replace("CLASS_STRING","table_4"),htmlData[6]=k.replace("CLASS_STRING","table_6"),htmlData[7]=k.replace("CLASS_STRING","table_7");for(var T in y)htmlData[y[T].group.toString()]+="<tr >    <td>"+T+"</td>    <td>"+v(y[T].lastseen)+"</td>    <td>"+S(y[T].time)+"</td>    <td>"+y[T].points+"</td>",panelStatsEnabled?htmlData[y[T].group.toString()]+="    <td>"+y[T].chat+"</td>    <td>"+y[T].timeout+"</td>":htmlData[y[T].group.toString()]+="    <td>0</td>    <td>0</td>",0===panelStrcmp(y[T].followed,"true")?htmlData[y[T].group.toString()]+="    <td>&hearts;</td>":htmlData[y[T].group.toString()]+="    <td>&nbsp;</td>",htmlData[y[T].group.toString()]+="</tr>";htmlData[1]+="</tbody></table>",htmlData[2]+="</tbody></table>",htmlData[3]+="</tbody></table>",htmlData[4]+="</tbody></table>",htmlData[6]+="</tbody></table>",htmlData[7]+="</tbody></table>",$("#viewersAdminList").html(htmlData[1]),$(".table_1").footable(),$("#viewersModList").html(htmlData[2]),$(".table_2").footable(),$("#viewersSubList").html(htmlData[3]),$(".table_3").footable(),$("#viewersDonatorList").html(htmlData[4]),$(".table_4").footable(),$("#viewersRegList").html(htmlData[6]),$(".table_6").footable(),$("#viewersViewerList").html(htmlData[7]),$(".table_7").footable(),a=!1,n=!1,o=!1,i=!1,s=!1,r=!1,l=!1,h=[],c=[],d=[],f=[],p=[],m=[],g=[],y=[],u=[],htmlData=[]}}}function k(){sendDBKeys("viewers_lastseen","lastseen"),sendDBKeys("viewers_groups","group"),sendDBKeys("viewers_time","time"),sendDBKeys("viewers_points","points"),sendDBKeys("viewers_followed","followed"),sendDBKeys("viewers_visited","visited"),panelStatsEnabled&&(sendDBKeys("viewers_timeout","panelmoduserstats"),sendDBKeys("viewers_chat","panelchatuserstats")),$("#viewersAdminList").html("Refreshing Data <i class='fa fa-spinner fa-spin' aria-hidden='true'></i>"),$("#viewersModList").html("Refreshing Data <i class='fa fa-spinner fa-spin' aria-hidden='true'></i>"),$("#viewersSubList").html("Refreshing Data <i class='fa fa-spinner fa-spin' aria-hidden='true'></i>"),$("#viewersDonatorList").html("Refreshing Data <i class='fa fa-spinner fa-spin' aria-hidden='true'></i>"),$("#viewersRegList").html("Refreshing Data <i class='fa fa-spinner fa-spin' aria-hidden='true'></i>"),$("#viewersViewerList").html("Refreshing Data <i class='fa fa-spinner fa-spin' aria-hidden='true'></i>")}function C(e,t){return panelStrcmp(e,t)}function M(e){var t=$("#promoteUser"+e).val();0!=t.length&&("Admin"==e&&(sendDBUpdate("user_perm","group",t.toLowerCase(),"1"),sendCommand("permissionsetuser "+t.toLowerCase()+" 1")),"Mod"==e&&(sendDBUpdate("user_perm","group",t.toLowerCase(),"2"),sendCommand("permissionsetuser "+t.toLowerCase()+" 2")),"Sub"==e&&(sendDBUpdate("user_perm","group",t.toLowerCase(),"3"),sendCommand("permissionsetuser "+t.toLowerCase()+" 3")),"Donator"==e&&(sendDBUpdate("user_perm","group",t.toLowerCase(),"4"),sendCommand("permissionsetuser "+t.toLowerCase()+" 4")),"Reg"==e&&(sendDBUpdate("user_perm","group",t.toLowerCase(),"6"),sendCommand("permissionsetuser "+t.toLowerCase()+" 6"))),$("#promoteUser"+e).val(""),k()}function D(e){var t=$("#unPromoteUser"+e).val();0!=t.length&&(sendDBDelete("user_perm","group",t.toLowerCase()),sendCommand("permissionsetuser "+t.toLowerCase()+" 7")),$("#unPromoteUser"+e).val(""),k()}function A(){var e=$("#fixFollower").val();0!=e.length&&sendDBUpdate("user_follows","followed",e.toLowerCase(),"true"),$("#fixFollower").val(""),k()}var e=[];e["false"]='<i class="fa fa-circle text-warning" />',e["true"]='<i class="fa fa-circle text-success" />';var t=[];t[0]="Caster",t[1]="Admin",t[2]="Moderator",t[3]="Subscriber",t[4]="Donator",t[6]="Regular",t[7]="Viewer";var i=!1,a=!1,n=!1,o=!1,r=!1,s=!1,l=!1,u=[],h=[],c=[],d=[],f=[],p=[],m=[],g=[],y={};$("#viewersPanel").load("/panel/viewers.html");var P=setInterval(function(){if(isConnected&&TABS_INITIALIZED){var e=$("#tabs").tabs("option","active");7==e&&(k(),clearInterval(P))}},INITIAL_WAIT_TIME);$.viewersOnMessage=T,$.viewersDoQuery=k,$.updateUserPerm=M,$.demoteUser=D,$.fixFollower=A}();