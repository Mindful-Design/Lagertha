!function(){function i(e){var t,i="",a="",n=[];try{t=JSON.parse(e.data)}catch(o){return}if(panelHasQuery(t)&&(panelCheckQuery(t,"quotes_quotemessage")&&null!==t.results.quoteMessage&&$("#quoteMessageInput").val(t.results.quoteMessage),panelCheckQuery(t,"quotes_quotes"))){if(0===t.results.length)return void $("#quoteList").html("<i>No Quotes Are Defined</i>");i='<table class="table table-hover table-striped">';for(var r in t.results)a=t.results[r].key,n=JSON.parse(t.results[r].value),quoteDataClean=JSON.parse(t.results[r].value),quoteDataClean[1]=quoteDataClean[1].replace(/,/g,"%2C").replace(/"/g,"''").replace(/'/g,"%27"),i+='<tr class="quoteBG quoteRow"><td class="centerText" rowspan="2">'+a+'</td>    <td class="col-xs-1">        <div id="deleteQuote_'+a+'" type="button" class="btn btn-danger btn-fill  btn-xs"             onclick="$.deleteQuote(\''+a+'\')"><i class="fa fa-trash" />        </div>    </td>    <td class="col-xs-2">        Date: '+$.format.date(parseInt(n[2]),"MM.dd.yy")+'    </td>    <td class="col-xs-4">        <form role="form" onkeypress="return event.keyCode != 13"><div class="form-group form-group-table"><div class="input-group">            <input type="text" class="form-control" id="inlineQuoteEdit_user_'+a+'"                   value="'+n[0]+'" /><span class="input-group-btn">            <button type="button" class="btn btn-default btn-fill  btn-xs"                    onclick="$.updateQuote(\''+a+"', '"+quoteDataClean+'\', \'user\')">                <i class="fa fa-pencil" />            </button></span></div></div></form></td>    <td class="col-xs-4">        <form role="form" onkeypress="return event.keyCode != 13"><div class="form-group form-group-table"><div class="input-group">            <input type="text" class="form-control" id="inlineQuoteEdit_game_'+a+'"                   value="'+(4==n.length?n[3]:"Some Game")+'" /><span class="input-group-btn">            <button type="button" class="btn btn-default btn-fill  btn-xs"                    onclick="$.updateQuote(\''+a+"', '"+quoteDataClean+'\', \'game\')">                <i class="fa fa-pencil" />            </button></span></div></div></form></td></tr><tr class="quoteBG">    <td colspan="5">        <form role="form" onkeypress="return event.keyCode != 13"><div class="form-group form-group-table"><div style="width: 100%" class="input-group">            <input  type="text" class="form-control" id="inlineQuoteEdit_quote_'+a+'"                   value="'+n[1].replace(/"/g,"''")+'" /><span class="input-group-btn">            <button type="button" class="btn btn-default btn-fill  btn-xs"                    onclick="$.updateQuote(\''+a+"', '"+quoteDataClean+"', 'quote')\">                <i class=\"fa fa-pencil\" />            </button></span></div></div></form></td></tr>";i+="</table>",$("#quoteList").html(i),handleInputFocus()}}function a(){sendDBKeys("quotes_quotes","quotes"),sendDBQuery("quotes_quotemessage","settings","quoteMessage")}function n(){var e=$("#quoteMessageInput").val();e.length>0&&($("#quoteMessageInput").val("Updating..."),sendDBUpdate("quotes_quotemessage","settings","quoteMessage",e),setTimeout(function(){a()},TIMEOUT_WAIT_TIME))}function o(i){$("#deleteQuote_"+i).html(e),sendCommand("delquotesilent "+i),t||(t=!0,setTimeout(function(){a(),t=!1},4*TIMEOUT_WAIT_TIME))}function r(e,t,i){var n=$("#inlineQuoteEdit_"+i+"_"+e).val(),o=t.split(",");n.length>0&&(panelMatch(i,"quote")&&(o[1]=n.replace(/"/g,"''")),panelMatch(i,"game")&&(o[1]=o[1].replace(/%2C/g,",").replace(/%27/g,"'"),o[3]=n),panelMatch(i,"user")&&(o[1]=o[1].replace(/%2C/g,",").replace(/%27/g,"'"),o[0]=n),sendDBUpdate("quotes_update","quotes",e,JSON.stringify(o)),setTimeout(function(){a()},TIMEOUT_WAIT_TIME))}function s(){var e=$("#addQuoteInput").val();e.length>0&&($("#addQuoteInput").val("Adding...").blur(),sendCommand("addquotesilent "+String(e).replace(/"/g,"''")),setTimeout(function(){a(),$("#addQuoteInput").val("")},2*TIMEOUT_WAIT_TIME))}function l(){sendDBDelete("quotes_quotemessage","settings","quoteMessage"),$("#quoteMessageInput").val(""),setTimeout(function(){a()},4*TIMEOUT_WAIT_TIME)}var e='<i  class="fa fa-spinner fa-spin" />',t=!1;$("#quotesPanel").load("/panel/quotes.html");var u=setInterval(function(){if(isConnected&&TABS_INITIALIZED){var e=$("#tabs").tabs("option","active");12==e&&(a(),clearInterval(u))}},INITIAL_WAIT_TIME);setInterval(function(){var e=$("#tabs").tabs("option","active");12==e&&isConnected&&!isInputFocus()&&(newPanelAlert("Refreshing Quotes Data","success",1e3),a())},3e4),$.quotesOnMessage=i,$.quotesDoQuery=a,$.deleteQuote=o,$.updateQuote=r,$.addQuote=s,$.setQuoteMessage=n,$.delQuoteMsg=l}();