(function(){function e(e){var o;try{o=JSON.parse(e.data)}catch(e){return}if(panelHasQuery(o)){var n="",t="",d='<table class="table table-hover table-striped">',s="",m=!1;if(panelCheckQuery(o,"commands_cooldown")){d='<table class="table table-hover table-striped">';for(l in o.results)n=o.results[l].key,s=JSON.parse(o.results[l].value).seconds,m=!0,d+="<tr >    <td>!"+n+'</td>    <td>        <form onkeypress="return event.keyCode != 13">            <input type="text" data-toggle="tooltip" title="Click to edit the cooldown." onclick="$.editCooldown(\''+n+"', '"+s+"', '"+JSON.parse(o.results[l].value).isGlobal+'\')"                       id="editCommandCooldown_'+n.replace(/[^a-zA-Z0-9_]/g,"_SP_")+'"                   value="'+s+" seconds. (Global: "+JSON.parse(o.results[l].value).isGlobal+')" disabled/>              <button type="button" class="btn btn-default btn-fill btn-xs" onclick="$.editCooldown(\''+n+'\')"><i class="fa fa-pencil" /> </button>               <button type="button" class="btn btn-danger btn-xs" id="deleteCooldown_'+n+'" onclick="$.deleteCooldown(\''+n+'\')"><i class="fa fa-trash" /> </button>             </form>        </form>    </td></tr>';d+="</table>",m||(d="<i>No entries in cooldown table.</i>"),$("#cooldownList").html(d)}if(panelCheckQuery(o,"commands_cooldownsettings")){for(l in o.results)n=o.results[l].key,s=o.results[l].value,panelMatch(n,"modCooldown")?y=o.results[l].value:panelMatch(n,"defaultCooldownTime")&&$("#defaultCooldownInput").val(o.results[l].value);$("#toggleModCooldown").html(h[y])}}if(panelCheckQuery(o,"commands_cooldownmsg")&&null!=o.results.coolDownMsgEnabled&&void 0!=o.results.coolDownMsgEnabled&&(A=o.results.coolDownMsgEnabled),panelCheckQuery(o,"commands_permcommsg")&&null!=o.results.permComMsgEnabled&&void 0!=o.results.permComMsgEnabled&&(P=o.results.permComMsgEnabled),$("#cooldownMsg").html(h[A]),$("#permcomMsg").html(h[P]),panelCheckQuery(o,"commands_commands")){if(0===o.results.length)return void $("#customCommandsList").html("<i>There are no custom commands defined.</i>");d='<table class="table table-hover table-striped">',k.splice(0);for(var l in o.results)n=o.results[l].key,commandNameSafe=n.replace(/\?/g,"__QM__"),t=o.results[l].value,k.push(n),t=t.replace(/"/g,"''"),d+="<tr >    <td>!"+n+'</td>    <td>       <form role="form" lpformnum="9" onkeypress="return event.keyCode != 13">       <div class="form-group form-group-table">       <div class="input-group">           <input type="text" class="form-control" id="editCommand_'+commandNameSafe.replace(/[^a-zA-Z0-9_]/g,"_SP_")+'"                   value="'+t+'" />           <span class="input-group-btn">           <button class="btn btn-default btn-fill btn-xs" type="button" onclick="$.editCustomCommand(\''+n+'\')"><i class="fa fa-pencil" /></button>           <button class="btn btn-danger btn-fill btn-xs" type="button" id="deleteCommand_'+commandNameSafe.replace(/[^a-zA-Z0-9_]/g,"_SP_")+'" onclick="$.deleteCommand(\''+n+'\')""><i class="fa fa-trash" /></button>           </span>           </div>           </div>           </form>   </td></tr>',d+="</table>",$("#customCommandsList").html(d),handleInputFocus()}if(panelCheckQuery(o,"commands_aliases")){if(0===o.results.length)return void $("#aliasCommandsList").html("<i>There are no aliased commands defined.</i>");for(l in o.results)n=o.results[l].key,t=o.results[l].value,d+="<tr >    <td>!"+t+"</td>    <td>!"+n+'</td>    <td>        <div id="deleteAlias_'+n.replace(/[^a-zA-Z0-9_]/g,"_SP_")+'" type="button" class="btn btn-danger btn-fill btn-xs"              onclick="$.deleteAlias(\''+n+'\')"><i class="fa fa-trash" />        </div>    </td></tr>';d+="</table>",$("#aliasCommandsList").html(d)}if(panelCheckQuery(o,"commands_pricecom")){if(0===o.results.length)return void $("#priceCommandsList").html("<i>There are no commands with prices defined.</i>");for(l in o.results)n=o.results[l].key,t=o.results[l].value,d+="<tr >    <td>!"+n+'</td>    <td>       <form role="form" lpformnum="9" onkeypress="return event.keyCode != 13">       <div class="form-group form-group-table">       <div class="input-group">              <input type="text" class="form-control" id="editCommandPrice_'+n.replace(/[^a-zA-Z0-9_]/g,"_SP_")+'"                   value="'+t+'" />              <span class="input-group-btn">              <button type="button" class="btn btn-default btn-fill btn-xs" onclick="$.updateCommandPrice(\''+n+'\')"><i class="fa fa-pencil" /> </button>               <button type="button" class="btn btn-danger btn-fill btn-xs" id="deleteCommandPrice_'+n.replace(/[^a-zA-Z0-9_]/g,"_SP_")+'" onclick="$.deleteCommandPrice(\''+n+'\')"><i class="fa fa-trash" /> </button>           </span>           </div>           </div>           </form>   </td></tr>';d+="</table>",$("#priceCommandsList").html(d),handleInputFocus()}if(panelCheckQuery(o,"commands_payment")){if(0===o.results.length)return void $("#payCommandsList").html("<i>There are no commands with payments defined.</i>");for(l in o.results)n=o.results[l].key,t=o.results[l].value,d+="<tr >    <td>!"+n+'</td>    <td>        <form onkeypress="return event.keyCode != 13">            <input  type="text" id="editCommandPay_'+n.replace(/[^a-zA-Z0-9_]/g,"_SP_")+'"                   value="'+t+'" />              <button type="button" class="btn btn-danger btn-fill btn-xs" onclick="$.updateCommandPay(\''+n+'\')"><i class="fa fa-pencil" /> </button>               <button type="button" class="btn btn-default btn-fill btn-xs" id="deleteCommandPay_'+n.replace(/[^a-zA-Z0-9_]/g,"_SP_")+'" onclick="$.deleteCommandPay(\''+n+'\')"><i class="fa fa-trash" /> </button>             </form>        </form>    </td></tr>';d+="</table>",$("#payCommandsList").html(d),handleInputFocus()}if(panelCheckQuery(o,"commands_disabled")){D=[];for(l in o.results)D[o.results[l].key]=!0;sendDBKeys("commands_permcom","permcom")}if(panelCheckQuery(o,"commands_permcom")){var i=o.results;i.sort(a),botCommandsNew=[];for(l in i)n=i[l].key,t=i[l].value,d+="<tr ><td><strong>"+n+"</strong></td>",d+=n.indexOf(" ")===-1?void 0!==D[n]?'<td><div id="commandEnabled_'+n+'"         data-toggle="tooltip" title="Enable Command" class="button" onclick="$.commandEnable(\''+n+"', 'enable');\">    <i  class=\"fa fa-toggle-off\" /></div></td>":'<td><div id="commandEnabled_'+n+'"         data-toggle="tooltip" title="Disable Command" class="button" onclick="$.commandEnable(\''+n+"', 'disable');\">    <i  class=\"fa fa-toggle-on\" /></div></td>":"<td />",d+='<td /><td><div id="commandsList_'+n+'"><strong><font >'+w[t]+'    </font></strong></div></td><td><div data-toggle="tooltip" title="Set Caster" class="button" onclick="$.commandPermission(\''+n+'\', 0);">    <i class="fa fa-television" /></div></td><td><div data-toggle="tooltip" title="Set Admin" class="button" onclick="$.commandPermission(\''+n+'\', 1);">    <i class="fa fa-cog" /></div></td><td><div data-toggle="tooltip" title="Set Mod" class="button" onclick="$.commandPermission(\''+n+'\', 2);">    <i class="fa fa-shield" /></div></td><td><div data-toggle="tooltip" title="Set Donator" class="button" onclick="$.commandPermission(\''+n+'\', 4);">    <i class="fa fa-dollar" /></div></td><td><div data-toggle="tooltip" title="Set Sub" class="button" onclick="$.commandPermission(\''+n+'\', 3);">    <i class="fa fa-credit-card" /></div></td><td><div data-toggle="tooltip" title="Set Regular" class="button" onclick="$.commandPermission(\''+n+'\', 6);">    <i class="fa fa-clock-o" /></div></td><td><div data-toggle="tooltip" title="Set Viewer" class="button" onclick="$.commandPermission(\''+n+'\', 7);">    <i class="fa fa-user" /></div></td></tr>';U=botCommandsNew.slice(),d+="</table>",$("#permCommandsList").html(d),$('[data-toggle="tooltip"]').tooltip()}}function o(){sendDBKeys("commands_commands","command"),sendDBKeys("commands_aliases","aliases"),sendDBKeys("commands_pricecom","pricecom"),sendDBKeys("commands_payment","paycom"),sendDBKeys("commands_cooldown","cooldown"),sendDBKeys("commands_cooldownsettings","cooldownSettings"),sendDBKeys("commands_disabled","disabledCommands"),sendDBQuery("commands_cooldownmsg","settings","coolDownMsgEnabled"),sendDBQuery("commands_permcommsg","settings","permComMsgEnabled")}function a(e,o){return panelStrcmp(e.key,o.key)}function n(e){$("#deleteCommand_"+e.replace(/[^a-zA-Z0-9_]/g,"_SP_")).html('<i  class="fa fa-spinner fa-spin " / > '),e=e.toLowerCase(),sendDBDelete("commands_delcom_"+e,"command",e),sendDBDelete("commands_delcompermcom_"+e,"permcom",e),sendDBDelete("commands_delcompricecom_"+e,"pricecom",e),sendDBDelete("commands_delcompermcom_"+e,"permcom",e),sendDBDelete("commands_delcomalias_"+e,"aliases",e),sendDBDelete("commands_delcomcooldown_"+e,"cooldown",e),sendWSEvent("commands","./commands/customCommands.js",null,["remove",e]),setTimeout(function(){o()},TIMEOUT_WAIT_TIME),setTimeout(function(){sendCommand("reloadcommand "+e)},TIMEOUT_WAIT_TIME)}function t(e){$("#deleteCommandPrice_"+replace(/[^a-zA-Z0-9_]/g,"_SP_")).html('<i  class="fa fa-spinner fa-spin " / > '),sendDBDelete("commands_delcomprice_"+e,"pricecom",e),setTimeout(function(){o()},TIMEOUT_WAIT_TIME),setTimeout(function(){sendCommand("reloadcommand")},TIMEOUT_WAIT_TIME)}function d(e){$("#deleteCommandPay_"+e.replace(/[^a-zA-Z0-9_]/g,"_SP_")).html('<i class="fa fa-spinner fa-spin fa-spin " />'),sendDBDelete("commands_delcompay_"+e,"paycom",e),setTimeout(function(){o()},TIMEOUT_WAIT_TIME),setTimeout(function(){sendCommand("reloadcommand")},TIMEOUT_WAIT_TIME)}function s(){var e=$("#addCommandCommand").val(),a=$("#addCommandText").val();return 0==e.length?($("#addCommandCommand").val("[ERROR] Please enter a value."),$("#addCommandText").val(""),void setTimeout(function(){$("#addCommandCommand").val("")},10*TIMEOUT_WAIT_TIME)):0==a.length?($("#addCommandText").val("[ERROR] Please enter a value."),$("#addCommandCommand").val(""),void setTimeout(function(){$("#addCommandText").val("")},10*TIMEOUT_WAIT_TIME)):e.match(/\s+/)?($("#addCommandCommand").val("[ERROR] Your command cannot contain a space."),$("#addCommandText").val(""),void setTimeout(function(){$("#addCommandCommand").val("")},10*TIMEOUT_WAIT_TIME)):U.indexOf(e)!==-1?($("#addCommandCommand").val("[ERROR] Command already exists."),$("#addCommandText").val(""),void setTimeout(function(){$("#addCommandCommand").val("")},10*TIMEOUT_WAIT_TIME)):(e=e.replace("!",""),$("#addCommandText").val("Command successfully added!"),sendDBUpdate("addCustomCommand","command",e.toLowerCase(),a),sendWSEvent("commands","./commands/customCommands.js",null,["add",e,a]),void setTimeout(function(){$("#addCommandText").val(""),$("#addCommandCommand").val(""),sendCommand("reloadcommand"),o()},TIMEOUT_WAIT_TIME))}function m(e){var a=$("#editCommand_"+e.replace(/\?/g,"__QM__").replace(/[^a-zA-Z0-9_]/g,"_SP_")).val();a=a.replace(/''/g,'"'),a.length>0&&(e=e.replace("!",""),sendDBUpdate("addCustomCommand","command",e.toLowerCase(),a),sendWSEvent("commands","./commands/customCommands.js",null,["edit",e.toLowerCase(),a]),setTimeout(function(){o()},TIMEOUT_WAIT_TIME),setTimeout(function(){sendCommand("reloadcommand")},TIMEOUT_WAIT_TIME))}function l(){var e=$("#aliasCommandInput").val(),a=$("#aliasCommandInputAlias").val();return 0==a.length?($("#aliasCommandInputAlias").val("[ERROR] Please enter a value."),void setTimeout(function(){$("#aliasCommandInputAlias").val("")},2*TIMEOUT_WAIT_TIME)):0==e.length?($("#aliasCommandInput").val("[ERROR] Please enter a value."),void setTimeout(function(){$("#aliasCommandInput").val("")},2*TIMEOUT_WAIT_TIME)):(a=a.replace("!",""),e=e.replace("!",""),sendDBUpdate("addCommandAlias","aliases",e.toLowerCase(),a.toLowerCase()),setTimeout(function(){$("#aliasCommandInput").val(""),$("#aliasCommandInputAlias").val(""),sendCommand("reloadcommand")},TIMEOUT_WAIT_TIME),void setTimeout(function(){o()},TIMEOUT_WAIT_TIME))}function i(e){$("#deleteAlias_"+e.replace(/[^a-zA-Z0-9_]/g,"_SP_")).html('<i  class="fa fa-spinner fa-spin " / > '),0!=e.length&&(e=e.replace("!",""),sendDBDelete("commands_delalias_"+e,"aliases",e)),setTimeout(function(){o()},TIMEOUT_WAIT_TIME),setTimeout(function(){sendCommand("reloadcommand "+e)},TIMEOUT_WAIT_TIME)}function c(e,a){$("#commandsList_"+e.replace(/[^a-zA-Z0-9_]/g,"_SP_")).html('<i  class="fa fa-spinner fa-spin " / > '),0!=e.length&&0!=a.length&&(e=e.replace("!",""),sendCommand("permcomsilent "+e.toLowerCase()+" "+String(a))),setTimeout(function(){o()},TIMEOUT_WAIT_TIME),setTimeout(function(){sendCommand("reloadcommand")},TIMEOUT_WAIT_TIME)}function r(){var e=$("#setCommandPriceInput").val(),a=$("#setCommandPriceInputCommand").val();a.startsWith("!")&&(a=a.replace("!","")),0!=e.length&&0!=a.length&&(sendDBUpdate("commandPrice","pricecom",a.toLowerCase(),e),$("#setCommandPriceInput").val(""),$("#setCommandPriceInputCommand").val(""),setTimeout(function(){o()},TIMEOUT_WAIT_TIME))}function u(){var e=$("#setCommandPayInput").val(),a=$("#setCommandPayInputCommand").val();a.startsWith("!")&&(a=a.replace("!","")),0!=e&&0!=a.length&&(sendDBUpdate("commandPay","paycom",a.toLowerCase(),e),$("#setCommandPayInput").val(""),$("#setCommandPayInputCommand").val(""),setTimeout(function(){o()},TIMEOUT_WAIT_TIME))}function p(e){var a=$("#editCommandPrice_"+e.replace(/[^a-zA-Z0-9_]/g,"_SP_")).val();$("#editCommandPrice_"+e.replace(/[^a-zA-Z0-9_]/g,"_SP_")).html('<i  class="fa fa-spinner fa-spin " / > '),a>0&&(sendDBUpdate("commands_editprice_"+e,"pricecom",e.toLowerCase(),a),setTimeout(function(){o()},TIMEOUT_WAIT_TIME),setTimeout(function(){sendCommand("reloadcommand")},TIMEOUT_WAIT_TIME))}function f(e){var a=$("#editCommandPay_"+e.replace(/[^a-zA-Z0-9_]/g,"_SP_")).val();$("#editCommandPay_"+e.replace(/[^a-zA-Z0-9_]/g,"_SP_")).html('<i  class="fa fa-spinner fa-spin " / > '),a.length>0&&(sendDBUpdate("commands_editpay_"+e,"paycom",e.toLowerCase(),a),setTimeout(function(){o()},TIMEOUT_WAIT_TIME),setTimeout(function(){sendCommand("reloadcommand")},TIMEOUT_WAIT_TIME))}function _(){$("#cooldownMsg").html('<i  class="fa fa-spinner fa-spin " / > '),"true"==A?sendDBUpdate("commands_cooldownmsg","settings","coolDownMsgEnabled","false"):"false"==A&&sendDBUpdate("commands_cooldownmsg","settings","coolDownMsgEnabled","true"),sendCommand("reloadinit"),setTimeout(function(){o()},2*TIMEOUT_WAIT_TIME)}function C(){$("#permcomMsg").html('<i  class="fa fa-spinner fa-spin " / > '),"true"==P?sendDBUpdate("commands_permcommsg","settings","permComMsgEnabled","false"):"false"==P&&sendDBUpdate("commands_permcommsg","settings","permComMsgEnabled","true"),sendCommand("reloadinit"),setTimeout(function(){o()},2*TIMEOUT_WAIT_TIME)}function T(){$("#toggleModCooldown").html('<i  class="fa fa-spinner fa-spin " / > '),"true"==y?sendDBUpdate("commands_cooldown_toggle","cooldownSettings","modCooldown","false"):"false"==y&&sendDBUpdate("commands_cooldown_toggle","cooldownSettings","modCooldown","true"),setTimeout(function(){o()},2*TIMEOUT_WAIT_TIME),setTimeout(function(){sendCommand("reloadcooldown")},2*TIMEOUT_WAIT_TIME)}function g(){var e=$("#defaultCooldownInput").val();e.length>0&&(sendDBUpdate("commands_cooldown_time","cooldownSettings","defaultCooldownTime",String(e)),setTimeout(function(){o()},2*TIMEOUT_WAIT_TIME))}function v(e){$("#deleteCooldown_"+e.replace(/[^a-zA-Z0-9_]/g,"_SP_")).html('<i  class="fa fa-spinner fa-spin " / > '),sendDBDelete("commands_cooldown_delete","cooldown",e),sendWSEvent("cooldown","./core/commandCoolDown.js",null,["remove",e]),setTimeout(function(){o()},TIMEOUT_WAIT_TIME)}function I(){var e=$("#cooldownCmdInput").val(),a=$("#cooldownCmdInputCommand").val(),n=$("#globalCooldownCheck").is(":checked");return a.startsWith("!")&&(a=a.replace("!","")),a.match(/\s/)?($("#cooldownCmdInputCommand").val("Cooldowns cannot have a space, please set the cooldown on the default command."),void setTimeout(function(){$("#cooldownCmdInputCommand").val(""),$("#cooldownCmdInput").val(""),$("#globalCooldownCheck").prop("checked",!0)},3*TIMEOUT_WAIT_TIME)):void(e.length>0&&0!=a.length&&(sendDBUpdate("commands_cooldown_add","cooldown",String(a),JSON.stringify({command:String(a.toLowerCase()),seconds:String(e),isGlobal:String(n)})),setTimeout(function(){o(),sendWSEvent("cooldown","./core/commandCoolDown.js",null,["add",a.toLowerCase(),e,n])},TIMEOUT_WAIT_TIME),setTimeout(function(){$("#cooldownCmdInputCommand").val(""),$("#cooldownCmdInput").val(""),$("#globalCooldownCheck").prop("checked",!0)},5)))}function b(e,o,a){$("#cooldownCmdInput").val(o),$("#cooldownCmdInputCommand").val(e),$("#cooldownCmdInputCommand").focus(),$("#globalCooldownCheck").prop("checked","true"==a)}function E(e,a){panelMatch(a,"enable")?($("#commandEnabled_"+e).html('<i class="fa fa-toggle-on" />'),sendDBDelete("commands_enablecom","disabledCommands",e),sendCommand("registerpanel "+e)):($("#commandEnabled_"+e).html('<i class="fa fa-toggle-off" />'),sendDBUpdate("commands_enablecom","disabledCommands",e,"true"),sendCommand("unregisterpanel "+e)),setTimeout(function(){o()},TIMEOUT_WAIT_TIME)}function M(){var e=$("#commandImput").val();return 0==e.length?void $("#commandImput").val(""):(sendCommand(e.replace("!","")),$("#commandImput").val("command sent!"),void setTimeout(function(){$("#commandImput").val("")},TIMEOUT_WAIT_TIME))}var h=[],w=[],y="",A="false",P="true",D=[],k=[],U=[];h.false='<i  class="fa fa-circle text-warning" />',h.true='<i  class="fa fa-circle text-success" />',w[0]='<i class="fa fa-television" />',w[1]='<i class="fa fa-cog" />',w[2]='<i class="fa fa-shield" />',w[4]='<i class="fa fa-dollar" />',w[3]='<i class="fa fa-credit-card" />',w[6]='<i class="fa fa-clock-o" />',w[7]='<i class="fa fa-user" /></div>',$("#commandsPanel").load("/panel/commands.html");var S=setInterval(function(){if(isConnected&&TABS_INITIALIZED){var e=$("#tabs").tabs("option","active");1==e&&(o(),clearInterval(S))}},INITIAL_WAIT_TIME);setInterval(function(){var e=$("#tabs").tabs("option","active");1==e&&isConnected&&!isInputFocus()&&(newPanelAlert("Refreshing Commands Data","success",1e3),o())},3e4),$.commandsOnMessage=e,$.commandsDoQuery=o,$.deleteCommand=n,$.addCustomCommand=s,$.editCustomCommand=m,$.aliasCommand=l,$.deleteAlias=i,$.commandPermission=c,$.setCommandPrice=r,$.setCommandPay=u,$.updateCommandPrice=p,$.updateCommandPay=f,$.addCooldown=I,$.deleteCooldown=v,$.toggleModCooldown=T,$.setDefaultCooldown=g,$.commandEnable=E,$.deleteCommandPrice=t,$.deleteCommandPay=d,$.commands=k,$.runCustomCommand=M,$.toggleCooldownMsg=_,$.togglePermcomMsg=C,$.editCooldown=b})();