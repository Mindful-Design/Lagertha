!function(){function h(i){var n;try{n=JSON.parse(i.data)}catch(r){return}if(panelHasQuery(n)){var h="",c="",d='<table class="table table-hover table-striped">',p="",m=!1;if(panelCheckQuery(n,"commands_cooldown")){d='<table class="table table-hover table-striped">';for(g in n.results)h=n.results[g].key,p=JSON.parse(n.results[g].value).seconds,m=!0,d+="<tr >    <td>!"+h+'</td>    <td>        <form onkeypress="return event.keyCode != 13">            <input type="text" data-toggle="tooltip" title="Click to edit the cooldown." onclick="$.editCooldown(\''+h+"', '"+p+"', '"+JSON.parse(n.results[g].value).isGlobal+'\')"                       id="editCommandCooldown_'+h.replace(/[^a-zA-Z0-9_]/g,"_SP_")+'"                   value="'+p+" seconds. (Global: "+JSON.parse(n.results[g].value).isGlobal+')" disabled/>              <button type="button" class="btn btn-default btn-fill btn-xs" onclick="$.editCooldown(\''+h+'\')"><i class="fa fa-pencil" /> </button>               <button type="button" class="btn btn-danger btn-xs" id="deleteCooldown_'+h+'" onclick="$.deleteCooldown(\''+h+'\')"><i class="fa fa-trash" /> </button>             </form>        </form>    </td></tr>';d+="</table>",m||(d="<i>No entries in cooldown table.</i>"),$("#cooldownList").html(d)}if(panelCheckQuery(n,"commands_cooldownsettings")){for(g in n.results)h=n.results[g].key,p=n.results[g].value,panelMatch(h,"modCooldown")?s=n.results[g].value:panelMatch(h,"defaultCooldownTime")&&$("#defaultCooldownInput").val(n.results[g].value);$("#toggleModCooldown").html(e[s])}}if(panelCheckQuery(n,"commands_cooldownmsg")&&null!=n.results.coolDownMsgEnabled&&void 0!=n.results.coolDownMsgEnabled&&(a=n.results.coolDownMsgEnabled),panelCheckQuery(n,"commands_permcommsg")&&null!=n.results.permComMsgEnabled&&void 0!=n.results.permComMsgEnabled&&(o=n.results.permComMsgEnabled),$("#cooldownMsg").html(e[a]),$("#permcomMsg").html(e[o]),panelCheckQuery(n,"commands_commands")){if(0===n.results.length)return void $("#customCommandsList").html("<i>There are no custom commands defined.</i>");d='<table class="table table-hover table-striped">',u.splice(0);for(var g in n.results)h=n.results[g].key,commandNameSafe=h.replace(/\?/g,"__QM__"),c=n.results[g].value,u.push(h),c=c.replace(/"/g,"''"),d+="<tr >    <td>!"+h+'</td>    <td>       <form role="form" lpformnum="9" onkeypress="return event.keyCode != 13">       <div class="form-group form-group-table">       <div class="input-group">           <input type="text" class="form-control" id="editCommand_'+commandNameSafe.replace(/[^a-zA-Z0-9_]/g,"_SP_")+'"                   value="'+c+'" />           <span class="input-group-btn">           <button class="btn btn-default btn-fill btn-xs" type="button" onclick="$.editCustomCommand(\''+h+'\')"><i class="fa fa-pencil" /></button>           <button class="btn btn-danger btn-fill btn-xs" type="button" id="deleteCommand_'+commandNameSafe.replace(/[^a-zA-Z0-9_]/g,"_SP_")+'" onclick="$.deleteCommand(\''+h+'\')""><i class="fa fa-trash" /></button>           </span>           </div>           </div>           </form>   </td></tr>';d+="</table>",$("#customCommandsList").html(d),handleInputFocus()}if(panelCheckQuery(n,"commands_aliases")){if(0===n.results.length)return void $("#aliasCommandsList").html("<i>There are no aliased commands defined.</i>");for(g in n.results)h=n.results[g].key,c=n.results[g].value,d+="<tr >    <td>!"+c+"</td>    <td>!"+h+'</td>    <td>        <div id="deleteAlias_'+h.replace(/[^a-zA-Z0-9_]/g,"_SP_")+'" type="button" class="btn btn-danger btn-fill btn-xs"              onclick="$.deleteAlias(\''+h+'\')"><i class="fa fa-trash" />        </div>    </td></tr>';d+="</table>",$("#aliasCommandsList").html(d)}if(panelCheckQuery(n,"commands_pricecom")){if(0===n.results.length)return void $("#priceCommandsList").html("<i>There are no commands with prices defined.</i>");for(g in n.results)h=n.results[g].key,c=n.results[g].value,d+="<tr >    <td>!"+h+'</td>    <td>       <form role="form" lpformnum="9" onkeypress="return event.keyCode != 13">       <div class="form-group form-group-table">       <div class="input-group">              <input type="text" class="form-control" id="editCommandPrice_'+h.replace(/[^a-zA-Z0-9_]/g,"_SP_")+'"                   value="'+c+'" />              <span class="input-group-btn">              <button type="button" class="btn btn-default btn-fill btn-xs" onclick="$.updateCommandPrice(\''+h+'\')"><i class="fa fa-pencil" /> </button>               <button type="button" class="btn btn-danger btn-fill btn-xs" id="deleteCommandPrice_'+h.replace(/[^a-zA-Z0-9_]/g,"_SP_")+'" onclick="$.deleteCommandPrice(\''+h+'\')"><i class="fa fa-trash" /> </button>           </span>           </div>           </div>           </form>   </td></tr>';d+="</table>",$("#priceCommandsList").html(d),handleInputFocus()}if(panelCheckQuery(n,"commands_payment")){if(0===n.results.length)return void $("#payCommandsList").html("<i>There are no commands with payments defined.</i>");for(g in n.results)h=n.results[g].key,c=n.results[g].value,d+="<tr >    <td>!"+h+'</td>    <td>        <form onkeypress="return event.keyCode != 13">            <input  type="text" id="editCommandPay_'+h.replace(/[^a-zA-Z0-9_]/g,"_SP_")+'"                   value="'+c+'" />              <button type="button" class="btn btn-danger btn-fill btn-xs" onclick="$.updateCommandPay(\''+h+'\')"><i class="fa fa-pencil" /> </button>               <button type="button" class="btn btn-default btn-fill btn-xs" id="deleteCommandPay_'+h.replace(/[^a-zA-Z0-9_]/g,"_SP_")+'" onclick="$.deleteCommandPay(\''+h+'\')"><i class="fa fa-trash" /> </button>             </form>        </form>    </td></tr>';d+="</table>",$("#payCommandsList").html(d),handleInputFocus()}if(panelCheckQuery(n,"commands_disabled")){l=[];for(g in n.results)l[n.results[g].key]=!0;sendDBKeys("commands_permcom","permcom")}if(panelCheckQuery(n,"commands_permcom")){var v=n.results;v.sort(f);for(g in v)h=v[g].key,c=v[g].value,d+="<tr ><td><strong>"+h+"</strong></td>",d+=-1===h.indexOf(" ")?void 0!==l[h]?'<td><div id="commandEnabled_'+h+'"         data-toggle="tooltip" title="Enable Command" class="button" onclick="$.commandEnable(\''+h+"', 'enable');\">    <i  class=\"fa fa-toggle-off\" /></div></td>":'<td><div id="commandEnabled_'+h+'"         data-toggle="tooltip" title="Disable Command" class="button" onclick="$.commandEnable(\''+h+"', 'disable');\">    <i  class=\"fa fa-toggle-on\" /></div></td>":"<td />",d+='<td /><td><div id="commandsList_'+h+'"><strong><font >'+t[c]+'    </font></strong></div></td><td><div data-toggle="tooltip" title="Set Caster" class="button" onclick="$.commandPermission(\''+h+'\', 0);">    <i class="fa fa-television" /></div></td><td><div data-toggle="tooltip" title="Set Admin" class="button" onclick="$.commandPermission(\''+h+'\', 1);">    <i class="fa fa-cog" /></div></td><td><div data-toggle="tooltip" title="Set Mod" class="button" onclick="$.commandPermission(\''+h+'\', 2);">    <i class="fa fa-shield" /></div></td><td><div data-toggle="tooltip" title="Set Donator" class="button" onclick="$.commandPermission(\''+h+'\', 4);">    <i class="fa fa-dollar" /></div></td><td><div data-toggle="tooltip" title="Set Sub" class="button" onclick="$.commandPermission(\''+h+'\', 3);">    <i class="fa fa-credit-card" /></div></td><td><div data-toggle="tooltip" title="Set Regular" class="button" onclick="$.commandPermission(\''+h+'\', 6);">    <i class="fa fa-clock-o" /></div></td><td><div data-toggle="tooltip" title="Set Viewer" class="button" onclick="$.commandPermission(\''+h+'\', 7);">    <i class="fa fa-user" /></div></td></tr>';d+="</table>",$("#permCommandsList").html(d),$('[data-toggle="tooltip"]').tooltip()}}function c(){sendDBKeys("commands_commands","command"),sendDBKeys("commands_aliases","aliases"),sendDBKeys("commands_pricecom","pricecom"),sendDBKeys("commands_payment","paycom"),sendDBKeys("commands_cooldown","cooldown"),sendDBKeys("commands_cooldownsettings","cooldownSettings"),sendDBKeys("commands_disabled","disabledCommands"),sendDBQuery("commands_cooldownmsg","settings","coolDownMsgEnabled"),sendDBQuery("commands_permcommsg","settings","permComMsgEnabled")}function f(e,t){return panelStrcmp(e.key,t.key)}function d(e){$("#deleteCommand_"+e.replace(/[^a-zA-Z0-9_]/g,"_SP_")).html('<i  class="fa fa-spinner fa-spin " / > '),e=e.toLowerCase(),sendDBDelete("commands_delcom_"+e,"command",e),sendDBDelete("commands_delcompermcom_"+e,"permcom",e),sendDBDelete("commands_delcompricecom_"+e,"pricecom",e),sendDBDelete("commands_delcompermcom_"+e,"permcom",e),sendDBDelete("commands_delcomalias_"+e,"aliases",e),sendDBDelete("commands_delcomcooldown_"+e,"cooldown",e),setTimeout(function(){c()},TIMEOUT_WAIT_TIME),setTimeout(function(){sendCommand("reloadcommand "+e)},TIMEOUT_WAIT_TIME)}function p(e){$("#deleteCommandPrice_"+replace(/[^a-zA-Z0-9_]/g,"_SP_")).html('<i  class="fa fa-spinner fa-spin " / > '),sendDBDelete("commands_delcomprice_"+e,"pricecom",e),setTimeout(function(){c()},TIMEOUT_WAIT_TIME),setTimeout(function(){sendCommand("reloadcommand")},TIMEOUT_WAIT_TIME)}function m(e){$("#deleteCommandPay_"+e.replace(/[^a-zA-Z0-9_]/g,"_SP_")).html('<i class="fa fa-spinner fa-spin fa-spin " />'),sendDBDelete("commands_delcompay_"+e,"paycom",e),setTimeout(function(){c()},TIMEOUT_WAIT_TIME),setTimeout(function(){sendCommand("reloadcommand")},TIMEOUT_WAIT_TIME)}function g(){var e=$("#addCommandCommand").val(),t=$("#addCommandText").val();return 0==e.length?($("#addCommandCommand").val("[ERROR] Please enter a value."),$("#addCommandText").val(""),void setTimeout(function(){$("#addCommandCommand").val("")},10*TIMEOUT_WAIT_TIME)):0==t.length?($("#addCommandText").val("[ERROR] Please enter a value."),$("#addCommandCommand").val(""),void setTimeout(function(){$("#addCommandText").val("")},10*TIMEOUT_WAIT_TIME)):e.match(/ /)?($("#addCommandCommand").val("[ERROR] Your command cannot contain a space."),$("#addCommandText").val(""),void setTimeout(function(){$("#addCommandCommand").val("")},10*TIMEOUT_WAIT_TIME)):(e.startsWith("!")&&(e=e.replace("!","")),$("#addCommandText").val("Command successfully added!"),sendDBUpdate("addCustomCommand","command",e.toLowerCase(),t),void setTimeout(function(){$("#addCommandText").val(""),$("#addCommandCommand").val(""),sendCommand("reloadcommand"),c()},TIMEOUT_WAIT_TIME))}function v(e){var t=$("#editCommand_"+e.replace(/\?/g,"__QM__").replace(/[^a-zA-Z0-9_]/g,"_SP_")).val();t=t.replace(/''/g,'"'),t.length>0&&(e=e.replace("!",""),sendDBUpdate("addCustomCommand","command",e.toLowerCase(),t),setTimeout(function(){c()},TIMEOUT_WAIT_TIME),setTimeout(function(){sendCommand("reloadcommand")},TIMEOUT_WAIT_TIME))}function b(){var e=$("#aliasCommandInput").val(),t=$("#aliasCommandInputAlias").val();return 0==t.length?($("#aliasCommandInputAlias").val("[ERROR] Please enter a value."),void setTimeout(function(){$("#aliasCommandInputAlias").val("")},2*TIMEOUT_WAIT_TIME)):0==e.length?($("#aliasCommandInput").val("[ERROR] Please enter a value."),void setTimeout(function(){$("#aliasCommandInput").val("")},2*TIMEOUT_WAIT_TIME)):(e.startsWith("!")?e=e.replace("!",""):t.startsWith("!")&&(t=t.replace("!","")),t=t.replace("!",""),e=e.replace("!",""),sendDBUpdate("addCommandAlias","aliases",e.toLowerCase(),t.toLowerCase()),setTimeout(function(){$("#aliasCommandInput").val(""),$("#aliasCommandInputAlias").val(""),sendCommand("reloadcommand")},TIMEOUT_WAIT_TIME),void setTimeout(function(){c()},TIMEOUT_WAIT_TIME))}function _(e){$("#deleteAlias_"+e.replace(/[^a-zA-Z0-9_]/g,"_SP_")).html('<i  class="fa fa-spinner fa-spin " / > '),0!=e.length&&(e=e.replace("!",""),sendDBDelete("commands_delalias_"+e,"aliases",e)),setTimeout(function(){c()},TIMEOUT_WAIT_TIME),setTimeout(function(){sendCommand("reloadcommand "+e)},TIMEOUT_WAIT_TIME)}function y(e,t){$("#commandsList_"+e.replace(/[^a-zA-Z0-9_]/g,"_SP_")).html('<i  class="fa fa-spinner fa-spin " / > '),0!=e.length&&0!=t.length&&(e=e.replace("!",""),sendCommand("permcomsilent "+e.toLowerCase()+" "+String(t))),setTimeout(function(){c()},TIMEOUT_WAIT_TIME),setTimeout(function(){sendCommand("reloadcommand")},TIMEOUT_WAIT_TIME)}function w(){var e=$("#setCommandPriceInput").val(),t=$("#setCommandPriceInputCommand").val();t.startsWith("!")&&(t=t.replace("!","")),0!=e.length&&0!=t.length&&(sendDBUpdate("commandPrice","pricecom",t.toLowerCase(),e),$("#setCommandPriceInput").val(""),$("#setCommandPriceInputCommand").val(""),setTimeout(function(){c()},TIMEOUT_WAIT_TIME))}function x(){var e=$("#setCommandPayInput").val(),t=$("#setCommandPayInputCommand").val();t.startsWith("!")&&(t=t.replace("!","")),0!=e&&0!=t.length&&(sendDBUpdate("commandPay","paycom",t.toLowerCase(),e),$("#setCommandPayInput").val(""),$("#setCommandPayInputCommand").val(""),setTimeout(function(){c()},TIMEOUT_WAIT_TIME))}function C(e){var t=$("#editCommandPrice_"+e.replace(/[^a-zA-Z0-9_]/g,"_SP_")).val();$("#editCommandPrice_"+e.replace(/[^a-zA-Z0-9_]/g,"_SP_")).html('<i  class="fa fa-spinner fa-spin " / > '),t>0&&(sendDBUpdate("commands_editprice_"+e,"pricecom",e.toLowerCase(),t),setTimeout(function(){c()},TIMEOUT_WAIT_TIME),setTimeout(function(){sendCommand("reloadcommand")},TIMEOUT_WAIT_TIME))}function k(e){var t=$("#editCommandPay_"+e.replace(/[^a-zA-Z0-9_]/g,"_SP_")).val();$("#editCommandPay_"+e.replace(/[^a-zA-Z0-9_]/g,"_SP_")).html('<i  class="fa fa-spinner fa-spin " / > '),t.length>0&&(sendDBUpdate("commands_editpay_"+e,"paycom",e.toLowerCase(),t),setTimeout(function(){c()},TIMEOUT_WAIT_TIME),setTimeout(function(){sendCommand("reloadcommand")},TIMEOUT_WAIT_TIME))}function D(){$("#cooldownMsg").html('<i  class="fa fa-spinner fa-spin " / > '),"true"==a?sendDBUpdate("commands_cooldownmsg","settings","coolDownMsgEnabled","false"):"false"==a&&sendDBUpdate("commands_cooldownmsg","settings","coolDownMsgEnabled","true"),sendCommand("reloadinit"),setTimeout(function(){c()},2*TIMEOUT_WAIT_TIME)}function T(){$("#permcomMsg").html('<i  class="fa fa-spinner fa-spin " / > '),"true"==o?sendDBUpdate("commands_permcommsg","settings","permComMsgEnabled","false"):"false"==o&&sendDBUpdate("commands_permcommsg","settings","permComMsgEnabled","true"),sendCommand("reloadinit"),setTimeout(function(){c()},2*TIMEOUT_WAIT_TIME)}function I(){$("#toggleModCooldown").html('<i  class="fa fa-spinner fa-spin " / > '),"true"==s?sendDBUpdate("commands_cooldown_toggle","cooldownSettings","modCooldown","false"):"false"==s&&sendDBUpdate("commands_cooldown_toggle","cooldownSettings","modCooldown","true"),setTimeout(function(){c()},2*TIMEOUT_WAIT_TIME),setTimeout(function(){sendCommand("reloadcooldown")},2*TIMEOUT_WAIT_TIME)}function M(){var e=$("#defaultCooldownInput").val();e.length>0&&(sendDBUpdate("commands_cooldown_time","cooldownSettings","defaultCooldownTime",String(e)),setTimeout(function(){c()},2*TIMEOUT_WAIT_TIME))}function S(e){$("#deleteCooldown_"+e.replace(/[^a-zA-Z0-9_]/g,"_SP_")).html('<i  class="fa fa-spinner fa-spin " / > '),sendDBDelete("commands_cooldown_delete","cooldown",e),sendWSEvent("cooldown","./core/commandCoolDown.js",null,["remove",e]),setTimeout(function(){c()},TIMEOUT_WAIT_TIME)}function E(){var e=$("#cooldownCmdInput").val(),t=$("#cooldownCmdInputCommand").val(),i=$("#globalCooldownCheck").is(":checked");t.startsWith("!")&&(t=t.replace("!","")),e.length>0&&0!=t.length&&(sendDBUpdate("commands_cooldown_add","cooldown",String(t),JSON.stringify({command:String(t.toLowerCase()),seconds:String(e),isGlobal:String(i)})),setTimeout(function(){c(),sendWSEvent("cooldown","./core/commandCoolDown.js",null,["add",t.toLowerCase(),e,i])},TIMEOUT_WAIT_TIME),setTimeout(function(){$("#cooldownCmdInputCommand").val(""),$("#cooldownCmdInput").val(""),$("#globalCooldownCheck").prop("checked",!0)},5))}function P(e,t){panelMatch(t,"enable")?($("#commandEnabled_"+e).html('<i class="fa fa-toggle-on" />'),sendDBDelete("commands_enablecom","disabledCommands",e),sendCommand("registerpanel "+e)):($("#commandEnabled_"+e).html('<i class="fa fa-toggle-off" />'),sendDBUpdate("commands_enablecom","disabledCommands",e,"true"),sendCommand("unregisterpanel "+e)),setTimeout(function(){c()},TIMEOUT_WAIT_TIME)}function N(){var e=$("#commandImput").val();return 0==e.length?void $("#commandImput").val(""):(sendCommand(e.replace("!","")),$("#commandImput").val("command sent!"),void setTimeout(function(){$("#commandImput").val("")},TIMEOUT_WAIT_TIME))}var e=[],t=[],s="",a="false",o="true",l=[],u=[];e["false"]='<i  class="fa fa-circle text-warning" />',e["true"]='<i  class="fa fa-circle text-success" />',t[0]='<i class="fa fa-television" />',t[1]='<i class="fa fa-cog" />',t[2]='<i class="fa fa-shield" />',t[4]='<i class="fa fa-dollar" />',t[3]='<i class="fa fa-credit-card" />',t[6]='<i class="fa fa-clock-o" />',t[7]='<i class="fa fa-user" /></div>',$("#commandsPanel").load("/panel/commands.html");var A=setInterval(function(){if(isConnected&&TABS_INITIALIZED){var e=$("#tabs").tabs("option","active");1==e&&(c(),clearInterval(A))}},INITIAL_WAIT_TIME);setInterval(function(){var e=$("#tabs").tabs("option","active");1==e&&isConnected&&!isInputFocus()&&(newPanelAlert("Refreshing Commands Data","success",1e3),c())},3e4),$.commandsOnMessage=h,$.commandsDoQuery=c,$.deleteCommand=d,$.addCustomCommand=g,$.editCustomCommand=v,$.aliasCommand=b,$.deleteAlias=_,$.commandPermission=y,$.setCommandPrice=w,$.setCommandPay=x,$.updateCommandPrice=C,$.updateCommandPay=k,$.addCooldown=E,$.deleteCooldown=S,$.toggleModCooldown=I,$.setDefaultCooldown=M,$.commandEnable=P,$.deleteCommandPrice=p,$.deleteCommandPay=m,$.commands=u,$.runCustomCommand=N,$.toggleCooldownMsg=D,$.togglePermcomMsg=T}();