!function(){function r(a){var n,o="";try{n=JSON.parse(a.data)}catch(s){return}if(panelHasQuery(n)&&(panelCheckQuery(n,"audio_ytpMaxReqs")&&$("#ytpMaxReqsInput").attr("placeholder",n.results.songRequestsMaxParallel),panelCheckQuery(n,"audio_ytpMaxLength")&&$("#ytpMaxLengthInput").attr("placeholder",n.results.songRequestsMaxSecondsforVideo),panelCheckQuery(n,"audio_ytpDJName")&&$("#ytpDJNameInput").attr("placeholder",n.results.playlistDJname),panelCheckQuery(n,"audio_panel_hook")&&logMsg("Will Play: "+n.audio_panel_hook)),panelCheckQuery(n,"audio_ytplaylists")){if(0===n.results.length)return;t=[];for(var l in n.results)t.push(n.results[l].value);$.playlists=t}if(void 0!==n.audio_panel_hook&&m(n.audio_panel_hook),panelCheckQuery(n,"audio_songblacklist")){if(0===n.results.length)return void $("#ytplayerBSong").html("<i>There are no blacklisted songs.</i>");var o='<table class="table table-hover table-striped">';for(var l in n.results){var u=n.results[l].key;o+="<tr >    <td>"+u+'</td>    <td>        <button type="button" class="btn btn-info btn-fill btn-xs" id="deleteBSong_'+u+'" onclick="$.deleteBSong(\''+u+'\')"><i class="fa fa-trash" /> </button>    </td></tr>'}o+="</table>",$("#ytplayerBSong").html(o),handleInputFocus()}if(panelCheckQuery(n,"audio_hook")){i=[];for(var l in n.results)i.push({name:n.results[l].key,desc:n.results[l].value});0===i.length?($("#audioPanelButtons").html("No sounds configured, please click Reload Audio Hooks if sounds are installed."),$("#ionSoundLoaded").html('<span style="float: right" class="label label-success label-md">Ready</span>')):setTimeout(function(){$(document).ready(function(){ion.sound({sounds:i,path:"/panel/js/ion-sound/sounds/",preload:!0,volume:1,ready_callback:p,ended_callback:g})})},2e3)}if(panelCheckQuery(n,"audio_hook_reload")){i=[];for(var l in n.results)i.push({name:n.results[l].key,desc:n.results[l].value});0===i.length?($("#audioPanelButtons").html("No sounds configured, please click Reload Audio Hooks if sounds are installed."),$("#ionSoundLoaded").html('<span style="float: right" class="label label-success label-md">Ready</span>')):ion.sound({sounds:i,path:"/panel/js/ion-sound/sounds/",preload:!0,volume:1,ready_callback:p,ended_callback:g}),f(),$("#reloadSounds").html("Reload Audio Hooks")}if(panelCheckQuery(n,"audio_ytptoggle1")&&("true"==n.results.announceInChat&&(e="true"),"false"==n.results.announceInChat&&(e="false")),panelCheckQuery(n,"audio_userblacklist")){if(0===n.results.length)return void $("#ytplayerBUser").html("<i>There are no blacklisted users.</i>");o="<table>";for(var l in n.results){var u=n.results[l].key;o+="<tr >    <td>"+u+'</td>    <td>        <button type="button" class="btn btn-info btn-fill btn-xs" id="deleteUser_'+u+'" onclick="$.deleteUser(\''+u+'\')"><i class="fa fa-trash" /> </button>    </td></tr>'}o+="</table>",$("#ytplayerBUser").html(o),handleInputFocus()}}function s(e){sendDBKeys("audio_ytplaylists","ytPanelPlaylist"),sendDBQuery("audio_ytpMaxReqs","ytSettings","songRequestsMaxParallel"),sendDBQuery("audio_ytpMaxLength","ytSettings","songRequestsMaxSecondsforVideo"),sendDBQuery("audio_ytptoggle1","ytSettings","announceInChat"),sendDBQuery("audio_ytpDJName","ytSettings","playlistDJname"),sendDBKeys("audio_songblacklist","ytpBlacklistedSong"),sendDBKeys("audio_userblacklist","ytpBlacklist"),sendDBKeys("audio_hook","audio_hooks")}function l(){$("#reloadSounds").html("Please wait..."),sendCommand("reloadaudiopanelhooks")}function u(e){$("#deleteBSong_"+e).html('<i  class="fa fa-spinner fa-spin" />'),sendDBDelete("audio_bsong_"+e,"ytpBlacklistedSong",e),setTimeout(function(){s()},TIMEOUT_WAIT_TIME)}function h(){var e=$("#songBlacklist").val();0!=e.length&&(sendDBUpdate("audio_song_"+e,"ytpBlacklistedSong",e.toLowerCase(),"true"),setTimeout(function(){s()},TIMEOUT_WAIT_TIME)),setTimeout(function(){$("#songBlacklist").val("")},TIMEOUT_WAIT_TIME)}function c(e){$("#deleteBUser_"+e).html('<i  class="fa fa-spinner fa-spin" />'),sendDBDelete("audio_user_"+e,"ytpBlacklist",e),setTimeout(function(){s()},TIMEOUT_WAIT_TIME)}function d(){var e=$("#userBlacklist").val();0!=e.length&&(sendDBUpdate("audio_user_"+e,"ytpBlacklist",e.toLowerCase(),"true"),setTimeout(function(){s()},TIMEOUT_WAIT_TIME)),setTimeout(function(){$("#userBlacklist").val("")},TIMEOUT_WAIT_TIME)}function f(){$("#audioPanelButtons").html("");for(var e in i)$("#audioPanelButtons").append('<button type="button" class="soundButton btn btn-info btn-fill"onclick="$.playIonSound(\''+i[e].name+"');\">"+i[e].desc+"</button>")}function p(){$("#ionSoundLoaded").html('<span style="float: right" class="label label-success label-md">Ready</span>'),f()}function m(e){o?a.push(e):(o=!0,$("#ionSoundPlaying").fadeIn(400),ion.sound.play(e))}function g(){$("#ionSoundPlaying").fadeOut(400),o=!1}function y(){$("#youTubePlayerIframe").is(":visible")?$("#youTubePlayerIframe").fadeOut(1e3):$("#youTubePlayerIframe").fadeIn(1e3)}function v(){sendCommand("ytp pause")}function S(){sendCommand("ytp togglerequests")}function b(){"true"==e?sendDBUpdate("audio_setting","ytSettings","announceInChat","false"):sendDBUpdate("audio_setting","ytSettings","announceInChat","true"),setTimeout(function(){s(),sendCommand("reloadyt")},2*TIMEOUT_WAIT_TIME)}function k(){var e=$("#ytpDJNameInput").val();e.length>0&&($("#ytpDJNameInput").val("Updating..."),sendDBUpdate("audio_setting","ytSettings","playlistDJname",e),setTimeout(function(){s(),$("#ytpDJNameInput").val(""),sendCommand("reloadyt")},2*TIMEOUT_WAIT_TIME))}function T(){var e=$("#ytpMaxReqsInput").val();e.length>0&&($("#ytpMaxReqsInput").val(""),$("#ytpMaxReqsInput").attr("placeholder",e),sendDBUpdate("audio_setting","ytSettings","songRequestsMaxParallel",e),sendCommand("reloadyt"),setTimeout(function(){s()},2*TIMEOUT_WAIT_TIME))}function C(){var e=$("#ytpMaxLengthInput").val();e.length>0&&($("#ytpMaxLengthInput").val(""),$("#ytpMaxLengthInput").attr("placeholder",e),sendDBUpdate("audio_setting","ytSettings","songRequestsMaxSecondsforVideo",e),sendCommand("reloadyt"),setTimeout(function(){s()},2*TIMEOUT_WAIT_TIME))}function D(){var e=$("#playlistImput").val();e.length>0&&($("#playlistImput").val("Loading..."),sendCommand("playlist playlistloadpanel "+e),setTimeout(function(){s(),$("#playlistImput").val("")},4*TIMEOUT_WAIT_TIME))}function M(){$("#youTubePlayerIframe").html('<iframe id="youTubePlayer" frameborder="0" scrolling="auto" height="400" width="680"        src="'+getProtocol()+url[0]+":"+(getPanelPort()+1)+'/ytplayer?start_paused">')}function w(){window.open(getProtocol()+url[0]+":"+(getPanelPort()+1)+"/ytplayer","PhantomBot YouTube Player","menubar=no,resizeable=yes,scrollbars=yes,status=no,toolbar=no,height=700,width=900,location=no")}function A(){YOUTUBE_IFRAME===!0&&(M(),$("#youTubeLauncher").html('<button type="button" class="btn btn-info btn-fill inline " onclick="$.toggleYouTubePlayer()">Hide/Show YouTube Player</button><button type="button" class="btn btn-info btn-fill inline " onclick="$.toggleYouTubePlayerPause()">Toggle Pause</button>'))}var e=!1,t=[],i=[],a=[],o=!1;$("#audioPanel").load("/panel/audio.html");var _=setInterval(function(){TABS_INITIALIZED&&A(),isConnected&&TABS_INITIALIZED&&(s(),clearInterval(_))},INITIAL_WAIT_TIME);setInterval(function(){var e=$("#tabs").tabs("option","active");9==e&&isConnected&&!isInputFocus()&&(newPanelAlert("Refreshing Audio Data","success",1e3),s())},3e4),setInterval(function(){if(a.length>0)for(var e in a)o||(m(a[e]),a.splice(e,1))},1e3),$.audioOnMessage=r,$.audioDoQuery=s,$.playIonSound=m,$.toggleYouTubePlayer=y,$.toggleYouTubePlayerPause=v,$.toggleYouTubePlayerNotify=b,$.toggleYouTubePlayerRequests=S,$.setYouTubePlayerDJName=k,$.setYouTubePlayerMaxReqs=T,$.setYouTubePlayerMaxLength=C,$.fillYouTubePlayerIframe=M,$.launchYouTubePlayer=w,$.deleteBSong=u,$.blacklistSong=h,$.blacklistUser=d,$.deleteUser=c,$.playlists=t,$.loadYtplaylist=D,$.reloadAudioHooks=l}();