!function(){function r(i){var o,n="";try{o=JSON.parse(i.data)}catch(s){return}if(panelHasQuery(o)&&(panelCheckQuery(o,"audio_ytpMaxReqs")&&$("#ytpMaxReqsInput").attr("placeholder",o.results.songRequestsMaxParallel),panelCheckQuery(o,"audio_ytpMaxLength")&&$("#ytpMaxLengthInput").attr("placeholder",o.results.songRequestsMaxSecondsforVideo),panelCheckQuery(o,"audio_ytpDJName")&&$("#ytpDJNameInput").attr("placeholder",o.results.playlistDJname),panelCheckQuery(o,"audio_panel_hook")&&logMsg("Will Play: "+o.audio_panel_hook)),panelCheckQuery(o,"audio_ytplaylists")){if(0===o.results.length)return;t=[];for(var l in o.results)t.push(o.results[l].value);$.playlists=t}if(void 0!==o.audio_panel_hook&&g(o.audio_panel_hook),panelCheckQuery(o,"audio_songblacklist")){if(0===o.results.length)return void $("#ytplayerBSong").html("<i>There are no blacklisted songs.</i>");var n='<table class="table table-hover table-striped">';for(var l in o.results){var u=o.results[l].key;n+="<tr >    <td>"+u+'</td>    <td>        <button type="button" class="btn btn-info btn-fill btn-xs" id="deleteBSong_'+u+'" onclick="$.deleteBSong(\''+u+'\')"><i class="fa fa-trash" /> </button>    </td></tr>'}n+="</table>",$("#ytplayerBSong").html(n),handleInputFocus()}if(panelCheckQuery(o,"audio_hook")){a=[];for(var l in o.results)a.push({name:o.results[l].key,desc:o.results[l].value});0===a.length?($("#audioPanelButtons").html("No sounds configured, please click Reload Audio Hooks if sounds are installed."),$("#ionSoundLoaded").html('<span style="float: right" class="label label-success label-md">Ready</span>')):setTimeout(function(){$(document).ready(function(){ion.sound({sounds:a,path:"/panel/js/ion-sound/sounds/",preload:!0,volume:1,ready_callback:m,ended_callback:p})})},2e3)}if(panelCheckQuery(o,"audio_hook_reload")){a=[];for(var l in o.results)a.push({name:o.results[l].key,desc:o.results[l].value});0===a.length?($("#audioPanelButtons").html("No sounds configured, please click Reload Audio Hooks if sounds are installed."),$("#ionSoundLoaded").html('<span style="float: right" class="label label-success label-md">Ready</span>')):ion.sound({sounds:a,path:"/panel/js/ion-sound/sounds/",preload:!0,volume:1,ready_callback:m,ended_callback:p}),f(),$("#reloadSounds").html("Reload Audio Hooks")}if(panelCheckQuery(o,"audio_ytptoggle1")&&("true"==o.results.announceInChat&&(e="true"),"false"==o.results.announceInChat&&(e="false")),panelCheckQuery(o,"audio_userblacklist")){if(0===o.results.length)return void $("#ytplayerBUser").html("<i>There are no blacklisted users.</i>");n="<table>";for(var l in o.results){var u=o.results[l].key;n+="<tr >    <td>"+u+'</td>    <td>        <button type="button" class="btn btn-info btn-fill btn-xs" id="deleteUser_'+u+'" onclick="$.deleteUser(\''+u+'\')"><i class="fa fa-trash" /> </button>    </td></tr>'}n+="</table>",$("#ytplayerBUser").html(n),handleInputFocus()}}function s(e){sendDBKeys("audio_ytplaylists","ytPanelPlaylist"),sendDBQuery("audio_ytpMaxReqs","ytSettings","songRequestsMaxParallel"),sendDBQuery("audio_ytpMaxLength","ytSettings","songRequestsMaxSecondsforVideo"),sendDBQuery("audio_ytptoggle1","ytSettings","announceInChat"),sendDBQuery("audio_ytpDJName","ytSettings","playlistDJname"),sendDBKeys("audio_songblacklist","ytpBlacklistedSong"),sendDBKeys("audio_userblacklist","ytpBlacklist"),sendDBKeys("audio_hook","audio_hooks")}function l(){$("#reloadSounds").html("Please wait..."),sendCommand("reloadaudiopanelhooks")}function u(e){$("#deleteBSong_"+e).html('<i  class="fa fa-spinner fa-spin" />'),sendDBDelete("audio_bsong_"+e,"ytpBlacklistedSong",e),setTimeout(function(){s()},TIMEOUT_WAIT_TIME)}function h(){var e=$("#songBlacklist").val();0!=e.length&&(sendDBUpdate("audio_song_"+e,"ytpBlacklistedSong",e.toLowerCase(),"true"),setTimeout(function(){s()},TIMEOUT_WAIT_TIME)),setTimeout(function(){$("#songBlacklist").val("")},TIMEOUT_WAIT_TIME)}function c(e){$("#deleteBUser_"+e).html('<i  class="fa fa-spinner fa-spin" />'),sendDBDelete("audio_user_"+e,"ytpBlacklist",e),setTimeout(function(){s()},TIMEOUT_WAIT_TIME)}function d(){var e=$("#userBlacklist").val();0!=e.length&&(sendDBUpdate("audio_user_"+e,"ytpBlacklist",e.toLowerCase(),"true"),setTimeout(function(){s()},TIMEOUT_WAIT_TIME)),setTimeout(function(){$("#userBlacklist").val("")},TIMEOUT_WAIT_TIME)}function f(){$("#audioPanelButtons").html("");for(var e in a)$("#audioPanelButtons").append('<button type="button" class="soundButton btn btn-info btn-fill"onclick="$.playIonSound(\''+a[e].name+"');\">"+a[e].desc+"</button>")}function m(){$("#ionSoundLoaded").html('<span style="float: right" class="label label-success label-md">Ready</span>'),f()}function g(e){n?i.push(e):(n=!0,$("#ionSoundPlaying").fadeIn(400),ion.sound.play(e))}function p(){$("#ionSoundPlaying").fadeOut(400),n=!1}function y(){$("#youTubePlayerIframe").is(":visible")?$("#youTubePlayerIframe").fadeOut(1e3):$("#youTubePlayerIframe").fadeIn(1e3)}function S(){sendCommand("ytp pause")}function T(){sendCommand("ytp togglerequests")}function k(){"true"==e?sendDBUpdate("audio_setting","ytSettings","announceInChat","false"):sendDBUpdate("audio_setting","ytSettings","announceInChat","true"),setTimeout(function(){s(),sendCommand("reloadyt")},2*TIMEOUT_WAIT_TIME)}function v(){var e=$("#ytpDJNameInput").val();e.length>0&&($("#ytpDJNameInput").val("Updating..."),sendDBUpdate("audio_setting","ytSettings","playlistDJname",e),setTimeout(function(){s(),$("#ytpDJNameInput").val(""),sendCommand("reloadyt")},2*TIMEOUT_WAIT_TIME))}function C(){var e=$("#ytpMaxReqsInput").val();e.length>0&&($("#ytpMaxReqsInput").val(""),$("#ytpMaxReqsInput").attr("placeholder",e),sendDBUpdate("audio_setting","ytSettings","songRequestsMaxParallel",e),sendCommand("reloadyt"),setTimeout(function(){s()},2*TIMEOUT_WAIT_TIME))}function b(){var e=$("#ytpMaxLengthInput").val();e.length>0&&($("#ytpMaxLengthInput").val(""),$("#ytpMaxLengthInput").attr("placeholder",e),sendDBUpdate("audio_setting","ytSettings","songRequestsMaxSecondsforVideo",e),sendCommand("reloadyt"),setTimeout(function(){s()},2*TIMEOUT_WAIT_TIME))}function M(){var e=$("#playlistImput").val();e.length>0&&($("#playlistImput").val("Loading..."),sendCommand("playlist playlistloadpanel "+e),setTimeout(function(){s(),$("#playlistImput").val("")},4*TIMEOUT_WAIT_TIME))}function D(){$("#youTubePlayerIframe").html('<iframe id="youTubePlayer" frameborder="0" scrolling="auto" height="400" width="680"        src="'+getProtocol()+url[0]+":"+(getPanelPort()+1)+'/ytplayer?start_paused">')}function A(){window.open(getProtocol()+url[0]+":"+(getPanelPort()+1)+"/ytplayer","PhantomBot YouTube Player","menubar=no,resizeable=yes,scrollbars=yes,status=no,toolbar=no,height=700,width=900,location=no")}function B(){YOUTUBE_IFRAME===!0&&(D(),$("#youTubeLauncher").html('<button type="button" class="btn btn-info btn-fill inline " onclick="$.toggleYouTubePlayer()">Hide/Show YouTube Player</button><button type="button" class="btn btn-info btn-fill inline " onclick="$.toggleYouTubePlayerPause()">Toggle Pause</button>'))}var e=!1,t=[],a=[],i=[],n=!1;$("#audioPanel").load("/panel/audio.html");var P=setInterval(function(){TABS_INITIALIZED&&B(),isConnected&&TABS_INITIALIZED&&(s(),clearInterval(P))},INITIAL_WAIT_TIME);setInterval(function(){var e=$("#tabs").tabs("option","active");9==e&&isConnected&&!isInputFocus()&&(newPanelAlert("Refreshing Audio Data","success",1e3),s())},3e4),setInterval(function(){if(i.length>0)for(var e in i)n||(g(i[e]),i.splice(e,1))},1e3),$.audioOnMessage=r,$.audioDoQuery=s,$.playIonSound=g,$.toggleYouTubePlayer=y,$.toggleYouTubePlayerPause=S,$.toggleYouTubePlayerNotify=k,$.toggleYouTubePlayerRequests=T,$.setYouTubePlayerDJName=v,$.setYouTubePlayerMaxReqs=C,$.setYouTubePlayerMaxLength=b,$.fillYouTubePlayerIframe=D,$.launchYouTubePlayer=A,$.deleteBSong=u,$.blacklistSong=h,$.blacklistUser=d,$.deleteUser=c,$.playlists=t,$.loadYtplaylist=M,$.reloadAudioHooks=l}();