!function(){function t(r){var i,n="";try{i=JSON.parse(r.data)}catch(s){return}if(panelHasQuery(i)&&(panelCheckQuery(i,"audio_ytpMaxReqs")&&$("#ytpMaxReqsInput").attr("placeholder",i.results.songRequestsMaxParallel),panelCheckQuery(i,"audio_ytpMaxLength")&&$("#ytpMaxLengthInput").attr("placeholder",i.results.songRequestsMaxSecondsforVideo),panelCheckQuery(i,"audio_ytpDJName")&&$("#ytpDJNameInput").attr("placeholder",i.results.playlistDJname),panelCheckQuery(i,"audio_panel_hook")&&logMsg("Will Play: "+i.audio_panel_hook)),panelCheckQuery(i,"audio_ytplaylists")){if(0===i.results.length)return;a=[];for(var l in i.results)a.push(i.results[l].value);$.playlists=a}if(void 0!==i.audio_panel_hook&&g(i.audio_panel_hook),panelCheckQuery(i,"audio_songblacklist")){if(0===i.results.length)return void $("#ytplayerBSong").html("<i>There are no blacklisted songs.</i>");var n='<table class="table table-hover table-striped">';for(var l in i.results){var u=i.results[l].key;n+="<tr >    <td>"+u+'</td>    <td>        <button type="button" class="btn btn-info btn-fill btn-xs" id="deleteBSong_'+u+'" onclick="$.deleteBSong(\''+u+'\')"><i class="fa fa-trash" /> </button>    </td></tr>'}n+="</table>",$("#ytplayerBSong").html(n),handleInputFocus()}if(panelCheckQuery(i,"audio_hook")){o=[];for(var l in i.results)o.push({name:i.results[l].key,desc:i.results[l].value});0===o.length?($("#audioPanelButtons").html("No sounds configured, please click Reload Audio Hooks if sounds are installed."),$("#ionSoundLoaded").html('<span style="float: right" class="label label-success label-md">Ready</span>')):setTimeout(function(){$(document).ready(function(){ion.sound({sounds:o,path:"/panel/js/ion-sound/sounds/",preload:!0,volume:1,ready_callback:S,ended_callback:y})})},2e3)}if(panelCheckQuery(i,"audio_hook_reload")){o=[];for(var l in i.results)o.push({name:i.results[l].key,desc:i.results[l].value});0===o.length?($("#audioPanelButtons").html("No sounds configured, please click Reload Audio Hooks if sounds are installed."),$("#ionSoundLoaded").html('<span style="float: right" class="label label-success label-md">Ready</span>')):ion.sound({sounds:o,path:"/panel/js/ion-sound/sounds/",preload:!0,volume:1,ready_callback:S,ended_callback:y}),m(),$("#reloadSounds").html("Reload Audio Hooks")}if(panelCheckQuery(i,"audio_ytptoggle1")&&("true"==i.results.announceInChat&&(e="true"),"false"==i.results.announceInChat&&(e="false")),panelCheckQuery(i,"audio_userblacklist")){if(0===i.results.length)return void $("#ytplayerBUser").html("<i>There are no blacklisted users.</i>");n="<table>";for(var l in i.results){var u=i.results[l].key;n+="<tr >    <td>"+u+'</td>    <td>        <button type="button" class="btn btn-info btn-fill btn-xs" id="deleteUser_'+u+'" onclick="$.deleteUser(\''+u+'\')"><i class="fa fa-trash" /> </button>    </td></tr>'}n+="</table>",$("#ytplayerBUser").html(n),handleInputFocus()}}function s(e){sendDBKeys("audio_ytplaylists","ytPanelPlaylist"),sendDBQuery("audio_ytpMaxReqs","ytSettings","songRequestsMaxParallel"),sendDBQuery("audio_ytpMaxLength","ytSettings","songRequestsMaxSecondsforVideo"),sendDBQuery("audio_ytptoggle1","ytSettings","announceInChat"),sendDBQuery("audio_ytpDJName","ytSettings","playlistDJname"),sendDBKeys("audio_songblacklist","ytpBlacklistedSong"),sendDBKeys("audio_userblacklist","ytpBlacklist"),sendDBKeys("audio_hook","audio_hooks")}function l(){$("#reloadSounds").html("Please wait..."),sendCommand("reloadaudiopanelhooks")}function u(e){$("#deleteBSong_"+e).html('<i  class="fa fa-spinner fa-spin" />'),sendDBDelete("audio_bsong_"+e,"ytpBlacklistedSong",e),setTimeout(function(){s()},TIMEOUT_WAIT_TIME)}function h(){var e=$("#songBlacklist").val();0!=e.length&&(sendDBUpdate("audio_song_"+e,"ytpBlacklistedSong",e.toLowerCase(),"true"),setTimeout(function(){s()},TIMEOUT_WAIT_TIME)),setTimeout(function(){$("#songBlacklist").val("")},TIMEOUT_WAIT_TIME)}function d(e){$("#deleteBUser_"+e).html('<i  class="fa fa-spinner fa-spin" />'),sendDBDelete("audio_user_"+e,"ytpBlacklist",e),setTimeout(function(){s()},TIMEOUT_WAIT_TIME)}function c(){var e=$("#userBlacklist").val();0!=e.length&&(sendDBUpdate("audio_user_"+e,"ytpBlacklist",e.toLowerCase(),"true"),setTimeout(function(){s()},TIMEOUT_WAIT_TIME)),setTimeout(function(){$("#userBlacklist").val("")},TIMEOUT_WAIT_TIME)}function m(){$("#audioPanelButtons").html("");for(var e in o)$("#audioPanelButtons").append('<button type="button" class="soundButton btn btn-info btn-fill"onclick="$.playIonSound(\''+o[e].name+"');\">"+o[e].desc+"</button>")}function S(){$("#ionSoundLoaded").html('<span style="float: right" class="label label-success label-md">Ready</span>'),m()}function g(e){n?r.push(e):(n=!0,$("#ionSoundPlaying").fadeIn(400),ion.sound.play(e))}function y(){$("#ionSoundPlaying").fadeOut(400),n=!1}function T(){$("#youTubePlayerIframe").is(":visible")?$("#youTubePlayerIframe").fadeOut(1e3):$("#youTubePlayerIframe").fadeIn(1e3)}function k(){sendCommand("ytp pause")}function p(){sendCommand("ytp togglerequests")}function C(){"true"==e?sendDBUpdate("audio_setting","ytSettings","announceInChat","false"):sendDBUpdate("audio_setting","ytSettings","announceInChat","true"),setTimeout(function(){s(),sendCommand("reloadyt")},2*TIMEOUT_WAIT_TIME)}function f(){var e=$("#ytpDJNameInput").val();e.length>0&&($("#ytpDJNameInput").val("Updating..."),sendDBUpdate("audio_setting","ytSettings","playlistDJname",e),setTimeout(function(){s(),$("#ytpDJNameInput").val(""),sendCommand("reloadyt")},2*TIMEOUT_WAIT_TIME))}function M(){var e=$("#ytpMaxReqsInput").val();e.length>0&&($("#ytpMaxReqsInput").val(""),$("#ytpMaxReqsInput").attr("placeholder",e),sendDBUpdate("audio_setting","ytSettings","songRequestsMaxParallel",e),sendCommand("reloadyt"),setTimeout(function(){s()},2*TIMEOUT_WAIT_TIME))}function D(){var e=$("#ytpMaxLengthInput").val();e.length>0&&($("#ytpMaxLengthInput").val(""),$("#ytpMaxLengthInput").attr("placeholder",e),sendDBUpdate("audio_setting","ytSettings","songRequestsMaxSecondsforVideo",e),sendCommand("reloadyt"),setTimeout(function(){s()},2*TIMEOUT_WAIT_TIME))}function A(){var e=$("#playlistImput").val();e.length>0&&($("#playlistImput").val("Loading..."),sendCommand("playlist playlistloadpanel "+e),setTimeout(function(){s(),$("#playlistImput").val("")},4*TIMEOUT_WAIT_TIME))}function B(){$("#youTubePlayerIframe").html('<iframe id="youTubePlayer" frameborder="0" scrolling="auto" height="400" width="680"        src="'+getProtocol()+url[0]+":"+(getPanelPort()+1)+'/ytplayer?start_paused">')}function P(){window.open(getProtocol()+url[0]+":"+(getPanelPort()+1)+"/ytplayer","PhantomBot YouTube Player","menubar=no,resizeable=yes,scrollbars=yes,status=no,toolbar=no,height=700,width=900,location=no")}function b(){YOUTUBE_IFRAME===!0&&(B(),$("#youTubeLauncher").html('<button type="button" class="btn btn-info btn-fill inline " onclick="$.toggleYouTubePlayer()">Hide/Show YouTube Player</button><button type="button" class="btn btn-info btn-fill inline " onclick="$.toggleYouTubePlayerPause()">Toggle Pause</button>'))}var e=!1,a=[],o=[],r=[],n=!1;$("#audioPanel").load("/panel/audio.html");var R=setInterval(function(){TABS_INITIALIZED&&b(),isConnected&&TABS_INITIALIZED&&(s(),clearInterval(R))},INITIAL_WAIT_TIME);setInterval(function(){var e=$("#tabs").tabs("option","active");9==e&&isConnected&&!isInputFocus()&&(newPanelAlert("Refreshing Audio Data","success",1e3),s())},3e4),setInterval(function(){if(r.length>0)for(var e in r)n||(g(r[e]),r.splice(e,1))},1e3),$.audioOnMessage=t,$.audioDoQuery=s,$.playIonSound=g,$.toggleYouTubePlayer=T,$.toggleYouTubePlayerPause=k,$.toggleYouTubePlayerNotify=C,$.toggleYouTubePlayerRequests=p,$.setYouTubePlayerDJName=f,$.setYouTubePlayerMaxReqs=M,$.setYouTubePlayerMaxLength=D,$.fillYouTubePlayerIframe=B,$.launchYouTubePlayer=P,$.deleteBSong=u,$.blacklistSong=h,$.blacklistUser=c,$.deleteUser=d,$.playlists=a,$.loadYtplaylist=A,$.reloadAudioHooks=l}();