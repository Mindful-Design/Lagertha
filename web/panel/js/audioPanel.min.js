(function(){function e(e){var t,n="";try{t=JSON.parse(e.data)}catch(e){return}if(panelHasQuery(t)&&(panelCheckQuery(t,"audio_ytpMaxReqs")&&$("#ytpMaxReqsInput").attr("placeholder",t.results.songRequestsMaxParallel),panelCheckQuery(t,"audio_ytpMaxLength")&&$("#ytpMaxLengthInput").attr("placeholder",t.results.songRequestsMaxSecondsforVideo),panelCheckQuery(t,"audio_ytpDJName")&&$("#ytpDJNameInput").attr("placeholder",t.results.playlistDJname),panelCheckQuery(t,"audio_panel_hook")&&logMsg("Will Play: "+t.audio_panel_hook)),panelCheckQuery(t,"audio_ytplaylists")){if(0===t.results.length)return;v=[];for(var a in t.results)v.push(t.results[a].value);$.playlists=v}if(void 0!==t.audio_panel_hook&&d(t.audio_panel_hook),panelCheckQuery(t,"audio_songblacklist")){if(0===t.results.length)return void $("#ytplayerBSong").html("<i>There are no blacklisted songs.</i>");var n='<table class="table table-hover table-striped">';for(var a in t.results){var l=t.results[a].key;n+="<tr >    <td>"+l+'</td>    <td>        <button type="button" class="btn btn-info btn-fill btn-xs" id="deleteBSong_'+l+'" onclick="$.deleteBSong(\''+l+'\')"><i class="fa fa-trash" /> </button>    </td></tr>'}n+="</table>",$("#ytplayerBSong").html(n),handleInputFocus()}if(panelCheckQuery(t,"audio_hook")){M=[];for(var a in t.results)M.push({name:t.results[a].key,desc:t.results[a].value});0===M.length?($("#audioPanelButtons").html("No sounds configured, please click Reload Audio Hooks if sounds are installed."),$("#ionSoundLoaded").html('<span style="float: right" class="label label-success label-md">Ready</span>')):setTimeout(function(){$(document).ready(function(){ion.sound({sounds:M,path:"/panel/js/ion-sound/sounds/",preload:!0,volume:1,ready_callback:i,ended_callback:r})})},2e3)}if(panelCheckQuery(t,"audio_hook_reload")){M=[];for(var a in t.results)M.push({name:t.results[a].key,desc:t.results[a].value});0===M.length?($("#audioPanelButtons").html("No sounds configured, please click Reload Audio Hooks if sounds are installed."),$("#ionSoundLoaded").html('<span style="float: right" class="label label-success label-md">Ready</span>')):ion.sound({sounds:M,path:"/panel/js/ion-sound/sounds/",preload:!0,volume:1,ready_callback:i,ended_callback:r}),u(),$("#reloadSounds").html("Reload Audio Hooks")}if(panelCheckQuery(t,"audio_ytptoggle1")&&("true"==t.results.announceInChat&&(k="true"),"false"==t.results.announceInChat&&(k="false")),panelCheckQuery(t,"audio_userblacklist")){if(0===t.results.length)return void $("#ytplayerBUser").html("<i>There are no blacklisted users.</i>");n="<table>";for(var a in t.results){var l=t.results[a].key;n+="<tr >    <td>"+l+'</td>    <td>        <button type="button" class="btn btn-info btn-fill btn-xs" id="deleteUser_'+l+'" onclick="$.deleteUser(\''+l+'\')"><i class="fa fa-trash" /> </button>    </td></tr>'}n+="</table>",$("#ytplayerBUser").html(n),handleInputFocus()}}function t(e){sendDBKeys("audio_ytplaylists","ytPanelPlaylist"),sendDBQuery("audio_ytpMaxReqs","ytSettings","songRequestsMaxParallel"),sendDBQuery("audio_ytpMaxLength","ytSettings","songRequestsMaxSecondsforVideo"),sendDBQuery("audio_ytptoggle1","ytSettings","announceInChat"),sendDBQuery("audio_ytpDJName","ytSettings","playlistDJname"),sendDBKeys("audio_songblacklist","ytpBlacklistedSong"),sendDBKeys("audio_userblacklist","ytpBlacklist"),sendDBKeys("audio_hook","audio_hooks")}function n(){$("#reloadSounds").html("Please wait..."),sendCommand("reloadaudiopanelhooks")}function a(e){$("#deleteBSong_"+e).html('<i  class="fa fa-spinner fa-spin" />'),sendDBDelete("audio_bsong_"+e,"ytpBlacklistedSong",e),setTimeout(function(){t()},TIMEOUT_WAIT_TIME)}function l(){var e=$("#songBlacklist").val();0!=e.length&&(sendDBUpdate("audio_song_"+e,"ytpBlacklistedSong",e.toLowerCase(),"true"),setTimeout(function(){t()},TIMEOUT_WAIT_TIME)),setTimeout(function(){$("#songBlacklist").val("")},TIMEOUT_WAIT_TIME)}function o(e){$("#deleteBUser_"+e).html('<i  class="fa fa-spinner fa-spin" />'),sendDBDelete("audio_user_"+e,"ytpBlacklist",e),setTimeout(function(){t()},TIMEOUT_WAIT_TIME)}function s(){var e=$("#userBlacklist").val();0!=e.length&&(sendDBUpdate("audio_user_"+e,"ytpBlacklist",e.toLowerCase(),"true"),setTimeout(function(){t()},TIMEOUT_WAIT_TIME)),setTimeout(function(){$("#userBlacklist").val("")},TIMEOUT_WAIT_TIME)}function u(){$("#audioPanelButtons").html("");for(var e in M)$("#audioPanelButtons").append('<button type="button" class="soundButton btn btn-info btn-fill"onclick="$.playIonSound(\''+M[e].name+"');\">"+M[e].desc+"</button>")}function i(){$("#ionSoundLoaded").html('<span style="float: right" class="label label-success label-md">Ready</span>'),u()}function d(e){P?B.push(e):(P=!0,$("#ionSoundPlaying").fadeIn(400),ion.sound.play(e))}function r(){$("#ionSoundPlaying").fadeOut(400),P=!1}function c(){$("#youTubePlayerIframe").is(":visible")?$("#youTubePlayerIframe").fadeOut(1e3):$("#youTubePlayerIframe").fadeIn(1e3)}function y(){sendCommand("ytp pause")}function p(){sendCommand("ytp togglerequests")}function f(){"true"==k?sendDBUpdate("audio_setting","ytSettings","announceInChat","false"):sendDBUpdate("audio_setting","ytSettings","announceInChat","true"),setTimeout(function(){t(),sendCommand("reloadyt")},2*TIMEOUT_WAIT_TIME)}function g(){var e=$("#ytpDJNameInput").val();e.length>0&&($("#ytpDJNameInput").val("Updating..."),sendDBUpdate("audio_setting","ytSettings","playlistDJname",e),setTimeout(function(){t(),$("#ytpDJNameInput").val(""),sendCommand("reloadyt")},2*TIMEOUT_WAIT_TIME))}function h(){var e=$("#ytpMaxReqsInput").val();e.length>0&&($("#ytpMaxReqsInput").val(""),$("#ytpMaxReqsInput").attr("placeholder",e),sendDBUpdate("audio_setting","ytSettings","songRequestsMaxParallel",e),sendCommand("reloadyt"),setTimeout(function(){t()},2*TIMEOUT_WAIT_TIME))}function b(){var e=$("#ytpMaxLengthInput").val();e.length>0&&($("#ytpMaxLengthInput").val(""),$("#ytpMaxLengthInput").attr("placeholder",e),sendDBUpdate("audio_setting","ytSettings","songRequestsMaxSecondsforVideo",e),sendCommand("reloadyt"),setTimeout(function(){t()},2*TIMEOUT_WAIT_TIME))}function T(){var e=$("#playlistImput").val();e.length>0&&($("#playlistImput").val("Loading..."),sendCommand("playlist playlistloadpanel "+e),setTimeout(function(){t(),$("#playlistImput").val("")},4*TIMEOUT_WAIT_TIME))}function I(){$("#youTubePlayerIframe").html('<iframe id="youTubePlayer" frameborder="0" scrolling="auto" height="400" width="680"        src="'+getProtocol()+url[0]+":"+window.location.port+'/ytplayer?start_paused">')}function m(){window.open(getProtocol()+url[0]+":"+window.location.port+"/ytplayer","PhantomBot YouTube Player","menubar=no,resizeable=yes,scrollbars=yes,status=no,toolbar=no,height=700,width=900,location=no")}function _(){YOUTUBE_IFRAME===!0&&(I(),$("#youTubeLauncher").html('<button type="button" class="btn btn-info btn-fill inline " onclick="$.toggleYouTubePlayer()">Hide/Show YouTube Player</button><button type="button" class="btn btn-info btn-fill inline " onclick="$.toggleYouTubePlayerPause()">Toggle Pause</button>'))}var k=!1,v=[],M=[],B=[],P=!1;$("#audioPanel").load("/panel/audio.html");var S=setInterval(function(){TABS_INITIALIZED&&_(),isConnected&&TABS_INITIALIZED&&(t(),clearInterval(S))},INITIAL_WAIT_TIME);setInterval(function(){var e=$("#tabs").tabs("option","active");9==e&&isConnected&&!isInputFocus()&&(newPanelAlert("Refreshing Audio Data","success",1e3),t())},3e4),setInterval(function(){if(B.length>0)for(var e in B)P||(d(B[e]),B.splice(e,1))},1e3),$.audioOnMessage=e,$.audioDoQuery=t,$.playIonSound=d,$.toggleYouTubePlayer=c,$.toggleYouTubePlayerPause=y,$.toggleYouTubePlayerNotify=f,$.toggleYouTubePlayerRequests=p,$.setYouTubePlayerDJName=g,$.setYouTubePlayerMaxReqs=h,$.setYouTubePlayerMaxLength=b,$.fillYouTubePlayerIframe=I,$.launchYouTubePlayer=m,$.deleteBSong=a,$.blacklistSong=l,$.blacklistUser=s,$.deleteUser=o,$.playlists=v,$.loadYtplaylist=T,$.reloadAudioHooks=n})();