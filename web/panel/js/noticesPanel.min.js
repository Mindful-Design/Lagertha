!function(){function s(e){var t,a="",n="";try{t=JSON.parse(e.data)}catch(s){return}if(panelHasQuery(t)){if(panelCheckQuery(t,"notices_settings"))for(var l in t.results)panelMatch(t.results[l].key,"reqmessages")&&$("#noticeReqInput").attr("placeholder",t.results[l].value).blur(),panelMatch(t.results[l].key,"interval")&&$("#noticeIntervalInput").attr("placeholder",t.results[l].value).blur(),panelMatch(t.results[l].key,"noticetoggle")&&(o=t.results[l].value,$("#chatNoticeMode").html(i[t.results[l].value])),panelMatch(t.results[l].key,"noticeOfflineToggle")&&(r=t.results[l].value,$("#chatOfflineNoticeMode").html(i[t.results[l].value]));if(panelCheckQuery(t,"notices_notices")){if(0===t.results.length)return void $("#noticeList").html("<i>No Notices Are Defined</i>");a='<table class="table table-hover table-striped">';for(var l in t.results)n=t.results[l].key.match(/message_(\d+)/)[1],a+="<tr><td>Notice #"+n+'</td><td><form role="form" onkeypress="return event.keyCode != 13"><div class="form-group form-group-table"><div class="input-group"><input class="form-control" type="text" id="inlineNoticeEdit_'+n+'"value="'+t.results[l].value+'" /><span class="input-group-btn"><button type="button" class="btn btn-default btn-fill btn-xs" onclick="$.updateNotice(\''+n+'\')"><i class="fa fa-pencil" /> </button> <button type="button" class="btn btn-default btn-fill btn-xs" id="deleteNotice_'+n+'" onclick="$.deleteNotice(\''+n+'\')"><i class="fa fa-trash" /> </button></span></div></div></form></td></tr>';a+="</table>",$("#noticeList").html(a),handleInputFocus()}}}function l(){sendDBKeys("notices_settings","noticeSettings"),sendDBKeys("notices_notices","notices")}function u(){$("#chatNoticeMode").html(t),"true"==o?sendDBUpdate("notices_settings","noticeSettings","noticetoggle","false"):sendDBUpdate("notices_settings","noticeSettings","noticetoggle","true"),setTimeout(function(){sendCommand("reloadnotice")},TIMEOUT_WAIT_TIME),setTimeout(function(){l()},TIMEOUT_WAIT_TIME)}function h(){$("#chatOfflineNoticeMode").html(t),"true"==r?sendDBUpdate("notices_settings","noticeSettings","noticeOfflineToggle","false"):sendDBUpdate("notices_settings","noticeSettings","noticeOfflineToggle","true"),setTimeout(function(){sendCommand("reloadnotice")},TIMEOUT_WAIT_TIME),setTimeout(function(){l()},TIMEOUT_WAIT_TIME)}function c(e,t){var i=$(e).val();parseInt(i)>=2&&i.length>0&&(sendDBUpdate("noticeIntervalInput","noticeSettings",t,i),$(e).val(""),$(e).attr("placeholder",i).blur(),setTimeout(function(){sendCommand("reloadnotice")},TIMEOUT_WAIT_TIME)),setTimeout(function(){l()},TIMEOUT_WAIT_TIME)}function d(e,t){var i=$(e).val();parseInt(i)>=0&&i.length>0&&(sendDBUpdate("noticeReqInput","noticeSettings",t,i),$(e).val(""),$(e).attr("placeholder",i).blur(),setTimeout(function(){sendCommand("reloadnotice")},TIMEOUT_WAIT_TIME)),setTimeout(function(){l()},TIMEOUT_WAIT_TIME)}function f(){var e=$("#addNoticeInput").val().replace(/\"/g,"%22");e.length>0&&(e=e.replace(/%22/g,"''"),sendCommand("notice addsilent "+e),$("#addNoticeInput").val(""),setTimeout(function(){l()},TIMEOUT_WAIT_TIME))}function p(e){$("#deleteNotice_"+e).html(t),sendCommand("notice removesilent "+e),a||(a=!0,setTimeout(function(){l(),a=!1},4*TIMEOUT_WAIT_TIME))}function m(e){var t=$("#inlineNoticeEdit_"+e).val();t.length>0&&($("#inlineNoticeEdit_"+e).val(t).blur(),sendCommand("notice editsilent "+e+" "+t),setTimeout(function(){l()},TIMEOUT_WAIT_TIME))}var t='<i  class="fa fa-spinner fa-spin" />',i=[],a=!1,n=[];i["false"]='<i class="fa fa-circle-o"/>',i["true"]='<i class="fa fa-circle text-success"/>',n["false"]='<i class="fa fa-circle-o" />',n["true"]='<i class="fa fa-circle text-success"/>';var o=!1,r=!1;$("#noticesPanel").load("/panel/notices.html");var g=setInterval(function(){if(isConnected&&TABS_INITIALIZED){var e=$("#tabs").tabs("option","active");11==e&&(l(),clearInterval(g))}},INITIAL_WAIT_TIME);setInterval(function(){var e=$("#tabs").tabs("option","active");11==e&&isConnected&&!isInputFocus()&&(newPanelAlert("Refreshing Notices Data","success",1e3),l())},3e4),$.noticesOnMessage=s,$.noticesDoQuery=l,$.toggleChatNotice=u,$.toggleChatOfflineNotice=h,$.updateNoticeInterval=c,$.updateNoticeReq=d,$.addNotice=f,$.deleteNotice=p,$.updateNotice=m}();