!function(){function s(e){var a,r="",i="";try{a=JSON.parse(e.data)}catch(s){return}if(panelHasQuery(a)){if(panelCheckQuery(a,"notices_settings"))for(var l in a.results)panelMatch(a.results[l].key,"reqmessages")&&$("#noticeReqInput").attr("placeholder",a.results[l].value).blur(),panelMatch(a.results[l].key,"interval")&&$("#noticeIntervalInput").attr("placeholder",a.results[l].value).blur(),panelMatch(a.results[l].key,"noticetoggle")&&(n=a.results[l].value,$("#chatNoticeMode").html(o[a.results[l].value])),panelMatch(a.results[l].key,"noticeOfflineToggle")&&(t=a.results[l].value,$("#chatOfflineNoticeMode").html(o[a.results[l].value]));if(panelCheckQuery(a,"notices_notices")){if(0===a.results.length)return void $("#noticeList").html("<i>No Notices Are Defined</i>");r='<table class="table table-hover table-striped">';for(var l in a.results)i=a.results[l].key.match(/message_(\d+)/)[1],r+="<tr><td>Notice #"+i+'</td><td><form role="form" onkeypress="return event.keyCode != 13"><div class="form-group form-group-table"><div class="input-group"><input class="form-control" type="text" id="inlineNoticeEdit_'+i+'"value="'+a.results[l].value+'" /><span class="input-group-btn"><button type="button" class="btn btn-default btn-fill btn-xs" onclick="$.updateNotice(\''+i+'\')"><i class="fa fa-pencil" /> </button> <button type="button" class="btn btn-default btn-fill btn-xs" id="deleteNotice_'+i+'" onclick="$.deleteNotice(\''+i+'\')"><i class="fa fa-trash" /> </button></span></div></div></form></td></tr>';r+="</table>",$("#noticeList").html(r),handleInputFocus()}}}function l(){sendDBKeys("notices_settings","noticeSettings"),sendDBKeys("notices_notices","notices")}function u(){$("#chatNoticeMode").html(a),"true"==n?sendDBUpdate("notices_settings","noticeSettings","noticetoggle","false"):sendDBUpdate("notices_settings","noticeSettings","noticetoggle","true"),setTimeout(function(){sendCommand("reloadnotice")},TIMEOUT_WAIT_TIME),setTimeout(function(){l()},TIMEOUT_WAIT_TIME)}function h(){$("#chatOfflineNoticeMode").html(a),"true"==t?sendDBUpdate("notices_settings","noticeSettings","noticeOfflineToggle","false"):sendDBUpdate("notices_settings","noticeSettings","noticeOfflineToggle","true"),setTimeout(function(){sendCommand("reloadnotice")},TIMEOUT_WAIT_TIME),setTimeout(function(){l()},TIMEOUT_WAIT_TIME)}function d(e,a){var o=$(e).val();parseInt(o)>=2&&o.length>0&&(sendDBUpdate("noticeIntervalInput","noticeSettings",a,o),$(e).val(""),$(e).attr("placeholder",o).blur(),setTimeout(function(){sendCommand("reloadnotice")},TIMEOUT_WAIT_TIME)),setTimeout(function(){l()},TIMEOUT_WAIT_TIME)}function c(e,a){var o=$(e).val();parseInt(o)>=0&&o.length>0&&(sendDBUpdate("noticeReqInput","noticeSettings",a,o),$(e).val(""),$(e).attr("placeholder",o).blur(),setTimeout(function(){sendCommand("reloadnotice")},TIMEOUT_WAIT_TIME)),setTimeout(function(){l()},TIMEOUT_WAIT_TIME)}function m(){var e=$("#addNoticeInput").val().replace(/\"/g,"%22");e.length>0&&(e=e.replace(/%22/g,"''"),sendCommand("notice addsilent "+e),$("#addNoticeInput").val(""),setTimeout(function(){l()},TIMEOUT_WAIT_TIME))}function g(e){$("#deleteNotice_"+e).html(a),sendCommand("notice removesilent "+e),r||(r=!0,setTimeout(function(){l(),r=!1},4*TIMEOUT_WAIT_TIME))}function S(e){var a=$("#inlineNoticeEdit_"+e).val();a.length>0&&($("#inlineNoticeEdit_"+e).val(a).blur(),sendCommand("notice editsilent "+e+" "+a),setTimeout(function(){l()},TIMEOUT_WAIT_TIME))}var a='<i  class="fa fa-spinner fa-spin" />',o=[],r=!1,i=[];o["false"]='<i class="fa fa-circle-o"/>',o["true"]='<i class="fa fa-circle text-success"/>',i["false"]='<i class="fa fa-circle-o" />',i["true"]='<i class="fa fa-circle" />';var n=!1,t=!1;$("#noticesPanel").load("/panel/notices.html");var y=setInterval(function(){if(isConnected&&TABS_INITIALIZED){var e=$("#tabs").tabs("option","active");11==e&&(l(),clearInterval(y))}},INITIAL_WAIT_TIME);setInterval(function(){var e=$("#tabs").tabs("option","active");11==e&&isConnected&&!isInputFocus()&&(newPanelAlert("Refreshing Notices Data","success",1e3),l())},3e4),$.noticesOnMessage=s,$.noticesDoQuery=l,$.toggleChatNotice=u,$.toggleChatOfflineNotice=h,$.updateNoticeInterval=d,$.updateNoticeReq=c,$.addNotice=m,$.deleteNotice=g,$.updateNotice=S}();