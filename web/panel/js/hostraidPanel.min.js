!function(){function n(e){var i,t="";try{i=JSON.parse(e.data)}catch(n){return}if(panelHasQuery(i)){if(panelCheckQuery(i,"hostraid_settings"))for(var r in i.results)panelMatch(i.results[r].key,"hostReward")&&$("#hostRewardInput").val(i.results[r].value).blur(),panelMatch(i.results[r].key,"autoHostReward")&&$("#autoHostRewardInput").val(i.results[r].value).blur(),panelMatch(i.results[r].key,"hostMinViewerCount")&&$("#hostMinViewersInput").val(i.results[r].value).blur(),panelMatch(i.results[r].key,"hostMinCount")&&$("#hostMinViewersAlertInput").val(i.results[r].value).blur(),panelMatch(i.results[r].key,"hostMessage")&&$("#hostAnnounceInput").val(i.results[r].value).blur(),panelMatch(i.results[r].key,"autoHostMessage")&&$("#hostAutoAnnounceInput").val(i.results[r].value).blur(),panelMatch(i.results[r].key,"hostToggle")&&$("#hostToggle").html(a[i.results[r].value]),panelMatch(i.results[r].key,"autoHostToggle")&&$("#autoHostToggle").html(a[i.results[r].value]),panelMatch(i.results[r].key,"hostHistory")&&(o=i.results[r].value,$("#hostHistoryMode").html(a[i.results[r].value])),panelMatch(i.results[r].key,"raidMessage")&&$("#raidMessageInput").val(i.results[r].value).blur();if(panelCheckQuery(i,"hostraid_hosthistory")){if(0===i.results.length)return void $("#hostHistoryList").html("<i>No Host History Data to Display</i>");for(t='<table class="table table-hover table-striped"><tr><th>Channel</th><th style="float: right">Date/Time</th></tr>',r=i.results.length-1;r>=0;r--){var s=JSON.parse(i.results[r].value);t+="<tr >  <td>"+s.host+"</td>  <td>"+$.format.date(parseInt(s.time),"MM.dd.yy HH:mm:ss")+"</td></tr>"}t+="</table>",$("#hostHistoryList").html(t)}if(panelCheckQuery(i,"hostraid_inraids")){if(0===i.results.length)return void $("#incomingRaidList").html("<i>No Incoming Raid Data to Display</i>");t='<br><table><tr><th>Channel</th><th style="float: right">Raid Count</th></tr>';for(r in i.results)t+="<tr >    <td>"+i.results[r].key+"</td>    <td>"+i.results[r].value+"</td></tr>";t+="</table>",$("#incomingRaidList").html(t)}if(panelCheckQuery(i,"hostraid_outraids")){if(0===i.results.length)return void $("#outgoingRaidList").html("<i>No Outgoing Raid Data to Display</i>");t='<br><table><tr><th>Channel</th><th style="float: right">Raid Count</th></tr>';for(r in i.results)t+="<tr >    <td>"+i.results[r].key+"</td>    <td>"+i.results[r].value+"</td></tr>";t+="</table>",$("#outgoingRaidList").html(t)}}}function r(){sendDBKeys("hostraid_hosthistory","hosthistory"),sendDBKeys("hostraid_settings","settings"),sendDBKeys("hostraid_inraids","incommingRaids"),sendDBKeys("hostraid_outraids","outgoingRaids")}function s(){var e=$("#hostChannelInput").val();e.length>0&&(sendCommand("host "+e),$("#hostChannelInput").val(""))}function l(){var e=$("#raidChannelInput").val();e.length>0&&(sendCommand("raid "+e),$("#raidChannelInput").val(""))}function u(){var e=$("#raiderChannelInput").val();e.length>0&&(sendCommand("raider "+e),$("#raiderChannelInput").val(""))}function h(){var e=$("#hostAnnounceInput").val();e.length>0&&(console.log(e),sendDBUpdate("hostraid_settings","settings","hostMessage",e),sendCommand("reloadhost"),setTimeout(function(){r()},TIMEOUT_WAIT_TIME))}function c(){var e=$("#hostAutoAnnounceInput").val();e.length>0&&(sendDBUpdate("hostraid_settings","settings","autoHostMessage",e),sendCommand("reloadhost"),setTimeout(function(){r()},TIMEOUT_WAIT_TIME))}function d(){var e=$("#hostRewardInput").val();e.length>0&&(sendDBUpdate("hostraid_settings","settings","hostReward",e),sendCommand("reloadhost"),setTimeout(function(){r()},TIMEOUT_WAIT_TIME))}function f(){var e=$("#autoHostRewardInput").val();e.length>0&&(sendDBUpdate("hostraid_settings","settings","autoHostReward",e),sendCommand("reloadhost"),setTimeout(function(){r()},TIMEOUT_WAIT_TIME))}function m(){var e=$("#hostMinViewersInput").val();e.length>0&&(sendDBUpdate("hostraid_settings","settings","hostMinViewerCount",e),sendCommand("reloadhost"),setTimeout(function(){r()},TIMEOUT_WAIT_TIME))}function g(){var e=$("#hostMinViewersAlertInput").val();e.length>0&&(sendDBUpdate("hostraid_settings","settings","hostMinCount",e),sendCommand("reloadhost"),setTimeout(function(){r()},TIMEOUT_WAIT_TIME))}function p(e){"true"==o?sendDBUpdate("hostraid_settings","settings","hostHistory","false"):sendDBUpdate("hostraid_settings","settings","hostHistory","true"),sendCommand("reloadhost"),setTimeout(function(){r()},TIMEOUT_WAIT_TIME)}function y(){var e=$("#raidMessageInput").val();e.length>0&&(sendDBUpdate("hostraid_settings","settings","raidMessage",e),setTimeout(function(){r()},TIMEOUT_WAIT_TIME))}function S(e,a,i){$("#"+a).html(t),sendDBUpdate("hostraid_settings",e,a,i),setTimeout(function(){r(),sendCommand("reloadhost")},TIMEOUT_WAIT_TIME)}var t='<i  class="fa fa-spinner fa-spin" />',a=[],i=[];a["false"]='<i class="fa fa-circle text-warning"/>',a["true"]='<i class="fa fa-circle text-success"/>',i["false"]='<i class="fa fa-circle text-warning" />',i["true"]='<i class="fa fa-circle text-success" />';var o=!1;$("#hostraidPanel").load("/panel/hostraid.html");var T=setInterval(function(){if(isConnected&&TABS_INITIALIZED){var e=$("#tabs").tabs("option","active");15==e&&(r(),clearInterval(T))}},INITIAL_WAIT_TIME);setInterval(function(){var e=$("#tabs").tabs("option","active");15==e&&isConnected&&!isInputFocus()&&(newPanelAlert("Refreshing Hosts/Raids Data","success",1e3),r())},3e4),$.hostraidOnMessage=n,$.hostraidDoQuery=r,$.hostChannel=s,$.raidChannel=l,$.raiderChannel=u,$.updateHostAnnounce=h,$.updateAutoHostAnnounce=c,$.updateHostReward=d,$.updateAutoHostReward=f,$.updateHostMinViewers=m,$.changeHostHistory=p,$.updateRaidMessage=y,$.toggle=S,$.hostMinViewersAlert=g}();