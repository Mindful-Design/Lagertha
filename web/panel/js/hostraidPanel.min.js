!function(){function o(e){var a,t="";try{a=JSON.parse(e.data)}catch(o){return}if(panelHasQuery(a)){if(panelCheckQuery(a,"hostraid_settings"))for(var r in a.results)panelMatch(a.results[r].key,"hostReward")&&$("#hostRewardInput").val(a.results[r].value).blur(),panelMatch(a.results[r].key,"autoHostReward")&&$("#autoHostRewardInput").val(a.results[r].value).blur(),panelMatch(a.results[r].key,"hostMinViewerCount")&&$("#hostMinViewersInput").val(a.results[r].value).blur(),panelMatch(a.results[r].key,"hostMinCount")&&$("#hostMinViewersAlertInput").val(a.results[r].value).blur(),panelMatch(a.results[r].key,"hostMessage")&&$("#hostAnnounceInput").val(a.results[r].value).blur(),panelMatch(a.results[r].key,"autoHostMessage")&&$("#hostAutoAnnounceInput").val(a.results[r].value).blur(),panelMatch(a.results[r].key,"hostToggle")&&$("#hostToggle").html(i[a.results[r].value]),panelMatch(a.results[r].key,"autoHostToggle")&&$("#autoHostToggle").html(i[a.results[r].value]),panelMatch(a.results[r].key,"hostHistory")&&(n=a.results[r].value,$("#hostHistoryMode").html(i[a.results[r].value])),panelMatch(a.results[r].key,"raidMessage")&&$("#raidMessageInput").val(a.results[r].value).blur();if(panelCheckQuery(a,"hostraid_hosthistory")){if(0===a.results.length)return void $("#hostHistoryList").html("<i>No Host History Data to Display</i>");for(t='<table class="table table-hover table-striped"><tr><th>Channel</th><th style="float: right">Date/Time</th></tr>',r=a.results.length-1;r>=0;r--){var s=JSON.parse(a.results[r].value);t+="<tr >  <td>"+s.host+"</td>  <td>"+$.format.date(parseInt(s.time),"MM.dd.yy HH:mm:ss")+"</td></tr>"}t+="</table>",$("#hostHistoryList").html(t)}if(panelCheckQuery(a,"hostraid_inraids")){if(0===a.results.length)return void $("#incomingRaidList").html("<i>No Incoming Raid Data to Display</i>");t='<br><table><tr><th>Channel</th><th style="float: right">Raid Count</th></tr>';for(r in a.results)t+="<tr >    <td>"+a.results[r].key+"</td>    <td>"+a.results[r].value+"</td></tr>";t+="</table>",$("#incomingRaidList").html(t)}if(panelCheckQuery(a,"hostraid_outraids")){if(0===a.results.length)return void $("#outgoingRaidList").html("<i>No Outgoing Raid Data to Display</i>");t='<br><table><tr><th>Channel</th><th style="float: right">Raid Count</th></tr>';for(r in a.results)t+="<tr >    <td>"+a.results[r].key+"</td>    <td>"+a.results[r].value+"</td></tr>";t+="</table>",$("#outgoingRaidList").html(t)}}}function r(){sendDBKeys("hostraid_hosthistory","hosthistory"),sendDBKeys("hostraid_settings","settings"),sendDBKeys("hostraid_inraids","incommingRaids"),sendDBKeys("hostraid_outraids","outgoingRaids")}function s(){var e=$("#hostChannelInput").val();e.length>0&&(sendCommand("host "+e),$("#hostChannelInput").val(""))}function l(){var e=$("#raidChannelInput").val();e.length>0&&(sendCommand("raid "+e),$("#raidChannelInput").val(""))}function u(){var e=$("#raiderChannelInput").val();e.length>0&&(sendCommand("raider "+e),$("#raiderChannelInput").val(""))}function h(){var e=$("#hostAnnounceInput").val();e.length>0&&(console.log(e),sendDBUpdate("hostraid_settings","settings","hostMessage",e),sendCommand("reloadhost"),setTimeout(function(){r()},TIMEOUT_WAIT_TIME))}function c(){var e=$("#hostAutoAnnounceInput").val();e.length>0&&(sendDBUpdate("hostraid_settings","settings","autoHostMessage",e),sendCommand("reloadhost"),setTimeout(function(){r()},TIMEOUT_WAIT_TIME))}function d(){var e=$("#hostRewardInput").val();e.length>0&&(sendDBUpdate("hostraid_settings","settings","hostReward",e),sendCommand("reloadhost"),setTimeout(function(){r()},TIMEOUT_WAIT_TIME))}function f(){var e=$("#autoHostRewardInput").val();e.length>0&&(sendDBUpdate("hostraid_settings","settings","autoHostReward",e),sendCommand("reloadhost"),setTimeout(function(){r()},TIMEOUT_WAIT_TIME))}function p(){var e=$("#hostMinViewersInput").val();e.length>0&&(sendDBUpdate("hostraid_settings","settings","hostMinViewerCount",e),sendCommand("reloadhost"),setTimeout(function(){r()},TIMEOUT_WAIT_TIME))}function m(){var e=$("#hostMinViewersAlertInput").val();e.length>0&&(sendDBUpdate("hostraid_settings","settings","hostMinCount",e),sendCommand("reloadhost"),setTimeout(function(){r()},TIMEOUT_WAIT_TIME))}function g(e){"true"==n?sendDBUpdate("hostraid_settings","settings","hostHistory","false"):sendDBUpdate("hostraid_settings","settings","hostHistory","true"),sendCommand("reloadhost"),setTimeout(function(){r()},TIMEOUT_WAIT_TIME)}function y(){var e=$("#raidMessageInput").val();e.length>0&&(sendDBUpdate("hostraid_settings","settings","raidMessage",e),setTimeout(function(){r()},TIMEOUT_WAIT_TIME))}function v(e,i,a){$("#"+i).html(t),sendDBUpdate("hostraid_settings",e,i,a),setTimeout(function(){r(),sendCommand("reloadhost")},TIMEOUT_WAIT_TIME)}var t='<i  class="fa fa-spinner fa-spin" />',i=[],a=[];i["false"]='<i class="fa fa-circle-o"/>',i["true"]='<i class="fa fa-circle text-success"/>',a["false"]='<i class="fa fa-circle-o" />',a["true"]='<i class="fa fa-circle text-success" />';var n=!1;$("#hostraidPanel").load("/panel/hostraid.html");var S=setInterval(function(){if(isConnected&&TABS_INITIALIZED){var e=$("#tabs").tabs("option","active");15==e&&(r(),clearInterval(S))}},INITIAL_WAIT_TIME);setInterval(function(){var e=$("#tabs").tabs("option","active");15==e&&isConnected&&!isInputFocus()&&(newPanelAlert("Refreshing Hosts/Raids Data","success",1e3),r())},3e4),$.hostraidOnMessage=o,$.hostraidDoQuery=r,$.hostChannel=s,$.raidChannel=l,$.raiderChannel=u,$.updateHostAnnounce=h,$.updateAutoHostAnnounce=c,$.updateHostReward=d,$.updateAutoHostReward=f,$.updateHostMinViewers=p,$.changeHostHistory=g,$.updateRaidMessage=y,$.toggle=v,$.hostMinViewersAlert=m}();