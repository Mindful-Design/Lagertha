!function(){function n(e){var r,a="";try{r=JSON.parse(e.data)}catch(n){return}if(panelHasQuery(r)){if(panelCheckQuery(r,"hostraid_settings"))for(var t in r.results)panelMatch(r.results[t].key,"hostReward")&&$("#hostRewardInput").val(r.results[t].value).blur(),panelMatch(r.results[t].key,"autoHostReward")&&$("#autoHostRewardInput").val(r.results[t].value).blur(),panelMatch(r.results[t].key,"hostMinViewerCount")&&$("#hostMinViewersInput").val(r.results[t].value).blur(),panelMatch(r.results[t].key,"hostMinCount")&&$("#hostMinViewersAlertInput").val(r.results[t].value).blur(),panelMatch(r.results[t].key,"hostMessage")&&$("#hostAnnounceInput").val(r.results[t].value).blur(),panelMatch(r.results[t].key,"autoHostMessage")&&$("#hostAutoAnnounceInput").val(r.results[t].value).blur(),panelMatch(r.results[t].key,"hostToggle")&&$("#hostToggle").html(o[r.results[t].value]),panelMatch(r.results[t].key,"autoHostToggle")&&$("#autoHostToggle").html(o[r.results[t].value]),panelMatch(r.results[t].key,"hostHistory")&&(i=r.results[t].value,$("#hostHistoryMode").html(o[r.results[t].value])),panelMatch(r.results[t].key,"raidMessage")&&$("#raidMessageInput").val(r.results[t].value).blur();if(panelCheckQuery(r,"hostraid_hosthistory")){if(0===r.results.length)return void $("#hostHistoryList").html("<i>No Host History Data to Display</i>");for(a='<table class="table table-hover table-striped"><tr><th>Channel</th><th style="float: right">Date/Time</th></tr>',t=r.results.length-1;t>=0;t--){var s=JSON.parse(r.results[t].value);a+="<tr >  <td>"+s.host+"</td>  <td>"+$.format.date(parseInt(s.time),"MM.dd.yy HH:mm:ss")+"</td></tr>"}a+="</table>",$("#hostHistoryList").html(a)}if(panelCheckQuery(r,"hostraid_inraids")){if(0===r.results.length)return void $("#incomingRaidList").html("<i>No Incoming Raid Data to Display</i>");a='<br><table><tr><th>Channel</th><th style="float: right">Raid Count</th></tr>';for(t in r.results)a+="<tr >    <td>"+r.results[t].key+"</td>    <td>"+r.results[t].value+"</td></tr>";a+="</table>",$("#incomingRaidList").html(a)}if(panelCheckQuery(r,"hostraid_outraids")){if(0===r.results.length)return void $("#outgoingRaidList").html("<i>No Outgoing Raid Data to Display</i>");a='<br><table><tr><th>Channel</th><th style="float: right">Raid Count</th></tr>';for(t in r.results)a+="<tr >    <td>"+r.results[t].key+"</td>    <td>"+r.results[t].value+"</td></tr>";a+="</table>",$("#outgoingRaidList").html(a)}}}function t(){sendDBKeys("hostraid_hosthistory","hosthistory"),sendDBKeys("hostraid_settings","settings"),sendDBKeys("hostraid_inraids","incommingRaids"),sendDBKeys("hostraid_outraids","outgoingRaids")}function s(){var e=$("#hostChannelInput").val();e.length>0&&(sendCommand("host "+e),$("#hostChannelInput").val(""))}function l(){var e=$("#raidChannelInput").val();e.length>0&&(sendCommand("raid "+e),$("#raidChannelInput").val(""))}function u(){var e=$("#raiderChannelInput").val();e.length>0&&(sendCommand("raider "+e),$("#raiderChannelInput").val(""))}function h(){var e=$("#hostAnnounceInput").val();e.length>0&&(console.log(e),sendDBUpdate("hostraid_settings","settings","hostMessage",e),sendCommand("reloadhost"),setTimeout(function(){t()},TIMEOUT_WAIT_TIME))}function d(){var e=$("#hostAutoAnnounceInput").val();e.length>0&&(sendDBUpdate("hostraid_settings","settings","autoHostMessage",e),sendCommand("reloadhost"),setTimeout(function(){t()},TIMEOUT_WAIT_TIME))}function c(){var e=$("#hostRewardInput").val();e.length>0&&(sendDBUpdate("hostraid_settings","settings","hostReward",e),sendCommand("reloadhost"),setTimeout(function(){t()},TIMEOUT_WAIT_TIME))}function m(){var e=$("#autoHostRewardInput").val();e.length>0&&(sendDBUpdate("hostraid_settings","settings","autoHostReward",e),sendCommand("reloadhost"),setTimeout(function(){t()},TIMEOUT_WAIT_TIME))}function g(){var e=$("#hostMinViewersInput").val();e.length>0&&(sendDBUpdate("hostraid_settings","settings","hostMinViewerCount",e),sendCommand("reloadhost"),setTimeout(function(){t()},TIMEOUT_WAIT_TIME))}function S(){var e=$("#hostMinViewersAlertInput").val();e.length>0&&(sendDBUpdate("hostraid_settings","settings","hostMinCount",e),sendCommand("reloadhost"),setTimeout(function(){t()},TIMEOUT_WAIT_TIME))}function y(e){"true"==i?sendDBUpdate("hostraid_settings","settings","hostHistory","false"):sendDBUpdate("hostraid_settings","settings","hostHistory","true"),sendCommand("reloadhost"),setTimeout(function(){t()},TIMEOUT_WAIT_TIME)}function T(){var e=$("#raidMessageInput").val();e.length>0&&(sendDBUpdate("hostraid_settings","settings","raidMessage",e),setTimeout(function(){t()},TIMEOUT_WAIT_TIME))}function k(e,o,r){$("#"+o).html(a),sendDBUpdate("hostraid_settings",e,o,r),setTimeout(function(){t(),sendCommand("reloadhost")},TIMEOUT_WAIT_TIME)}var a='<i  class="fa fa-spinner fa-spin" />',o=[],r=[];o["false"]='<i class="fa fa-circle text-warning"/>',o["true"]='<i class="fa fa-circle text-success"/>',r["false"]='<i class="fa fa-circle text-warning" />',r["true"]='<i class="fa fa-circle text-success" />';var i=!1;$("#hostraidPanel").load("/panel/hostraid.html");var p=setInterval(function(){if(isConnected&&TABS_INITIALIZED){var e=$("#tabs").tabs("option","active");15==e&&(t(),clearInterval(p))}},INITIAL_WAIT_TIME);setInterval(function(){var e=$("#tabs").tabs("option","active");15==e&&isConnected&&!isInputFocus()&&(newPanelAlert("Refreshing Hosts/Raids Data","success",1e3),t())},3e4),$.hostraidOnMessage=n,$.hostraidDoQuery=t,$.hostChannel=s,$.raidChannel=l,$.raiderChannel=u,$.updateHostAnnounce=h,$.updateAutoHostAnnounce=d,$.updateHostReward=c,$.updateAutoHostReward=m,$.updateHostMinViewers=g,$.changeHostHistory=y,$.updateRaidMessage=T,$.toggle=k,$.hostMinViewersAlert=S}();