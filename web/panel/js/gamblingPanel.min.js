!function(){function t(e){var t,n="",a="";try{t=JSON.parse(e.data)}catch(s){return}if(panelHasQuery(t)){if(panelCheckQuery(t,"gambling_rafflesettings"))for(c in t.results){var o=t.results[c].value,i=t.results[c].key;"raffleMessage"==i&&$("#raffle-message-input").val(o),"raffleMessageInterval"==i&&(0==o?($("#raffle-message-timer2").html("Disabled"),$("#raffle-message-timer").html("0")):($("#raffle-message-timer2").html(o+" Minutes"),$("#raffle-message-timer").val(o))),"noRepickSame"==i&&("true"==o?$("#raffle-repick").html("No"):$("#raffle-repick").html("Yes")),"raffleWhisperWinner"==i&&("true"==o?$("#raffle-whisper-winner").html("Yes"):$("#raffle-whisper-winner").html("No")),"raffleMSGToggle"==i&&("true"==o?$("#raffle-message").html("Enabled"):$("#raffle-message").html("Disabled"))}if(panelCheckQuery(t,"gambling_auctionresults")){for(c in t.results)panelMatch(t.results[c].key,"winner")&&(n=t.results[c].value),panelMatch(t.results[c].key,"amount")&&(a=t.results[c].value);n.length>0&&$("#auctionResults").html("<strong>Results from Last Auction</strong><br>Winner: "+n+"<br>Amount Paid: "+a)}if(panelCheckQuery(t,"gambling_raffleresults")&&(n=t.results.winner,null!==n&&$("#raffleResults").html("<strong>Winner of Last Raffle: </strong>"+n)),panelCheckQuery(t,"gambling_traffleresults")&&(n=t.results.winner,null!==n&&$("#traffleResults").html("<strong>Winner of Last Ticket Raffle: </strong>"+n)),panelCheckQuery(t,"gambling_trafflemessage")&&$("#traffleMsg").val(t.results.traffleMessage),panelCheckQuery(t,"gambling_traffletimer")&&$("#traffleTimer").val(t.results.traffleMessageInterval),panelCheckQuery(t,"gambling_rafflemsgtoggle")&&panelMatch(t.results.raffleMSGToggle,"true")&&$("#raffleEnterMsg").attr("checked","checked"),panelCheckQuery(t,"gambling_trafflemsgtoggle")&&panelMatch(t.results.tRaffleMSGToggle,"true")&&$("#traffleEnterMsg").attr("checked","checked"),panelCheckQuery(t,"gambling_rafflelistentries")&&(a=t.results.raffleEntries,(null===a||void 0===a||0===a)&&$("#raffleentries").html("0"),$("#raffleentries").html(t.results.raffleEntries)),panelCheckQuery(t,"gambling_trafflelistentries")&&(a=t.results.ticketRaffleEntries,(null===a||void 0===a||0===a)&&$("#traffleentries").html("0"),$("#traffleentries").html(t.results.ticketRaffleEntries)),panelCheckQuery(t,"gambling_rafflelist")){var r=t.results,l="",d="";l="<table class='table table-hover table-striped'>";for(var c=0;c<r.length;c++)d=r[c].key,l+="<tr >    <td>"+d+"</td>    <td></tr>";l+="</table>",$("#raffleListTable").html(l)}if(panelCheckQuery(t,"gambling_trafflelist")){var u=t.results,l="",d="",m="";l="<table>";for(var c=0;c<u.length;c++)d=u[c].key,m=u[c].value,l+="<tr >    <td>"+d+"</td>    <td>"+m+"</td>    <td></tr>";l+="</table>",$("#traffleListTable").html(l)}}}function n(){sendDBKeys("gambling_rafflesettings","raffleSettings"),sendDBKeys("gambling_betresults","betresults"),sendDBKeys("gambling_auctionresults","auctionresults"),sendDBQuery("gambling_raffleresults","raffleresults","winner"),sendDBQuery("gambling_traffleresults","traffleresults","winner"),sendDBKeys("gambling_rafflelist","raffleList"),sendDBKeys("gambling_trafflelist","ticketsList"),sendDBQuery("gambling_trafflemsgtoggle","settings","tRaffleMSGToggle"),sendDBQuery("gambling_traffletimer","settings","traffleMessageInterval"),sendDBQuery("gambling_trafflemessage","settings","traffleMessage"),sendDBQuery("gambling_rafflelistentries","raffleresults","raffleEntries"),sendDBQuery("gambling_trafflelistentries","raffleresults","ticketRaffleEntries")}function a(){var e=$("#auctionIncrementInput").val(),t=$("#auctionBetInput").val(),n=$("#auctionTimerInput").val();e.length>0&&t.length>0&&(sendCommand("auction open "+e+" "+t+" "+n),$("#auctionIncrementInput").val(""),$("#auctionBetInput").val(""),$("#auctionTimerInput").val(""))}function s(){sendCommand("auction close"),setTimeout(function(){n()},2*TIMEOUT_WAIT_TIME)}function o(){var t=$("#raffle-time-keyword").val(),a=$("#raffle-time-cost").val(),s=$("#raffle-time-timer").val(),o=$("#raffle-time-regluck").val(),i=$("#raffle-time-subluck").val();(0!=t.length||0!=a.length)&&(0==i&&(i=1),0==o&&(o=1),sendDBUpdate("raffle_sub_luck","raffleSettings","subscriberBonusRaffle",String(i)),sendDBUpdate("raffle_sub_luck","raffleSettings","regularBonusRaffle",String(o)),setTimeout(function(){sendCommand("reloadraffle"),sendCommand("raffle open "+a+" "+t+" "+s+" "+e+" -usetime")},TIMEOUT_WAIT_TIME),setTimeout(function(){n()},2*TIMEOUT_WAIT_TIME),$("#raffle-time-keyword").val(""),$("#raffle-time-cost").val(""),$("#raffle-time-sub").html("1 Times"),$("#raffle-time-reg").html("1 Times"),$("#raffle-time-timer2").html("Until closed"),$("#raffle-time-timer").val("0"),$("#raffle-time-regluck").val("0"),$("#raffle-time-subluck").val("0"))}function i(){var t=$("#raffle-keyword").val(),a=$("#raffle-cost").val(),s=$("#raffle-points-timer").val(),o=$("#raffle-points-regluck").val(),i=$("#raffle-points-subluck").val();(0!=t.length||0!=a.length)&&(0==i&&(i=1),0==o&&(o=1),sendDBUpdate("raffle_sub_luck","raffleSettings","subscriberBonusRaffle",String(i)),sendDBUpdate("raffle_sub_luck","raffleSettings","regularBonusRaffle",String(o)),setTimeout(function(){sendCommand("reloadraffle"),sendCommand("raffle open "+a+" "+t+" "+s+" "+e+" -usepoints")},TIMEOUT_WAIT_TIME),setTimeout(function(){n()},2*TIMEOUT_WAIT_TIME),$("#raffle-keyword").val(""),$("#raffle-cost").val(""),$("#raffle-points-sub").html("1 Times"),$("#raffle-points-reg").html("1 Times"),$("#raffle-points-timer2").html("Until closed"),$("#raffle-points-timer").val("0"),$("#raffle-points-regluck").val("0"),$("#raffle-points-subluck").val("0"))}function r(){var t=$("#raffle-normal-keyword").val(),a=$("#raffle-normal-timer").val(),s=$("#raffle-normal-regluck").val(),o=$("#raffle-normal-subluck").val();0!=t.length&&(0==o&&(o=1),0==s&&(s=1),sendDBUpdate("raffle_sub_luck","raffleSettings","subscriberBonusRaffle",String(o)),sendDBUpdate("raffle_sub_luck","raffleSettings","regularBonusRaffle",String(s)),setTimeout(function(){sendCommand("reloadraffle"),sendCommand("raffle open "+t+" "+a+" "+e)},TIMEOUT_WAIT_TIME),setTimeout(function(){n()},2*TIMEOUT_WAIT_TIME),$("#raffle-normal-keyword").val(""),$("#raffle-normal-subluck2").html("1 Times"),$("#raffle-normal-regluck2").html("1 Times"),$("#raffle-normal-timer2").html("Until closed"),$("#raffle-normal-timer").val("0"),$("#raffle-normal-regluck").val("0"),$("#raffle-normal-subluck").val("0"),document.getElementById("raffle-normal-regluck").value=0,document.getElementById("raffle-normal-subluck").value=0,document.getElementById("raffle-normal-timer").value=0)}function l(){var e=$("#raffle-message-input").val(),t=$("#raffle-message-timer").val();sendDBUpdate("raffle_settings_set","raffleSettings","raffleMessage",e),sendDBUpdate("raffle_settings_set","raffleSettings","raffleMessageInterval",String(t)),setTimeout(function(){n(),sendCommand("reloadraffle")},2*TIMEOUT_WAIT_TIME)}function d(){sendCommand("raffle close"),setTimeout(function(){n()},TIMEOUT_WAIT_TIME)}function c(){sendCommand("raffle repick"),setTimeout(function(){n()},TIMEOUT_WAIT_TIME)}function u(t){e="followers"==t?"-followers":"subscribers"==t?"-subscribers":""}function m(e,t,a){sendDBUpdate("dropdown_set",e,t,a),sendCommand("reloadraffle"),setTimeout(function(){n()},2*TIMEOUT_WAIT_TIME)}function f(){sendCommand("traffle repick"),setTimeout(function(){n()},2*TIMEOUT_WAIT_TIME)}function h(){sendCommand("traffle close"),setTimeout(function(){n()},2*TIMEOUT_WAIT_TIME)}function p(){var e=$("#traffleMaxInput").val(),t=$("#traffleCostInput").val(),n=$("#traffleFollowerInput:checked").val();e.length>0&&t.length>0&&(sendCommand("traffle open "+e+" "+t+" "+n),$("#traffleMaxInput").val(""),$("#traffleCostInput").val(""),$("#traffleFollowerInput:checkbox").removeAttr("checked"))}function g(){$("#traffleEnterMsg").attr("checked","checked");$("#traffleEnterMsg").is(":checked")===!0?sendDBUpdate("gambling_trafflemsgtoggle","settings","tRaffleMSGToggle","true"):sendDBUpdate("gambling_trafflemsgtoggle","settings","tRaffleMSGToggle","false"),setTimeout(function(){sendCommand("reloadtraffle")},TIMEOUT_WAIT_TIME)}function y(e){var t=$("#"+e).val();"traffleMsg"==e&&sendDBUpdate("gambling_trafflemessage","settings","traffleMessage",t),"traffleTimer"==e&&sendDBUpdate("gambling_trafflemessage","settings","traffleMessageInterval",t),setTimeout(function(){sendCommand("reloadtraffle")},TIMEOUT_WAIT_TIME)}var e;$("#gamblingPanel").load("/panel/gambling.html");var v=setInterval(function(){if(isConnected&&TABS_INITIALIZED){var e=$("#tabs").tabs("option","active");14==e&&(n(),clearInterval(v))}},INITIAL_WAIT_TIME);setInterval(function(){var e=$("#tabs").tabs("option","active");14==e&&isConnected&&!isInputFocus()&&(newPanelAlert("Refreshing Gambling Data","success",1e3),n())},2e4),$.gamblingOnMessage=t,$.gamblingDoQuery=n,$.auctionOpen=a,$.auctionClose=s,$.traffleRepick=f,$.traffleOpen=p,$.traffleClose=h,$.toggleTRaffleMsg=g,$.updateTRaffleSettings=y,$.setEligibility=u,$.raffle={openTime:o,openPoints:i,openNormal:r,end:d,repick:c,settings:l,set:m}}();