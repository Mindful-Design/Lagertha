!function(){function t(e){var t,i="",n="";try{t=JSON.parse(e.data)}catch(s){return}if(panelHasQuery(t)){if(panelCheckQuery(t,"gambling_rafflesettings"))for(h in t.results){var r=t.results[h].value,a=t.results[h].key;"raffleMessage"==a&&$("#raffle-message-input").val(r),"raffleMessageInterval"==a&&(0==r?($("#raffle-message-timer2").html("Disabled"),$("#raffle-message-timer").html("0")):($("#raffle-message-timer2").html(r+" Minutes"),$("#raffle-message-timer").val(r))),"noRepickSame"==a&&("true"==r?$("#raffle-repick").html("No"):$("#raffle-repick").html("Yes")),"raffleWhisperWinner"==a&&("true"==r?$("#raffle-whisper-winner").html("Yes"):$("#raffle-whisper-winner").html("No")),"raffleMSGToggle"==a&&("true"==r?$("#raffle-message").html("Enabled"):$("#raffle-message").html("Disabled"))}if(panelCheckQuery(t,"gambling_auctionresults")){for(h in t.results)panelMatch(t.results[h].key,"winner")&&(i=t.results[h].value),panelMatch(t.results[h].key,"amount")&&(n=t.results[h].value);i.length>0&&$("#auctionResults").html("<strong>Results from Last Auction</strong><br>Winner: "+i+"<br>Amount Paid: "+n)}if(panelCheckQuery(t,"gambling_raffleresults")&&(i=t.results.winner,null!==i&&$("#raffleResults").html("<strong>Winner of Last Raffle: </strong>"+i)),panelCheckQuery(t,"gambling_traffleresults")&&(i=t.results.winner,null!==i&&$("#traffleResults").html("<strong>Winner of Last Ticket Raffle: </strong>"+i)),panelCheckQuery(t,"gambling_trafflemessage")&&$("#traffleMsg").val(t.results.traffleMessage),panelCheckQuery(t,"gambling_traffletimer")&&$("#traffleTimer").val(t.results.traffleMessageInterval),panelCheckQuery(t,"gambling_rafflemsgtoggle")&&panelMatch(t.results.raffleMSGToggle,"true")&&$("#raffleEnterMsg").attr("checked","checked"),panelCheckQuery(t,"gambling_trafflemsgtoggle")&&panelMatch(t.results.tRaffleMSGToggle,"true")&&$("#traffleEnterMsg").attr("checked","checked"),panelCheckQuery(t,"gambling_rafflelistentries")&&(n=t.results.raffleEntries,(null===n||void 0===n||0===n)&&$("#raffleentries").html("0"),$("#raffleentries").html(t.results.raffleEntries)),panelCheckQuery(t,"gambling_trafflelistentries")&&(n=t.results.ticketRaffleEntries,(null===n||void 0===n||0===n)&&$("#traffleentries").html("0"),$("#traffleentries").html(t.results.ticketRaffleEntries)),panelCheckQuery(t,"gambling_rafflelist")){var o=t.results,l="",u="";l="<table class='table table-hover table-striped'>";for(var h=0;h<o.length;h++)u=o[h].key,l+="<tr >    <td>"+u+"</td>    <td></tr>";l+="</table>",$("#raffleListTable").html(l)}if(panelCheckQuery(t,"gambling_trafflelist")){var c=t.results,l="",u="",f="";l="<table>";for(var h=0;h<c.length;h++)u=c[h].key,f=c[h].value,l+="<tr >    <td>"+u+"</td>    <td>"+f+"</td>    <td></tr>";l+="</table>",$("#traffleListTable").html(l)}}}function i(){sendDBKeys("gambling_rafflesettings","raffleSettings"),sendDBKeys("gambling_betresults","betresults"),sendDBKeys("gambling_auctionresults","auctionresults"),sendDBQuery("gambling_raffleresults","raffleresults","winner"),sendDBQuery("gambling_traffleresults","traffleresults","winner"),sendDBKeys("gambling_rafflelist","raffleList"),sendDBKeys("gambling_trafflelist","ticketsList"),sendDBQuery("gambling_trafflemsgtoggle","settings","tRaffleMSGToggle"),sendDBQuery("gambling_traffletimer","settings","traffleMessageInterval"),sendDBQuery("gambling_trafflemessage","settings","traffleMessage"),sendDBQuery("gambling_rafflelistentries","raffleresults","raffleEntries"),sendDBQuery("gambling_trafflelistentries","raffleresults","ticketRaffleEntries")}function n(){var e=$("#auctionIncrementInput").val(),t=$("#auctionBetInput").val(),i=$("#auctionTimerInput").val();e.length>0&&t.length>0&&(sendCommand("auction open "+e+" "+t+" "+i),$("#auctionIncrementInput").val(""),$("#auctionBetInput").val(""),$("#auctionTimerInput").val(""))}function s(){sendCommand("auction close"),setTimeout(function(){i()},2*TIMEOUT_WAIT_TIME)}function r(){var t=$("#raffle-time-keyword").val(),n=$("#raffle-time-cost").val(),s=$("#raffle-time-timer").val(),r=$("#raffle-time-regluck").val(),a=$("#raffle-time-subluck").val();(0!=t.length||0!=n.length)&&(0==a&&(a=1),0==r&&(r=1),sendDBUpdate("raffle_sub_luck","raffleSettings","subscriberBonusRaffle",String(a)),sendDBUpdate("raffle_sub_luck","raffleSettings","regularBonusRaffle",String(r)),setTimeout(function(){sendCommand("reloadraffle"),sendCommand("raffle open "+n+" "+t+" "+s+" "+e+" -usetime")},TIMEOUT_WAIT_TIME),setTimeout(function(){i()},2*TIMEOUT_WAIT_TIME),$("#raffle-time-keyword").val(""),$("#raffle-time-cost").val(""),$("#raffle-time-sub").html("1 Times"),$("#raffle-time-reg").html("1 Times"),$("#raffle-time-timer2").html("Until closed"),$("#raffle-time-timer").val("0"),$("#raffle-time-regluck").val("0"),$("#raffle-time-subluck").val("0"))}function a(){var t=$("#raffle-keyword").val(),n=$("#raffle-cost").val(),s=$("#raffle-points-timer").val(),r=$("#raffle-points-regluck").val(),a=$("#raffle-points-subluck").val();(0!=t.length||0!=n.length)&&(0==a&&(a=1),0==r&&(r=1),sendDBUpdate("raffle_sub_luck","raffleSettings","subscriberBonusRaffle",String(a)),sendDBUpdate("raffle_sub_luck","raffleSettings","regularBonusRaffle",String(r)),setTimeout(function(){sendCommand("reloadraffle"),sendCommand("raffle open "+n+" "+t+" "+s+" "+e+" -usepoints")},TIMEOUT_WAIT_TIME),setTimeout(function(){i()},2*TIMEOUT_WAIT_TIME),$("#raffle-keyword").val(""),$("#raffle-cost").val(""),$("#raffle-points-sub").html("1 Times"),$("#raffle-points-reg").html("1 Times"),$("#raffle-points-timer2").html("Until closed"),$("#raffle-points-timer").val("0"),$("#raffle-points-regluck").val("0"),$("#raffle-points-subluck").val("0"))}function o(){var t=$("#raffle-normal-keyword").val(),n=$("#raffle-normal-timer").val(),s=$("#raffle-normal-regluck").val(),r=$("#raffle-normal-subluck").val();0!=t.length&&(0==r&&(r=1),0==s&&(s=1),sendDBUpdate("raffle_sub_luck","raffleSettings","subscriberBonusRaffle",String(r)),sendDBUpdate("raffle_sub_luck","raffleSettings","regularBonusRaffle",String(s)),setTimeout(function(){sendCommand("reloadraffle"),sendCommand("raffle open "+t+" "+n+" "+e)},TIMEOUT_WAIT_TIME),setTimeout(function(){i()},2*TIMEOUT_WAIT_TIME),$("#raffle-normal-keyword").val(""),$("#raffle-normal-subluck2").html("1 Times"),$("#raffle-normal-regluck2").html("1 Times"),$("#raffle-normal-timer2").html("Until closed"),$("#raffle-normal-timer").val("0"),$("#raffle-normal-regluck").val("0"),$("#raffle-normal-subluck").val("0"),document.getElementById("raffle-normal-regluck").value=0,document.getElementById("raffle-normal-subluck").value=0,document.getElementById("raffle-normal-timer").value=0)}function l(){var e=$("#raffle-message-input").val(),t=$("#raffle-message-timer").val();sendDBUpdate("raffle_settings_set","raffleSettings","raffleMessage",e),sendDBUpdate("raffle_settings_set","raffleSettings","raffleMessageInterval",String(t)),setTimeout(function(){i(),sendCommand("reloadraffle")},2*TIMEOUT_WAIT_TIME)}function u(){sendCommand("raffle close"),setTimeout(function(){i()},TIMEOUT_WAIT_TIME)}function h(){sendCommand("raffle repick"),setTimeout(function(){i()},TIMEOUT_WAIT_TIME)}function c(t){e="followers"==t?"-followers":"subscribers"==t?"-subscribers":""}function f(e,t,n){sendDBUpdate("dropdown_set",e,t,n),sendCommand("reloadraffle"),setTimeout(function(){i()},2*TIMEOUT_WAIT_TIME)}function d(){sendCommand("traffle repick"),setTimeout(function(){i()},2*TIMEOUT_WAIT_TIME)}function p(){sendCommand("traffle close"),setTimeout(function(){i()},2*TIMEOUT_WAIT_TIME)}function m(){var e=$("#traffleMaxInput").val(),t=$("#traffleCostInput").val(),i=$("#traffleFollowerInput:checked").val();e.length>0&&t.length>0&&(sendCommand("traffle open "+e+" "+t+" "+i),$("#traffleMaxInput").val(""),$("#traffleCostInput").val(""),$("#traffleFollowerInput:checkbox").removeAttr("checked"))}function g(){$("#traffleEnterMsg").attr("checked","checked");$("#traffleEnterMsg").is(":checked")===!0?sendDBUpdate("gambling_trafflemsgtoggle","settings","tRaffleMSGToggle","true"):sendDBUpdate("gambling_trafflemsgtoggle","settings","tRaffleMSGToggle","false"),setTimeout(function(){sendCommand("reloadtraffle")},TIMEOUT_WAIT_TIME)}function v(e){var t=$("#"+e).val();"traffleMsg"==e&&sendDBUpdate("gambling_trafflemessage","settings","traffleMessage",t),"traffleTimer"==e&&sendDBUpdate("gambling_trafflemessage","settings","traffleMessageInterval",t),setTimeout(function(){sendCommand("reloadtraffle")},TIMEOUT_WAIT_TIME)}var e;$("#gamblingPanel").load("/panel/gambling.html");var y=setInterval(function(){if(isConnected&&TABS_INITIALIZED){var e=$("#tabs").tabs("option","active");14==e&&(i(),clearInterval(y))}},INITIAL_WAIT_TIME);setInterval(function(){var e=$("#tabs").tabs("option","active");14==e&&isConnected&&!isInputFocus()&&(newPanelAlert("Refreshing Gambling Data","success",1e3),i())},2e4),$.gamblingOnMessage=t,$.gamblingDoQuery=i,$.auctionOpen=n,$.auctionClose=s,$.traffleRepick=d,$.traffleOpen=m,$.traffleClose=p,$.toggleTRaffleMsg=g,$.updateTRaffleSettings=v,$.setEligibility=c,$.raffle={openTime:r,openPoints:a,openNormal:o,end:u,repick:h,settings:l,set:f}}();