!function(){function i(i){var n;try{n=JSON.parse(i.data)}catch(a){return void console.error("Failed to parse panel message [discordPanel.js]: "+a.message)}if(panelCheckQuery(n,"discord_gambling"))for(t in n.results)$("#gamble_"+n.results[t].key).val(n.results[t].value);if(panelCheckQuery(n,"discord_slotmachine"))for(t in n.results)$("#discordSlotRewards"+t+"Input").val(n.results[t].value);if(panelCheckQuery(n,"discord_roll"))for(t in n.results)$("#discordRollRewards"+t+"Input").val(n.results[t].value);if(panelCheckQuery(n,"discord_slotmachineemojis"))for(t in n.results)$("#slotEmoji"+t+"Input").val(n.results[t].value);if(panelCheckQuery(n,"discord_settings")){var o=n.results;for(t in o)"true"!==o[t].value&&"false"!==o[t].value?$("#"+o[t].key+"Input").val(o[t].value):$("#"+o[t].key+"Input").html(e[o[t].value])}if(panelCheckQuery(n,"discord_keywords")){var o=n.results,s="<table>";if(0===o.length)return void $("#keyword-list").html("<i>There are no keywords defined.</i>");for(t in o){var r=o[t].key,l=o[t].value;s+='<tr style="textList">    <td style="width: 15%">'+(r.length>10?r.substring(0,10)+"...":r)+'</td>    <td style="vertical-align: middle">        <form onkeypress="return event.keyCode != 13">            <input style="width: 90%" type="text" id="editKeyword_'+r.replace(/[^a-zA-Z0-9_]/g,"_SPC_")+'"                   value="'+l+'" />              <button style="float: right;" type="button" class="btn btn-default btn-xs" id="removeKeyword_'+r.replace(/[^a-zA-Z0-9_]/g,"_SPC_")+'" onclick="$.removeKeyword(\''+r+'\')"><i class="fa fa-trash" /> </button>              <button style="float: right;" type="button" class="btn btn-default btn-xs" onclick="$.editKeyword(\''+r+'\')"><i class="fa fa-pencil" /> </button>              </form>        </form>    </td></tr>'}s+="</table>",$("#keyword-list").html(s)}if(panelCheckQuery(n,"discord_commands")){var h,c,d,f,p,m,g,o=n.results,s='<table class="table table-hover table-striped"><tr><th>Command</th><th>Response</th><th>Cooldown</th><th style="float: right;"></td>',u={};if(0===o.length)return void $("#commands-list").html("<i>There are no commands defined.</i>");for(t in o)"discordPermcom"==o[t].table?void 0===u[o[t].key]?u[o[t].key]={permission:o[t].value}:u[o[t].key].permission=o[t].value:"discordCooldown"==o[t].table?void 0===u[o[t].key]?u[o[t].key]={cooldown:JSON.parse(o[t].value).seconds,isGlobal:"true"==JSON.parse(o[t].value).isGlobal}:(u[o[t].key].cooldown=JSON.parse(o[t].value).seconds,u[o[t].key].isGlobal="true"==JSON.parse(o[t].value).isGlobal):"discordChannelcom"==o[t].table?void 0===u[o[t].key]?u[o[t].key]={channel:o[t].value}:u[o[t].key].channel=o[t].value:"discordPricecom"==o[t].table?void 0===u[o[t].key]?u[o[t].key]={cost:o[t].value}:u[o[t].key].cost=o[t].value:"discordAliascom"==o[t].table&&(void 0===u[o[t].key]?u[o[t].key]={alias:o[t].value}:u[o[t].key].alias=o[t].value);for(t in o)"discordCommands"==o[t].table&&(p=o[t].key,f=o[t].value,h=u[p].permission,m=void 0!==u[p]&&void 0===u[p].channel?"":u[p].channel,d=void 0!==u[p]&&void 0===u[p].cooldown?0:u[p].cooldown,c=void 0!==u[p]&&void 0===u[p].cost?0:u[p].cost,g=void 0!==u[p]&&void 0===u[p].isGlobal?!0:u[p].isGlobal,s+="<tr><td>!"+(p.length>10?p.substring(0,10)+"...":p)+"</td><td>"+(f.length>50?f.substring(0,50)+"...":f)+"</td><td>"+d+' sec </td><td><button type="button" class="btn btn-info btn-fill btn-xs" onclick="$.openCommandModal(\''+p+"', '"+f+"', '"+h+"', '"+c+"', '"+d+"', '"+m+"', '"+g+'\')"><i class="fa fa-pencil" /> </button><button type="button" id="delete_command_'+p.replace(/[^a-z1-9_]/gi,"_")+'" class="btn btn-info btn-fill btn-xs" onclick="$.updateDiscordCommand(\''+p+"', 'true')\"><i class=\"fa fa-trash\" /> </button></td> </tr>");s+="</table>",$("#command-list").html(s)}}function n(){sendDBKeys("discord_settings","discordSettings"),sendDBKeys("discord_keywords","discordKeywords"),sendDBKeys("discord_gambling","discordGambling"),sendDBKeys("discord_roll","discordRollReward"),sendDBKeys("discord_slotmachine","discordSlotMachineReward"),sendDBKeys("discord_slotmachineemojis","discordSlotMachineEmojis"),sendDBKeysList("discord_commands",["discordCommands","discordCooldown","discordPermcom","discordChannelcom"])}function a(e,t,i,a,o){var s=void 0!==o?o:$("#"+e).val();void 0!==o&&$("#"+e).html('<i  class="fa fa-spinner fa-spin"/>'),"string"==typeof s&&s.length>0||"number"==typeof s?("modLogs"==a&&("true"==o?sendDBUpdate("discord_update","chatModerator","moderationLogs","true"):sendDBUpdate("discord_update","chatModerator","moderationLogs","false")),sendDBUpdate("discord_update",i,a,s.toString()),setTimeout(function(){sendWSEvent("discord","./discord/"+t),n()},TIMEOUT_WAIT_TIME)):setTimeout(function(){n()},TIMEOUT_WAIT_TIME)}function o(){$("#command-name-modal").val(""),$("#command-response-modal").val(""),$("#command-permission-modal").val(""),$("#command-cooldown-modal").val(""),$("#command-channel-modal").val(),$("#command-add-name-modal").val(""),$("#command-add-response-modal").val(""),$("#command-add-permission-modal").val("0"),$("#command-add-cooldown-modal").val("0"),$("#command-add-cost-modal").val("0"),$("#command-add-channel-modal").val(""),$("#command-add-global").prop("checked",!0),$("#command-edit-global").prop("checked",!0)}function s(e,t){if("string"==typeof t?"true"==t:1==t)$("#delete_command_"+e.replace(/[^a-z1-9_]/gi,"_")).html('<i  class="fa fa-spinner fa-spin"/>'),sendDBDelete("discord_command","discordCommands",e),sendDBDelete("discord_command","discordPermcom",e),sendDBDelete("discord_command","discordCooldown",e),sendDBDelete("discord_command","discordChannelcom",e),sendDBDelete("discord_command","discordPricecom",e),sendDBDelete("discord_command","discordAliascom",e),sendWSEvent("discord","./discord/commands/customCommands.js","remove",[e]);else{var i=0===$("#command-name-modal").val().length?$("#command-add-name-modal").val():$("#command-name-modal").val(),a=0===$("#command-response-modal").val().length?$("#command-add-response-modal").val():$("#command-response-modal").val(),s=0===$("#command-permission-modal").val().length?$("#command-add-permission-modal").val():$("#command-permission-modal").val(),r=0===$("#command-cooldown-modal").val().length?$("#command-add-cooldown-modal").val():$("#command-cooldown-modal").val(),l=0===$("#command-channel-modal").val().length?$("#command-add-channel-modal").val():$("#command-channel-modal").val(),u=0===$("#command-cost-modal").val().length?$("#command-add-cost-modal").val():$("#command-cost-modal").val(),h=0===$("#command-alias-modal").val().length?$("#command-add-alias-modal").val():$("#command-alias-modal").val(),c=$("#command-add-global").is(":checked");if(0===i.length||0===a.length||i.match(/[\'\"\s]/gi)||1!=s&&0!=s)return setTimeout(function(){n(),o()},TIMEOUT_WAIT_TIME),void newPanelAlert("Could not add command !"+i+". Either the response was blank, the permission was invalid, or it contained a special symbol.","danger",1e4);i=i.replace("!","").toLowerCase(),h=h.replace("!","").toLowerCase(),sendDBUpdate("discord_command","discordCommands",i,a.toString()),sendDBUpdate("discord_command","discordPermcom",i,s.toString()),sendDBUpdate("discord_command","discordCooldown",i,JSON.stringify({command:String(i),seconds:String(r),isGlobal:String(c)})),sendDBUpdate("discord_command","discordPricecom",i,u.toString()),0===l.length&&sendDBDelete("discord_command","discordChannelcom",i),h.length>0?sendDBUpdate("discord_command","discordAliascom",i,h.toString()):sendDBDelete("discord_command","discordAliascom",i),setTimeout(function(){sendWSEvent("discord","./discord/commands/customCommands.js",null,[i,s,l,h,u])},TIMEOUT_WAIT_TIME),setTimeout(function(){sendWSEvent("discord","./discord/commands/customCommands.js",null,[i,s,l])},TIMEOUT_WAIT_TIME)}setTimeout(function(){n(),o()},TIMEOUT_WAIT_TIME)}function r(e,t,i,n,a,o,s){$("#command-name-modal").val(e),$("#command-response-modal").val(t),$("#command-permission-modal").val(i),$("#command-cooldown-modal").val(a),$("#command-channel-modal").val(o),$("#command-cost-modal").val(n),$("#command-edit-global").prop("checked","true"==s),$("#command-modal").modal()}function l(e){var t=$("#editKeyword_"+e.replace(/[^a-zA-Z0-9_]/g,"_SPC_")).val();t.length>0&&sendDBUpdate("discord_keyword","discordKeywords",e,t),setTimeout(function(){n()},TIMEOUT_WAIT_TIME)}function u(e){$("#removeKeyword_"+e.replace(/[^a-zA-Z0-9_]/g,"_SPC_")).html('<i style="color: #6136b1" class="fa fa-spinner fa-spin"/>'),sendDBDelete("discord_keyword","discordKeywords",e),setTimeout(function(){n()},TIMEOUT_WAIT_TIME)}function h(){var e=$("#custom-keyword").val(),t=$("#custom-keyword-value").val();e.length>0&&t.length>0&&sendDBUpdate("discord_keyword","discordKeywords",e,t),$("#custom-keyword").val(""),$("#custom-keyword-value").val(""),setTimeout(function(){n()},TIMEOUT_WAIT_TIME)}function c(){var e=$("#discordSlotRewards0Input").val(),t=$("#discordSlotRewards1Input").val(),i=$("#discordSlotRewards2Input").val(),a=$("#discordSlotRewards3Input").val(),o=$("#discordSlotRewards4Input").val();e.length>0&&t.length>0&&i.length>0&&a.length>0&&o.length>0&&(sendDBUpdate("slotRewards0","discordSlotMachineReward","reward_0",e),sendDBUpdate("slotRewards1","discordSlotMachineReward","reward_1",t),sendDBUpdate("slotRewards2","discordSlotMachineReward","reward_2",i),sendDBUpdate("slotRewards3","discordSlotMachineReward","reward_3",a),sendDBUpdate("slotRewards4","discordSlotMachineReward","reward_4",o),setTimeout(function(){n(),sendWSEvent("discord","./discord/games/slotMachine.js",null,null)},TIMEOUT_WAIT_TIME))}function d(){var e=$("#slotEmoji0Input").val(),t=$("#slotEmoji1Input").val(),i=$("#slotEmoji2Input").val(),a=$("#slotEmoji3Input").val(),o=$("#slotEmoji4Input").val();e.length>0&&t.length>0&&i.length>0&&a.length>0&&o.length>0&&(sendDBUpdate("slotEmojis0","discordSlotMachineEmojis","emoji_0",e),sendDBUpdate("slotEmojis1","discordSlotMachineEmojis","emoji_1",t),sendDBUpdate("slotEmojis2","discordSlotMachineEmojis","emoji_2",i),sendDBUpdate("slotEmojis3","discordSlotMachineEmojis","emoji_3",a),sendDBUpdate("slotEmojis4","discordSlotMachineEmojis","emoji_4",o),setTimeout(function(){n(),sendWSEvent("discord","./discord/games/slotMachine.js",null,null)},TIMEOUT_WAIT_TIME))}function f(){var e=$("#discordRollRewards0Input").val(),t=$("#discordRollRewards1Input").val(),i=$("#discordRollRewards2Input").val(),a=$("#discordRollRewards3Input").val(),o=$("#discordRollRewards4Input").val(),s=$("#discordRollRewards5Input").val();e.length>0&&t.length>0&&i.length>0&&a.length>0&&o.length>0&&s.length>0&&(sendDBUpdate("rollRewards0","discordRollReward","rewards_0",e),sendDBUpdate("rollRewards1","discordRollReward","rewards_1",t),sendDBUpdate("rollRewards2","discordRollReward","rewards_2",i),sendDBUpdate("rollRewards3","discordRollReward","rewards_3",a),sendDBUpdate("rollRewards4","discordRollReward","rewards_4",o),sendDBUpdate("rollRewards5","discordRollReward","rewards_5",s),setTimeout(function(){n(),sendWSEvent("discord","./discord/games/roll.js",null,null)},TIMEOUT_WAIT_TIME))}var t,e=[];e["false"]='<i  class="fa fa-circle-o" />',e["true"]='<i  class="fa fa-circle text-success" />',$("#discordPanel").load("/panel/discord.html");var p=setInterval(function(){if(isConnected&&TABS_INITIALIZED){var e=$("#tabs").tabs("option","active");18==e&&(n(),clearInterval(p))}},INITIAL_WAIT_TIME);setInterval(function(){var e=$("#tabs").tabs("option","active");18==e&&isConnected&&!isInputFocus()&&(newPanelAlert("Refreshing Discord Data","success",1e3),n())},3e4),$.updateDiscordTable=a,$.updateDiscordCommand=s,$.openCommandModal=r,$.discordOnMessage=i,$.discordDoQuery=n,$.editKeyword=l,$.removeKeyword=u,$.addKeyword=h,$.setDiscordSlotRewards=c,$.setSlotEmojis=d,$.setDiscordRollRewards=f}();