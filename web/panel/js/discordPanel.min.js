!function(){function n(n){var a;try{a=JSON.parse(n.data)}catch(s){return void console.error("Failed to parse panel message [discordPanel.js]: "+s.message)}if(panelCheckQuery(a,"discord_gambling"))for(t in a.results)$("#gamble_"+a.results[t].key).val(a.results[t].value);if(panelCheckQuery(a,"discord_slotmachine"))for(t in a.results)$("#discordSlotRewards"+t+"Input").val(a.results[t].value);if(panelCheckQuery(a,"discord_roll"))for(t in a.results)$("#discordRollRewards"+t+"Input").val(a.results[t].value);if(panelCheckQuery(a,"discord_slotmachineemojis"))for(t in a.results)$("#slotEmoji"+t+"Input").val(a.results[t].value);if(panelCheckQuery(a,"discord_settings")){var o=a.results;for(t in o)"true"!==o[t].value&&"false"!==o[t].value?$("#"+o[t].key+"Input").val(o[t].value):$("#"+o[t].key+"Input").html(e[o[t].value])}if(panelCheckQuery(a,"discord_keywords")){var o=a.results,i="<table>";if(0===o.length)return void $("#keyword-list").html("<i>There are no keywords defined.</i>");for(t in o){var r=o[t].key,l=o[t].value;i+='<tr style="textList">    <td style="width: 15%">'+(r.length>10?r.substring(0,10)+"...":r)+'</td>    <td style="vertical-align: middle">        <form onkeypress="return event.keyCode != 13">            <input style="width: 90%" type="text" id="editKeyword_'+r.replace(/[^a-zA-Z0-9_]/g,"_SPC_")+'"                   value="'+l+'" />              <button style="float: right;" type="button" class="btn btn-default btn-xs" id="removeKeyword_'+r.replace(/[^a-zA-Z0-9_]/g,"_SPC_")+'" onclick="$.removeKeyword(\''+r+'\')"><i class="fa fa-trash" /> </button>              <button style="float: right;" type="button" class="btn btn-default btn-xs" onclick="$.editKeyword(\''+r+'\')"><i class="fa fa-pencil" /> </button>              </form>        </form>    </td></tr>'}i+="</table>",$("#keyword-list").html(i)}if(panelCheckQuery(a,"discord_commands")){var c,u,m,h,f,p,g,o=a.results,i='<table class="table table-hover table-striped"><tr><th>Command</th><th>Response</th><th>Cooldown</th><th style="float: right;"></td>',d={};if(0===o.length)return void $("#commands-list").html("<i>There are no commands defined.</i>");for(t in o)"discordPermcom"==o[t].table?void 0===d[o[t].key]?d[o[t].key]={permission:o[t].value}:d[o[t].key].permission=o[t].value:"discordCooldown"==o[t].table?void 0===d[o[t].key]?d[o[t].key]={cooldown:JSON.parse(o[t].value).seconds,isGlobal:"true"==JSON.parse(o[t].value).isGlobal}:(d[o[t].key].cooldown=JSON.parse(o[t].value).seconds,d[o[t].key].isGlobal="true"==JSON.parse(o[t].value).isGlobal):"discordChannelcom"==o[t].table?void 0===d[o[t].key]?d[o[t].key]={channel:o[t].value}:d[o[t].key].channel=o[t].value:"discordPricecom"==o[t].table?void 0===d[o[t].key]?d[o[t].key]={cost:o[t].value}:d[o[t].key].cost=o[t].value:"discordAliascom"==o[t].table&&(void 0===d[o[t].key]?d[o[t].key]={alias:o[t].value}:d[o[t].key].alias=o[t].value);for(t in o)"discordCommands"==o[t].table&&(f=o[t].key,h=o[t].value,c=d[f].permission,p=void 0!==d[f]&&void 0===d[f].channel?"":d[f].channel,m=void 0!==d[f]&&void 0===d[f].cooldown?0:d[f].cooldown,u=void 0!==d[f]&&void 0===d[f].cost?0:d[f].cost,g=void 0!==d[f]&&void 0===d[f].isGlobal?!0:d[f].isGlobal,i+="<tr><td>!"+(f.length>10?f.substring(0,10)+"...":f)+"</td><td>"+(h.length>50?h.substring(0,50)+"...":h)+"</td><td>"+m+' sec </td><td><button type="button" class="btn btn-info btn-fill btn-xs" onclick="$.openCommandModal(\''+f+"', '"+h+"', '"+c+"', '"+u+"', '"+m+"', '"+p+"', '"+g+'\')"><i class="fa fa-pencil" /> </button><button type="button" id="delete_command_'+f.replace(/[^a-z1-9_]/gi,"_")+'" class="btn btn-info btn-fill btn-xs" onclick="$.updateDiscordCommand(\''+f+"', 'true')\"><i class=\"fa fa-trash\" /> </button></td> </tr>");i+="</table>",$("#command-list").html(i)}}function a(){sendDBKeys("discord_settings","discordSettings"),sendDBKeys("discord_keywords","discordKeywords"),sendDBKeys("discord_gambling","discordGambling"),sendDBKeys("discord_roll","discordRollReward"),sendDBKeys("discord_slotmachine","discordSlotMachineReward"),sendDBKeys("discord_slotmachineemojis","discordSlotMachineEmojis"),sendDBKeysList("discord_commands",["discordCommands","discordCooldown","discordPermcom","discordChannelcom"])}function s(e,t,n,s,o){var i=void 0!==o?o:$("#"+e).val();void 0!==o&&$("#"+e).html('<i  class="fa fa-spinner fa-spin"/>'),"string"==typeof i&&i.length>0||"number"==typeof i?("modLogs"==s&&("true"==o?sendDBUpdate("discord_update","chatModerator","moderationLogs","true"):sendDBUpdate("discord_update","chatModerator","moderationLogs","false")),sendDBUpdate("discord_update",n,s,i.toString()),setTimeout(function(){sendWSEvent("discord","./discord/"+t),a()},TIMEOUT_WAIT_TIME)):setTimeout(function(){a()},TIMEOUT_WAIT_TIME)}function o(){$("#command-name-modal").val(""),$("#command-response-modal").val(""),$("#command-permission-modal").val(""),$("#command-cooldown-modal").val(""),$("#command-channel-modal").val(),$("#command-add-name-modal").val(""),$("#command-add-response-modal").val(""),$("#command-add-permission-modal").val("0"),$("#command-add-cooldown-modal").val("0"),$("#command-add-cost-modal").val("0"),$("#command-add-channel-modal").val(""),$("#command-add-global").prop("checked",!0),$("#command-edit-global").prop("checked",!0)}function i(e,t){if("string"==typeof t?"true"==t:1==t)$("#delete_command_"+e.replace(/[^a-z1-9_]/gi,"_")).html('<i  class="fa fa-spinner fa-spin"/>'),sendDBDelete("discord_command","discordCommands",e),sendDBDelete("discord_command","discordPermcom",e),sendDBDelete("discord_command","discordCooldown",e),sendDBDelete("discord_command","discordChannelcom",e),sendDBDelete("discord_command","discordPricecom",e),sendDBDelete("discord_command","discordAliascom",e),sendWSEvent("discord","./discord/commands/customCommands.js","remove",[e]);else{var n=0===$("#command-name-modal").val().length?$("#command-add-name-modal").val():$("#command-name-modal").val(),s=0===$("#command-response-modal").val().length?$("#command-add-response-modal").val():$("#command-response-modal").val(),i=0===$("#command-permission-modal").val().length?$("#command-add-permission-modal").val():$("#command-permission-modal").val(),r=0===$("#command-cooldown-modal").val().length?$("#command-add-cooldown-modal").val():$("#command-cooldown-modal").val(),l=0===$("#command-channel-modal").val().length?$("#command-add-channel-modal").val():$("#command-channel-modal").val(),d=0===$("#command-cost-modal").val().length?$("#command-add-cost-modal").val():$("#command-cost-modal").val(),c=0===$("#command-alias-modal").val().length?$("#command-add-alias-modal").val():$("#command-alias-modal").val(),u=$("#command-add-global").is(":checked");if(0===n.length||0===s.length||n.match(/[\'\"\s]/gi)||1!=i&&0!=i)return setTimeout(function(){a(),o()},TIMEOUT_WAIT_TIME),void newPanelAlert("Could not add command !"+n+". Either the response was blank, the permission was invalid, or it contained a special symbol.","danger",1e4);n=n.replace("!","").toLowerCase(),c=c.replace("!","").toLowerCase(),sendDBUpdate("discord_command","discordCommands",n,s.toString()),sendDBUpdate("discord_command","discordPermcom",n,i.toString()),sendDBUpdate("discord_command","discordCooldown",n,JSON.stringify({command:String(n),seconds:String(r),isGlobal:String(u)})),sendDBUpdate("discord_command","discordPricecom",n,d.toString()),0===l.length&&sendDBDelete("discord_command","discordChannelcom",n),c.length>0?sendDBUpdate("discord_command","discordAliascom",n,c.toString()):sendDBDelete("discord_command","discordAliascom",n),setTimeout(function(){sendWSEvent("discord","./discord/commands/customCommands.js",null,[n,i,l,c,d])},TIMEOUT_WAIT_TIME),setTimeout(function(){sendWSEvent("discord","./discord/commands/customCommands.js",null,[n,i,l])},TIMEOUT_WAIT_TIME)}setTimeout(function(){a(),o()},TIMEOUT_WAIT_TIME)}function r(e,t,n,a,s,o,i){$("#command-name-modal").val(e),$("#command-response-modal").val(t),$("#command-permission-modal").val(n),$("#command-cooldown-modal").val(s),$("#command-channel-modal").val(o),$("#command-cost-modal").val(a),$("#command-edit-global").prop("checked","true"==i),$("#command-modal").modal()}function l(e){var t=$("#editKeyword_"+e.replace(/[^a-zA-Z0-9_]/g,"_SPC_")).val();t.length>0&&sendDBUpdate("discord_keyword","discordKeywords",e,t),setTimeout(function(){a()},TIMEOUT_WAIT_TIME)}function d(e){$("#removeKeyword_"+e.replace(/[^a-zA-Z0-9_]/g,"_SPC_")).html('<i style="color: #6136b1" class="fa fa-spinner fa-spin"/>'),sendDBDelete("discord_keyword","discordKeywords",e),setTimeout(function(){a()},TIMEOUT_WAIT_TIME)}function c(){var e=$("#custom-keyword").val(),t=$("#custom-keyword-value").val();e.length>0&&t.length>0&&sendDBUpdate("discord_keyword","discordKeywords",e,t),$("#custom-keyword").val(""),$("#custom-keyword-value").val(""),setTimeout(function(){a()},TIMEOUT_WAIT_TIME)}function u(){var e=$("#discordSlotRewards0Input").val(),t=$("#discordSlotRewards1Input").val(),n=$("#discordSlotRewards2Input").val(),s=$("#discordSlotRewards3Input").val(),o=$("#discordSlotRewards4Input").val();e.length>0&&t.length>0&&n.length>0&&s.length>0&&o.length>0&&(sendDBUpdate("slotRewards0","discordSlotMachineReward","reward_0",e),sendDBUpdate("slotRewards1","discordSlotMachineReward","reward_1",t),sendDBUpdate("slotRewards2","discordSlotMachineReward","reward_2",n),sendDBUpdate("slotRewards3","discordSlotMachineReward","reward_3",s),sendDBUpdate("slotRewards4","discordSlotMachineReward","reward_4",o),setTimeout(function(){a(),sendWSEvent("discord","./discord/games/slotMachine.js",null,null)},TIMEOUT_WAIT_TIME))}function m(){var e=$("#slotEmoji0Input").val(),t=$("#slotEmoji1Input").val(),n=$("#slotEmoji2Input").val(),s=$("#slotEmoji3Input").val(),o=$("#slotEmoji4Input").val();e.length>0&&t.length>0&&n.length>0&&s.length>0&&o.length>0&&(sendDBUpdate("slotEmojis0","discordSlotMachineEmojis","emoji_0",e),sendDBUpdate("slotEmojis1","discordSlotMachineEmojis","emoji_1",t),sendDBUpdate("slotEmojis2","discordSlotMachineEmojis","emoji_2",n),sendDBUpdate("slotEmojis3","discordSlotMachineEmojis","emoji_3",s),sendDBUpdate("slotEmojis4","discordSlotMachineEmojis","emoji_4",o),setTimeout(function(){a(),sendWSEvent("discord","./discord/games/slotMachine.js",null,null)},TIMEOUT_WAIT_TIME))}function h(){var e=$("#discordRollRewards0Input").val(),t=$("#discordRollRewards1Input").val(),n=$("#discordRollRewards2Input").val(),s=$("#discordRollRewards3Input").val(),o=$("#discordRollRewards4Input").val(),i=$("#discordRollRewards5Input").val();e.length>0&&t.length>0&&n.length>0&&s.length>0&&o.length>0&&i.length>0&&(sendDBUpdate("rollRewards0","discordRollReward","rewards_0",e),sendDBUpdate("rollRewards1","discordRollReward","rewards_1",t),sendDBUpdate("rollRewards2","discordRollReward","rewards_2",n),sendDBUpdate("rollRewards3","discordRollReward","rewards_3",s),sendDBUpdate("rollRewards4","discordRollReward","rewards_4",o),sendDBUpdate("rollRewards5","discordRollReward","rewards_5",i),setTimeout(function(){a(),sendWSEvent("discord","./discord/games/roll.js",null,null)},TIMEOUT_WAIT_TIME))}var t,e=[];e["false"]='<i  class="fa fa-circle text-warning" />',e["true"]='<i  class="fa fa-circle text-success" />',$("#discordPanel").load("/panel/discord.html");var f=setInterval(function(){if(isConnected&&TABS_INITIALIZED){var e=$("#tabs").tabs("option","active");18==e&&(a(),clearInterval(f))}},INITIAL_WAIT_TIME);setInterval(function(){var e=$("#tabs").tabs("option","active");18==e&&isConnected&&!isInputFocus()&&(newPanelAlert("Refreshing Discord Data","success",1e3),a())},3e4),$.updateDiscordTable=s,$.updateDiscordCommand=i,$.openCommandModal=r,$.discordOnMessage=n,$.discordDoQuery=a,$.editKeyword=l,$.removeKeyword=d,$.addKeyword=c,$.setDiscordSlotRewards=u,$.setSlotEmojis=m,$.setDiscordRollRewards=h}();