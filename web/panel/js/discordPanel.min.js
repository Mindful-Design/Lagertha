!function(){function i(i){var s;try{s=JSON.parse(i.data)}catch(n){return void console.error("Failed to parse panel message [discordPanel.js]: "+n.message)}if(panelCheckQuery(s,"discord_gambling"))for(t in s.results)$("#gamble_"+s.results[t].key).val(s.results[t].value);if(panelCheckQuery(s,"discord_slotmachine"))for(t in s.results)$("#discordSlotRewards"+t+"Input").val(s.results[t].value);if(panelCheckQuery(s,"discord_roll"))for(t in s.results)$("#discordRollRewards"+t+"Input").val(s.results[t].value);if(panelCheckQuery(s,"discord_slotmachineemojis"))for(t in s.results)$("#slotEmoji"+t+"Input").val(s.results[t].value);if(panelCheckQuery(s,"discord_settings")){var a=s.results;for(t in a)"true"!==a[t].value&&"false"!==a[t].value?$("#"+a[t].key+"Input").val(a[t].value):$("#"+a[t].key+"Input").html(e[a[t].value])}if(panelCheckQuery(s,"discord_keywords")){var a=s.results,r="<table>";if(0===a.length)return void $("#keyword-list").html("<i>There are no keywords defined.</i>");for(t in a){var o=a[t].key,l=a[t].value;r+='<tr style="textList">    <td style="width: 15%">'+(o.length>10?o.substring(0,10)+"...":o)+'</td>    <td style="vertical-align: middle">        <form onkeypress="return event.keyCode != 13">            <input style="width: 90%" type="text" id="editKeyword_'+o.replace(/[^a-zA-Z0-9_]/g,"_SPC_")+'"                   value="'+l+'" />              <button style="float: right;" type="button" class="btn btn-default btn-xs" id="removeKeyword_'+o.replace(/[^a-zA-Z0-9_]/g,"_SPC_")+'" onclick="$.removeKeyword(\''+o+'\')"><i class="fa fa-trash" /> </button>              <button style="float: right;" type="button" class="btn btn-default btn-xs" onclick="$.editKeyword(\''+o+'\')"><i class="fa fa-pencil" /> </button>              </form>        </form>    </td></tr>'}r+="</table>",$("#keyword-list").html(r)}if(panelCheckQuery(s,"discord_commands")){var h,c,f,d,p,m,g,a=s.results,r='<table class="table table-hover table-striped"><tr><th>Command</th><th>Response</th><th>Cooldown</th><th style="float: right;"></td>',u={};if(0===a.length)return void $("#commands-list").html("<i>There are no commands defined.</i>");for(t in a)"discordPermcom"==a[t].table?void 0===u[a[t].key]?u[a[t].key]={permission:a[t].value}:u[a[t].key].permission=a[t].value:"discordCooldown"==a[t].table?void 0===u[a[t].key]?u[a[t].key]={cooldown:JSON.parse(a[t].value).seconds,isGlobal:"true"==JSON.parse(a[t].value).isGlobal}:(u[a[t].key].cooldown=JSON.parse(a[t].value).seconds,u[a[t].key].isGlobal="true"==JSON.parse(a[t].value).isGlobal):"discordChannelcom"==a[t].table?void 0===u[a[t].key]?u[a[t].key]={channel:a[t].value}:u[a[t].key].channel=a[t].value:"discordPricecom"==a[t].table?void 0===u[a[t].key]?u[a[t].key]={cost:a[t].value}:u[a[t].key].cost=a[t].value:"discordAliascom"==a[t].table&&(void 0===u[a[t].key]?u[a[t].key]={alias:a[t].value}:u[a[t].key].alias=a[t].value);for(t in a)"discordCommands"==a[t].table&&(p=a[t].key,d=a[t].value,h=u[p].permission,m=void 0!==u[p]&&void 0===u[p].channel?"":u[p].channel,f=void 0!==u[p]&&void 0===u[p].cooldown?0:u[p].cooldown,c=void 0!==u[p]&&void 0===u[p].cost?0:u[p].cost,g=void 0!==u[p]&&void 0===u[p].isGlobal?!0:u[p].isGlobal,r+="<tr><td>!"+(p.length>10?p.substring(0,10)+"...":p)+"</td><td>"+(d.length>50?d.substring(0,50)+"...":d)+"</td><td>"+f+' sec </td><td><button type="button" class="btn btn-info btn-fill btn-xs" onclick="$.openCommandModal(\''+p+"', '"+d+"', '"+h+"', '"+c+"', '"+f+"', '"+m+"', '"+g+'\')"><i class="fa fa-pencil" /> </button><button type="button" id="delete_command_'+p.replace(/[^a-z1-9_]/gi,"_")+'" class="btn btn-info btn-fill btn-xs" onclick="$.updateDiscordCommand(\''+p+"', 'true')\"><i class=\"fa fa-trash\" /> </button></td> </tr>");r+="</table>",$("#command-list").html(r)}}function s(){sendDBKeys("discord_settings","discordSettings"),sendDBKeys("discord_keywords","discordKeywords"),sendDBKeys("discord_gambling","discordGambling"),sendDBKeys("discord_roll","discordRollReward"),sendDBKeys("discord_slotmachine","discordSlotMachineReward"),sendDBKeys("discord_slotmachineemojis","discordSlotMachineEmojis"),sendDBKeysList("discord_commands",["discordCommands","discordCooldown","discordPermcom","discordChannelcom"])}function n(e,t,i,n,a){var r=void 0!==a?a:$("#"+e).val();void 0!==a&&$("#"+e).html('<i  class="fa fa-spinner fa-spin"/>'),"string"==typeof r&&r.length>0||"number"==typeof r?("modLogs"==n&&("true"==a?sendDBUpdate("discord_update","chatModerator","moderationLogs","true"):sendDBUpdate("discord_update","chatModerator","moderationLogs","false")),sendDBUpdate("discord_update",i,n,r.toString()),setTimeout(function(){sendWSEvent("discord","./discord/"+t),s()},TIMEOUT_WAIT_TIME)):setTimeout(function(){s()},TIMEOUT_WAIT_TIME)}function a(){$("#command-name-modal").val(""),$("#command-response-modal").val(""),$("#command-permission-modal").val(""),$("#command-cooldown-modal").val(""),$("#command-channel-modal").val(),$("#command-add-name-modal").val(""),$("#command-add-response-modal").val(""),$("#command-add-permission-modal").val("0"),$("#command-add-cooldown-modal").val("0"),$("#command-add-cost-modal").val("0"),$("#command-add-channel-modal").val(""),$("#command-add-global").prop("checked",!0),$("#command-edit-global").prop("checked",!0)}function r(e,t){if("string"==typeof t?"true"==t:1==t)$("#delete_command_"+e.replace(/[^a-z1-9_]/gi,"_")).html('<i  class="fa fa-spinner fa-spin"/>'),sendDBDelete("discord_command","discordCommands",e),sendDBDelete("discord_command","discordPermcom",e),sendDBDelete("discord_command","discordCooldown",e),sendDBDelete("discord_command","discordChannelcom",e),sendDBDelete("discord_command","discordPricecom",e),sendDBDelete("discord_command","discordAliascom",e),sendWSEvent("discord","./discord/commands/customCommands.js","remove",[e]);else{var i=0===$("#command-name-modal").val().length?$("#command-add-name-modal").val():$("#command-name-modal").val(),n=0===$("#command-response-modal").val().length?$("#command-add-response-modal").val():$("#command-response-modal").val(),r=0===$("#command-permission-modal").val().length?$("#command-add-permission-modal").val():$("#command-permission-modal").val(),o=0===$("#command-cooldown-modal").val().length?$("#command-add-cooldown-modal").val():$("#command-cooldown-modal").val(),l=0===$("#command-channel-modal").val().length?$("#command-add-channel-modal").val():$("#command-channel-modal").val(),u=0===$("#command-cost-modal").val().length?$("#command-add-cost-modal").val():$("#command-cost-modal").val(),h=0===$("#command-alias-modal").val().length?$("#command-add-alias-modal").val():$("#command-alias-modal").val(),c=$("#command-add-global").is(":checked");if(0===i.length||0===n.length||i.match(/[\'\"\s]/gi)||1!=r&&0!=r)return setTimeout(function(){s(),a()},TIMEOUT_WAIT_TIME),void newPanelAlert("Could not add command !"+i+". Either the response was blank, the permission was invalid, or it contained a special symbol.","danger",1e4);i=i.replace("!","").toLowerCase(),h=h.replace("!","").toLowerCase(),sendDBUpdate("discord_command","discordCommands",i,n.toString()),sendDBUpdate("discord_command","discordPermcom",i,r.toString()),sendDBUpdate("discord_command","discordCooldown",i,JSON.stringify({command:String(i),seconds:String(o),isGlobal:String(c)})),sendDBUpdate("discord_command","discordPricecom",i,u.toString()),0===l.length&&sendDBDelete("discord_command","discordChannelcom",i),h.length>0?sendDBUpdate("discord_command","discordAliascom",i,h.toString()):sendDBDelete("discord_command","discordAliascom",i),setTimeout(function(){sendWSEvent("discord","./discord/commands/customCommands.js",null,[i,r,l,h,u])},TIMEOUT_WAIT_TIME),setTimeout(function(){sendWSEvent("discord","./discord/commands/customCommands.js",null,[i,r,l])},TIMEOUT_WAIT_TIME)}setTimeout(function(){s(),a()},TIMEOUT_WAIT_TIME)}function o(e,t,i,s,n,a,r){$("#command-name-modal").val(e),$("#command-response-modal").val(t),$("#command-permission-modal").val(i),$("#command-cooldown-modal").val(n),$("#command-channel-modal").val(a),$("#command-cost-modal").val(s),$("#command-edit-global").prop("checked","true"==r),$("#command-modal").modal()}function l(e){var t=$("#editKeyword_"+e.replace(/[^a-zA-Z0-9_]/g,"_SPC_")).val();t.length>0&&sendDBUpdate("discord_keyword","discordKeywords",e,t),setTimeout(function(){s()},TIMEOUT_WAIT_TIME)}function u(e){$("#removeKeyword_"+e.replace(/[^a-zA-Z0-9_]/g,"_SPC_")).html('<i style="color: #6136b1" class="fa fa-spinner fa-spin"/>'),sendDBDelete("discord_keyword","discordKeywords",e),setTimeout(function(){s()},TIMEOUT_WAIT_TIME)}function h(){var e=$("#custom-keyword").val(),t=$("#custom-keyword-value").val();e.length>0&&t.length>0&&sendDBUpdate("discord_keyword","discordKeywords",e,t),$("#custom-keyword").val(""),$("#custom-keyword-value").val(""),setTimeout(function(){s()},TIMEOUT_WAIT_TIME)}function c(){var e=$("#discordSlotRewards0Input").val(),t=$("#discordSlotRewards1Input").val(),i=$("#discordSlotRewards2Input").val(),n=$("#discordSlotRewards3Input").val(),a=$("#discordSlotRewards4Input").val();e.length>0&&t.length>0&&i.length>0&&n.length>0&&a.length>0&&(sendDBUpdate("slotRewards0","discordSlotMachineReward","reward_0",e),sendDBUpdate("slotRewards1","discordSlotMachineReward","reward_1",t),sendDBUpdate("slotRewards2","discordSlotMachineReward","reward_2",i),sendDBUpdate("slotRewards3","discordSlotMachineReward","reward_3",n),sendDBUpdate("slotRewards4","discordSlotMachineReward","reward_4",a),setTimeout(function(){s(),sendWSEvent("discord","./discord/games/slotMachine.js",null,null)},TIMEOUT_WAIT_TIME))}function f(){var e=$("#slotEmoji0Input").val(),t=$("#slotEmoji1Input").val(),i=$("#slotEmoji2Input").val(),n=$("#slotEmoji3Input").val(),a=$("#slotEmoji4Input").val();e.length>0&&t.length>0&&i.length>0&&n.length>0&&a.length>0&&(sendDBUpdate("slotEmojis0","discordSlotMachineEmojis","emoji_0",e),sendDBUpdate("slotEmojis1","discordSlotMachineEmojis","emoji_1",t),sendDBUpdate("slotEmojis2","discordSlotMachineEmojis","emoji_2",i),sendDBUpdate("slotEmojis3","discordSlotMachineEmojis","emoji_3",n),sendDBUpdate("slotEmojis4","discordSlotMachineEmojis","emoji_4",a),setTimeout(function(){s(),sendWSEvent("discord","./discord/games/slotMachine.js",null,null)},TIMEOUT_WAIT_TIME))}function d(){var e=$("#discordRollRewards0Input").val(),t=$("#discordRollRewards1Input").val(),i=$("#discordRollRewards2Input").val(),n=$("#discordRollRewards3Input").val(),a=$("#discordRollRewards4Input").val(),r=$("#discordRollRewards5Input").val();e.length>0&&t.length>0&&i.length>0&&n.length>0&&a.length>0&&r.length>0&&(sendDBUpdate("rollRewards0","discordRollReward","rewards_0",e),sendDBUpdate("rollRewards1","discordRollReward","rewards_1",t),sendDBUpdate("rollRewards2","discordRollReward","rewards_2",i),sendDBUpdate("rollRewards3","discordRollReward","rewards_3",n),sendDBUpdate("rollRewards4","discordRollReward","rewards_4",a),sendDBUpdate("rollRewards5","discordRollReward","rewards_5",r),setTimeout(function(){s(),sendWSEvent("discord","./discord/games/roll.js",null,null)},TIMEOUT_WAIT_TIME))}var t,e=[];e["false"]='<i  class="fa fa-circle text-warning" />',e["true"]='<i  class="fa fa-circle text-success" />',$("#discordPanel").load("/panel/discord.html");var p=setInterval(function(){if(isConnected&&TABS_INITIALIZED){var e=$("#tabs").tabs("option","active");18==e&&(s(),clearInterval(p))}},INITIAL_WAIT_TIME);setInterval(function(){var e=$("#tabs").tabs("option","active");18==e&&isConnected&&!isInputFocus()&&(newPanelAlert("Refreshing Discord Data","success",1e3),s())},3e4),$.updateDiscordTable=n,$.updateDiscordCommand=r,$.openCommandModal=o,$.discordOnMessage=i,$.discordDoQuery=s,$.editKeyword=l,$.removeKeyword=u,$.addKeyword=h,$.setDiscordSlotRewards=c,$.setSlotEmojis=f,$.setDiscordRollRewards=d}();