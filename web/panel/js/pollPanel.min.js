!function(){function e(e){var t,i="",a="",n="",o="",r=[],s="",l=[],u="",h="";try{t=JSON.parse(e.data)}catch(c){return}if(panelHasQuery(t)&&panelCheckQuery(t,"poll_results")){if(0===t.results.length)return void $("#pollLastResults").html("<i>No Previous Poll Results</i>");for(idx in t.results)panelMatch(t.results[idx].key,"question")&&(a=t.results[idx].value),panelMatch(t.results[idx].key,"result")&&(h=t.results[idx].value),panelMatch(t.results[idx].key,"votes")&&(n=t.results[idx].value),panelMatch(t.results[idx].key,"options")&&(o=t.results[idx].value),panelMatch(t.results[idx].key,"counts")&&(s=t.results[idx].value),panelMatch(t.results[idx].key,"istie")&&(u=t.results[idx].value);i+="<strong>Question:</strong> "+a+"<br><strong>Result:</strong> "+(panelMatch(u,"true")?"Tie!":h)+"<br><br><strong>Votes:</strong><br><br>",r=o.split(","),l=s.split(","),i+='<table class="table table-hover table-striped"><tr>';for(idx in r)i+="<td>"+r[idx]+"</td>";i+="</tr><tr>";for(idx in l)i+="<td>"+l[idx]+"</td>";i+="</tr></table>",$("#pollLastResults").html(i)}}function t(){sendDBKeys("poll_results","pollresults")}function i(){var e=$("#pollQuestionInput").val(),t=$("#pollOptionsInput").val(),i=$("#pollLengthInput").val(),a=$("#pollMinVotesInput").val();0===i.length&&(i="60"),0===a.length&&(a="1"),e.length>0&&t.length>0&&(sendCommand('poll open "'+e+'" "'+t+'" '+i+" "+a),$("#pollQuestionInput").val(""),$("#pollOptionsInput").val(""),$("#pollLengthInput").val(""),$("#pollMinVotesInput").val(""))}function a(){sendCommand("poll close"),setTimeout(function(){t()},TIMEOUT_WAIT_TIME)}$("#pollPanel").load("/panel/poll.html");var n=setInterval(function(){if(isConnected&&TABS_INITIALIZED){var e=$("#tabs").tabs("option","active");16==e&&(t(),clearInterval(n))}},INITIAL_WAIT_TIME);setInterval(function(){var e=$("#tabs").tabs("option","active");16==e&&isConnected&&!isInputFocus()&&(newPanelAlert("Refreshing Poll Data","success",1e3),t())},3e4),$.pollOnMessage=e,$.pollDoQuery=t,$.openPoll=i,$.closePoll=a}();