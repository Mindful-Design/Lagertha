!function(){function e(e){var a,o="",i="",r="",n="",t=[],s="",l=[],u="",d="";try{a=JSON.parse(e.data)}catch(h){return}if(panelHasQuery(a)&&panelCheckQuery(a,"poll_results")){if(0===a.results.length)return void $("#pollLastResults").html("<i>No Previous Poll Results</i>");for(idx in a.results)panelMatch(a.results[idx].key,"question")&&(i=a.results[idx].value),panelMatch(a.results[idx].key,"result")&&(d=a.results[idx].value),panelMatch(a.results[idx].key,"votes")&&(r=a.results[idx].value),panelMatch(a.results[idx].key,"options")&&(n=a.results[idx].value),panelMatch(a.results[idx].key,"counts")&&(s=a.results[idx].value),panelMatch(a.results[idx].key,"istie")&&(u=a.results[idx].value);o+="<strong>Question:</strong> "+i+"<br><strong>Result:</strong> "+(panelMatch(u,"true")?"Tie!":d)+"<br><br><strong>Votes:</strong><br><br>",t=n.split(","),l=s.split(","),o+='<table class="table table-hover table-striped"><tr>';for(idx in t)o+="<td>"+t[idx]+"</td>";o+="</tr><tr>";for(idx in l)o+="<td>"+l[idx]+"</td>";o+="</tr></table>",$("#pollLastResults").html(o)}}function a(){sendDBKeys("poll_results","pollresults")}function o(){var e=$("#pollQuestionInput").val(),a=$("#pollOptionsInput").val(),o=$("#pollLengthInput").val(),i=$("#pollMinVotesInput").val();0===o.length&&(o="60"),0===i.length&&(i="1"),e.length>0&&a.length>0&&(sendCommand('poll open "'+e+'" "'+a+'" '+o+" "+i),$("#pollQuestionInput").val(""),$("#pollOptionsInput").val(""),$("#pollLengthInput").val(""),$("#pollMinVotesInput").val(""))}function i(){sendCommand("poll close"),setTimeout(function(){a()},TIMEOUT_WAIT_TIME)}$("#pollPanel").load("/panel/poll.html");var r=setInterval(function(){if(isConnected&&TABS_INITIALIZED){var e=$("#tabs").tabs("option","active");16==e&&(a(),clearInterval(r))}},INITIAL_WAIT_TIME);setInterval(function(){var e=$("#tabs").tabs("option","active");16==e&&isConnected&&!isInputFocus()&&(newPanelAlert("Refreshing Poll Data","success",1e3),a())},3e4),$.pollOnMessage=e,$.pollDoQuery=a,$.openPoll=o,$.closePoll=i}();