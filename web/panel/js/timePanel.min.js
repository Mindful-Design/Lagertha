!function(){function t(t){var s,l="GMT";try{s=JSON.parse(t.data)}catch(u){return}if(panelHasQuery(s)){if(panelCheckQuery(s,"time_toplist")&&$("#topListAmountTime").attr("placeholder",s.results.topListAmountTime).blur(),panelCheckQuery(s,"time_timezone")&&(void 0!=s.results.timezone&&(l=s.results.timezone),$("#setTimeZoneInput").attr("placeholder",l).blur()),panelCheckQuery(s,"time_settings"))for(k in s.results)n=s.results[k].key,panelMatch(n,"timeLevel")?(e=s.results[k].value,$("#timeLevel").html(r[e])):panelMatch(n,"keepTimeWhenOffline")?(o=s.results[k].value,$("#keepTimeWhenOffline").html(r[o])):panelMatch(n,"modTimePermToggle")?(i=s.results[k].value,$("#modTimePermToggle").html(r[i])):panelMatch(n,"timeLevelWarning")&&(a=s.results[k].value,$("#timeLevelWarning").html(r[a]));if(panelCheckQuery(s,"time_settings2"))for(k in s.results){var h="",c="";h=s.results[k].key,c=s.results[k].value,panelMatch(h,"timePromoteHours")&&$("#setTimePromotionInput").attr("placeholder",c).blur()}if(panelCheckQuery(s,"time_timetable")){var m=s.results,g="",S="",p="",y="";$("#userTimeTableTitle").html("User Time Table (Refreshing <i class='fa fa-spinner fa-spin' aria-hidden='true'></i>)"),m.sort(d),y="<table class='table table-hover table-striped' data-paging='true' data-paging-size='8'       data-filtering='true' data-filter-delay='200'       data-sorting='true'       data-paging-count-format='Rows {PF}-{PL} / {TR}' data-show-header='true'>",y+="<thead><tr>    <th data-breakpoints='xs'>Username</th>    <th data-filterable='false' data-type='number'>Time (Secs)</th>    <th data-filterable='false' data-type='number'>Time (Hrs)</th></tr></thead><tbody>";for(var k=0;k<m.length;k++)g=m[k].key,S=m[k].value,p=Math.floor(S/3600),y+="<tr onclick='$.copyUserTime(\""+g+'", "'+S+"\")' >    <td>"+g+"</td>    <td>"+S+"</td>    <td>"+p+"</td></tr>";y+="</tbody></table>",$("#userTimeTable").html(y),$(".tableTime").footable({on:{"postdraw.ft.table":function(e,a){$("#userTimeTableTitle").html("User Time Table")}}}),handleInputFocus()}}}function s(){sendDBQuery("time_timezone","settings","timezone"),sendDBQuery("time_toplist","settings","topListAmountTime"),sendDBKeys("time_settings2","timeSettings"),sendDBKeys("time_settings","timeSettings"),sendDBKeys("time_timetable","time")}function l(){sendDBQuery("time_timezone","settings","timezone"),sendDBQuery("time_toplist","settings","topListAmountTime"),sendDBKeys("time_settings2","timeSettings"),sendDBKeys("time_settings","timeSettings")}function u(e,a){$("#adjustUserTimeNameInput").val(e),$("#adjustUserTimeSecsInput").val(a)}function d(e,a){return panelStrcmp(e.key,a.key)}function h(n,r){$("#"+n).html('<i  class="fa fa-spinner fa-spin" />'),"modTimePermToggle"==r&&("false"==i?sendDBUpdate("time_toggles","timeSettings",r,"true"):sendDBUpdate("time_toggles","timeSettings",r,"false")),"keepTimeWhenOffline"==r&&("false"==o?sendDBUpdate("time_toggles","timeSettings",r,"true"):sendDBUpdate("time_toggles","timeSettings",r,"false")),"timeLevel"==r&&("false"==e?sendDBUpdate("time_toggles","timeSettings",r,"true"):sendDBUpdate("time_toggles","timeSettings",r,"false")),"timeLevelWarning"==r&&("false"==a?sendDBUpdate("time_toggles","timeSettings",r,"true"):sendDBUpdate("time_toggles","timeSettings",r,"false")),setTimeout(function(){sendCommand("updatetimesettings")},TIMEOUT_WAIT_TIME),setTimeout(function(){l()},TIMEOUT_WAIT_TIME)}function c(){var e=$("#setTimePromotionInput").val();e.length>0&&(sendDBUpdate("time_toggles","timeSettings","timePromoteHours",e),$("#setTimePromtionInput").val(""),$("#setTimePromotionInput").attr("placeholder","Submitting").blur(),setTimeout(function(){l()},TIMEOUT_WAIT_TIME))}function m(){var e=$("#setTimeZoneInput").val();e.length>0&&(sendDBUpdate("time_toggles","settings","timezone",e),$("#setTimeZoneInput").val(""),$("#setTimeZoneInput").attr("placeholder","Submitting").blur(),setTimeout(function(){l()},TIMEOUT_WAIT_TIME))}function g(e){var a=$("#adjustUserTimeNameInput").val(),o=$("#adjustUserTimeSecsInput").val();"take"==e&&a.length>0&&o.length>0&&sendDBDecr("times","time",a,o),"add"==e&&a.length>0&&o.length>0&&sendDBIncr("times","time",a,o),"set"==e&&a.length>0&&o.length>0&&sendDBUpdate("times","time",a,o),$("#adjustUserTimeNameInput").val("Submitting..."),setTimeout(function(){s()},TIMEOUT_WAIT_TIME),setTimeout(function(){$("#adjustUserTimeNameInput").val(""),$("#adjustUserTimeSecsInput").val("")},TIMEOUT_WAIT_TIME)}function S(){var e=$("#topListAmountTime").val();0!=e.length&&sendDBUpdate("time_toplist","settings","topListAmountTime",e),setTimeout(function(){l()},TIMEOUT_WAIT_TIME),setTimeout(function(){sendCommand("reloadtop")},TIMEOUT_WAIT_TIME)}var e="",a="",o="",i="",n="",r=[];r["false"]='<i class="fa fa-circle text-warning"/>',r["true"]='<i class="fa fa-circle text-success"/>',$("#timePanel").load("/panel/time.html");var p=setInterval(function(){if(isConnected&&TABS_INITIALIZED){var e=$("#tabs").tabs("option","active");5==e&&(s(),clearInterval(p))}},INITIAL_WAIT_TIME);setInterval(function(){var e=$("#tabs").tabs("option","active");5==e&&isConnected&&!isInputFocus()&&(newPanelAlert("Refreshing Time Data","success",1e3),l())},3e4),$.timeOnMessage=t,$.timeDoQuery=s,$.toggleTimeMode=h,$.setTimePromotion=c,$.setTimeZone=m,$.modifyUserTime=g,$.copyUserTime=u,$.topListTime=S}();