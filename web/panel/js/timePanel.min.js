!function(){function r(r){var s,l="GMT";try{s=JSON.parse(r.data)}catch(u){return}if(panelHasQuery(s)){if(panelCheckQuery(s,"time_toplist")&&$("#topListAmountTime").attr("placeholder",s.results.topListAmountTime).blur(),panelCheckQuery(s,"time_timezone")&&(void 0!=s.results.timezone&&(l=s.results.timezone),$("#setTimeZoneInput").attr("placeholder",l).blur()),panelCheckQuery(s,"time_settings"))for(b in s.results)n=s.results[b].key,panelMatch(n,"timeLevel")?(e=s.results[b].value,$("#timeLevel").html(o[e])):panelMatch(n,"keepTimeWhenOffline")?(i=s.results[b].value,$("#keepTimeWhenOffline").html(o[i])):panelMatch(n,"modTimePermToggle")?(a=s.results[b].value,$("#modTimePermToggle").html(o[a])):panelMatch(n,"timeLevelWarning")&&(t=s.results[b].value,$("#timeLevelWarning").html(o[t]));if(panelCheckQuery(s,"time_settings2"))for(b in s.results){var c="",d="";c=s.results[b].key,d=s.results[b].value,panelMatch(c,"timePromoteHours")&&$("#setTimePromotionInput").attr("placeholder",d).blur()}if(panelCheckQuery(s,"time_timetable")){var f=s.results,p="",m="",g="",y="";$("#userTimeTableTitle").html("User Time Table (Refreshing <i class='fa fa-spinner fa-spin' aria-hidden='true'></i>)"),f.sort(h),y="<table class='table table-hover table-striped' data-paging='true' data-paging-size='8'       data-filtering='true' data-filter-delay='200'       data-sorting='true'       data-paging-count-format='Rows {PF}-{PL} / {TR}' data-show-header='true'>",y+="<thead><tr>    <th data-breakpoints='xs'>Username</th>    <th data-filterable='false' data-type='number'>Time (Secs)</th>    <th data-filterable='false' data-type='number'>Time (Hrs)</th></tr></thead><tbody>";for(var b=0;b<f.length;b++)p=f[b].key,m=f[b].value,g=Math.floor(m/3600),y+="<tr onclick='$.copyUserTime(\""+p+'", "'+m+"\")' >    <td>"+p+"</td>    <td>"+m+"</td>    <td>"+g+"</td></tr>";y+="</tbody></table>",$("#userTimeTable").html(y),$(".tableTime").footable({on:{"postdraw.ft.table":function(e,t){$("#userTimeTableTitle").html("User Time Table")}}}),handleInputFocus()}}}function s(){sendDBQuery("time_timezone","settings","timezone"),sendDBQuery("time_toplist","settings","topListAmountTime"),sendDBKeys("time_settings2","timeSettings"),sendDBKeys("time_settings","timeSettings"),sendDBKeys("time_timetable","time")}function l(){sendDBQuery("time_timezone","settings","timezone"),sendDBQuery("time_toplist","settings","topListAmountTime"),sendDBKeys("time_settings2","timeSettings"),sendDBKeys("time_settings","timeSettings")}function u(e,t){$("#adjustUserTimeNameInput").val(e),$("#adjustUserTimeSecsInput").val(t)}function h(e,t){return panelStrcmp(e.key,t.key)}function c(n,o){$("#"+n).html('<i  class="fa fa-spinner fa-spin" />'),"modTimePermToggle"==o&&("false"==a?sendDBUpdate("time_toggles","timeSettings",o,"true"):sendDBUpdate("time_toggles","timeSettings",o,"false")),"keepTimeWhenOffline"==o&&("false"==i?sendDBUpdate("time_toggles","timeSettings",o,"true"):sendDBUpdate("time_toggles","timeSettings",o,"false")),"timeLevel"==o&&("false"==e?sendDBUpdate("time_toggles","timeSettings",o,"true"):sendDBUpdate("time_toggles","timeSettings",o,"false")),"timeLevelWarning"==o&&("false"==t?sendDBUpdate("time_toggles","timeSettings",o,"true"):sendDBUpdate("time_toggles","timeSettings",o,"false")),setTimeout(function(){sendCommand("updatetimesettings")},TIMEOUT_WAIT_TIME),setTimeout(function(){l()},TIMEOUT_WAIT_TIME)}function d(){var e=$("#setTimePromotionInput").val();e.length>0&&(sendDBUpdate("time_toggles","timeSettings","timePromoteHours",e),$("#setTimePromtionInput").val(""),$("#setTimePromotionInput").attr("placeholder","Submitting").blur(),setTimeout(function(){l()},TIMEOUT_WAIT_TIME))}function f(){var e=$("#setTimeZoneInput").val();e.length>0&&(sendDBUpdate("time_toggles","settings","timezone",e),$("#setTimeZoneInput").val(""),$("#setTimeZoneInput").attr("placeholder","Submitting").blur(),setTimeout(function(){l()},TIMEOUT_WAIT_TIME))}function p(e){var t=$("#adjustUserTimeNameInput").val(),i=$("#adjustUserTimeSecsInput").val();"take"==e&&t.length>0&&i.length>0&&sendDBDecr("times","time",t,i),"add"==e&&t.length>0&&i.length>0&&sendDBIncr("times","time",t,i),"set"==e&&t.length>0&&i.length>0&&sendDBUpdate("times","time",t,i),$("#adjustUserTimeNameInput").val("Submitting..."),setTimeout(function(){s()},TIMEOUT_WAIT_TIME),setTimeout(function(){$("#adjustUserTimeNameInput").val(""),$("#adjustUserTimeSecsInput").val("")},TIMEOUT_WAIT_TIME)}function m(){var e=$("#topListAmountTime").val();0!=e.length&&sendDBUpdate("time_toplist","settings","topListAmountTime",e),setTimeout(function(){l()},TIMEOUT_WAIT_TIME),setTimeout(function(){sendCommand("reloadtop")},TIMEOUT_WAIT_TIME)}var e="",t="",i="",a="",n="",o=[];o["false"]='<i class="fa fa-circle text-warning"/>',o["true"]='<i class="fa fa-circle text-success"/>',$("#timePanel").load("/panel/time.html");var g=setInterval(function(){if(isConnected&&TABS_INITIALIZED){var e=$("#tabs").tabs("option","active");5==e&&(s(),clearInterval(g))}},INITIAL_WAIT_TIME);setInterval(function(){var e=$("#tabs").tabs("option","active");5==e&&isConnected&&!isInputFocus()&&(newPanelAlert("Refreshing Time Data","success",1e3),l())},3e4),$.timeOnMessage=r,$.timeDoQuery=s,$.toggleTimeMode=c,$.setTimePromotion=d,$.setTimeZone=f,$.modifyUserTime=p,$.copyUserTime=u,$.topListTime=m}();