!function(){function e(e){var a;try{a=JSON.parse(e.data)}catch(i){return}if(panelHasQuery(a)){var n="",r="",t=[],s="",l="",u="",d="";if(panelCheckQuery(a,"ranks_time")&&(n=a.results.rankEligableTime,$("#customRankTimeInput").attr("placeholder",n),$("#customRankTimeInput").val("")),panelCheckQuery(a,"ranks_cost")&&(r=a.results.rankEligableCost,$("#customRankCostInput").attr("placeholder",r),$("#customRankCostInput").val("")),panelCheckQuery(a,"ranks_ranksmapping")){for(d="<br><table class='table table-hover table-striped'><th>&nbsp;&nbsp;&nbsp; Hours &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Rank Name</th></tr>",t=a.results,t.sort(o),idx=0;idx<t.length;idx++)l=t[idx].key,u=t[idx].value,d+='<tr >    <td><form onkeypress="return event.keyCode != 13">        <input type="text" id="inlineRankHoursEdit_'+l+'"               value="'+l+'" style="width: 10%"/>        <input type="text" id="inlineRankNameEdit_'+l+'"               value="'+u+'" style="width: 50%"/>        <button type="button" class="btn btn-info btn-fill btn-xs"                onclick="$.updateRank(\''+l+'\')"><i class="fa fa-pencil" />        <button type="button" class="btn btn-info btn-fill btn-xs" id="deleteRank_'+l+'"                onclick="$.deleteRank(\''+l+'\')"><i class="fa fa-trash" />        </button>    </form></td></tr>';d+="</table>",0===t.length&&(d="<i>There are no ranks presently defined</i>"),$("#ranksMapping").html(d),handleInputFocus()}if(panelCheckQuery(a,"ranks_customranks")){for(d="<br><table><tr><th /><th>User Name</th><th>Rank Name</th></tr>",t=a.results,t.sort(),idx=0;idx<t.length;idx++)s=t[idx].key,u=t[idx].value,d+='<tr >    <td>        <div id="deleteCustomRankIcon_'+s+'" class="button"             onclick="$.deleteCustomRank(\''+s+'\')"><i class="fa fa-trash" />        </div>    </td>    <td>'+s+'</td>    <td><form onkeypress="return event.keyCode != 13">        <input type="text" id="inlineRankCustomEdit_'+s+'"               value="'+u+'" style="width: 80%" />        <button type="button" class="btn btn-info btn-fill btn-xs"                onclick="$.updateCustomRank(\''+s+'\')"><i class="fa fa-pencil" />        </button>    </form></td></tr>';d+="</table>",0===t.length&&(d="<i>There are no users with custom ranks</i>"),$("#ranksCustom").html(d),handleInputFocus()}}}function a(){sendDBKeys("ranks_ranksmapping","ranksMapping"),sendDBKeys("ranks_customranks","viewerRanks"),sendDBQuery("ranks_time","settings","rankEligableTime"),sendDBQuery("ranks_cost","settings","rankEligableCost")}function o(e,a){var o=e.key,i=a.key;return parseInt(o)-parseInt(i)}function i(){var e=$("#customRankTimeInput").val();e.length>0&&($("#customRankTimeInput").val(e),sendDBUpdate("rank_time","settings","rankEligableTime",e),setTimeout(function(){a()},TIMEOUT_WAIT_TIME))}function n(){var e=$("#customRankCostInput").val();e.length>0&&($("#customRankCostInput").val(e),sendDBUpdate("rank_time","settings","rankEligableCost",e),setTimeout(function(){a()},TIMEOUT_WAIT_TIME))}function r(){var e=$("#addCustomRankUserInput").val(),o=$("#addCustomRankNameInput").val();e.length>0&&o.length>0&&($("#addCustomRankUserInput").val(""),$("#addCustomRankNameInput").val(""),sendDBUpdate("ranks_customAdd","viewerRanks",e,o),setTimeout(function(){a()},TIMEOUT_WAIT_TIME))}function t(e){var a=$("#inlineRankCustomEdit_"+e).val();sendDBUpdate("ranks_customUpdate","viewerRanks",e,a),$("#inlineRankCustomEdit_"+e).val(a)}function s(e){$("#deleteCustomRankIcon_"+e).html('<i  class="fa fa-spinner fa-spin" />'),sendDBDelete("ranks_customDelete","viewerRanks",e),setTimeout(function(){a()},TIMEOUT_WAIT_TIME)}function l(){var e=$("#addRankHoursInput").val(),o=$("#addRankNameInput").val();e.length>0&&o.length>0&&($("#addRankHoursInput").val(""),$("#addRankNameInput").val(""),sendDBUpdate("ranks_ranksAdd","ranksMapping",e,o),setTimeout(function(){a(),sendCommand("rankreloadtable")},TIMEOUT_WAIT_TIME))}function u(e){var o=$("#inlineRankNameEdit_"+e).val(),i=$("#inlineRankHoursEdit_"+e).val();sendDBDelete("ranks_ranksUpdate","ranksMapping",e),sendDBUpdate("ranks_ranksUpdate","ranksMapping",i,o),$("#inlineRankNameEdit_"+e).val(o),$("#inlineRankHoursEdit_"+e).val(i),setTimeout(function(){a(),sendCommand("rankreloadtable")},TIMEOUT_WAIT_TIME)}function d(e){$("#deleteRank_"+e).html('<i  class="fa fa-spinner fa-spin" />'),sendDBDelete("ranks_ranksDelete","ranksMapping",e),setTimeout(function(){a(),sendCommand("rankreloadtable")},TIMEOUT_WAIT_TIME)}$("#ranksPanel").load("/panel/ranks.html");var h=setInterval(function(){if(isConnected&&TABS_INITIALIZED){var e=$("#tabs").tabs("option","active");4==e&&(a(),clearInterval(h))}},INITIAL_WAIT_TIME);setInterval(function(){var e=$("#tabs").tabs("option","active");4==e&&isConnected&&!isInputFocus()&&(newPanelAlert("Refreshing Ranks Data","success",1e3),a())},3e4),$.ranksOnMessage=e,$.ranksDoQuery=a,$.updateCustomRank=t,$.deleteCustomRank=s,$.addCustomRank=r,$.updateRank=u,$.deleteRank=d,$.addRank=l,$.updateCustomRankTime=i,$.updateCustomRankCost=n}();