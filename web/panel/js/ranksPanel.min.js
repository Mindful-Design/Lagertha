!function(){function e(e){var t;try{t=JSON.parse(e.data)}catch(a){return}if(panelHasQuery(t)){var n="",o="",r=[],s="",l="",u="",h="";if(panelCheckQuery(t,"ranks_time")&&(n=t.results.rankEligableTime,$("#customRankTimeInput").attr("placeholder",n),$("#customRankTimeInput").val("")),panelCheckQuery(t,"ranks_cost")&&(o=t.results.rankEligableCost,$("#customRankCostInput").attr("placeholder",o),$("#customRankCostInput").val("")),panelCheckQuery(t,"ranks_ranksmapping")){for(h="<br><table class='table table-hover table-striped'><th>&nbsp;&nbsp;&nbsp; Hours &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Rank Name</th></tr>",r=t.results,r.sort(i),idx=0;idx<r.length;idx++)l=r[idx].key,u=r[idx].value,h+='<tr >    <td><form onkeypress="return event.keyCode != 13">        <input type="text" id="inlineRankHoursEdit_'+l+'"               value="'+l+'" style="width: 10%"/>        <input type="text" id="inlineRankNameEdit_'+l+'"               value="'+u+'" style="width: 50%"/>        <button type="button" class="btn btn-info btn-fill btn-xs"                onclick="$.updateRank(\''+l+'\')"><i class="fa fa-pencil" />        <button type="button" class="btn btn-info btn-fill btn-xs" id="deleteRank_'+l+'"                onclick="$.deleteRank(\''+l+'\')"><i class="fa fa-trash" />        </button>    </form></td></tr>';h+="</table>",0===r.length&&(h="<i>There are no ranks presently defined</i>"),$("#ranksMapping").html(h),handleInputFocus()}if(panelCheckQuery(t,"ranks_customranks")){for(h="<br><table><tr><th /><th>User Name</th><th>Rank Name</th></tr>",r=t.results,r.sort(),idx=0;idx<r.length;idx++)s=r[idx].key,u=r[idx].value,h+='<tr >    <td>        <div id="deleteCustomRankIcon_'+s+'" class="button"             onclick="$.deleteCustomRank(\''+s+'\')"><i class="fa fa-trash" />        </div>    </td>    <td>'+s+'</td>    <td><form onkeypress="return event.keyCode != 13">        <input type="text" id="inlineRankCustomEdit_'+s+'"               value="'+u+'" style="width: 80%" />        <button type="button" class="btn btn-info btn-fill btn-xs"                onclick="$.updateCustomRank(\''+s+'\')"><i class="fa fa-pencil" />        </button>    </form></td></tr>';h+="</table>",0===r.length&&(h="<i>There are no users with custom ranks</i>"),$("#ranksCustom").html(h),handleInputFocus()}}}function t(){sendDBKeys("ranks_ranksmapping","ranksMapping"),sendDBKeys("ranks_customranks","viewerRanks"),sendDBQuery("ranks_time","settings","rankEligableTime"),sendDBQuery("ranks_cost","settings","rankEligableCost")}function i(e,t){var i=e.key,a=t.key;return parseInt(i)-parseInt(a)}function a(){var e=$("#customRankTimeInput").val();e.length>0&&($("#customRankTimeInput").val(e),sendDBUpdate("rank_time","settings","rankEligableTime",e),setTimeout(function(){t()},TIMEOUT_WAIT_TIME))}function n(){var e=$("#customRankCostInput").val();e.length>0&&($("#customRankCostInput").val(e),sendDBUpdate("rank_time","settings","rankEligableCost",e),setTimeout(function(){t()},TIMEOUT_WAIT_TIME))}function o(){var e=$("#addCustomRankUserInput").val(),i=$("#addCustomRankNameInput").val();e.length>0&&i.length>0&&($("#addCustomRankUserInput").val(""),$("#addCustomRankNameInput").val(""),sendDBUpdate("ranks_customAdd","viewerRanks",e,i),setTimeout(function(){t()},TIMEOUT_WAIT_TIME))}function r(e){var t=$("#inlineRankCustomEdit_"+e).val();sendDBUpdate("ranks_customUpdate","viewerRanks",e,t),$("#inlineRankCustomEdit_"+e).val(t)}function s(e){$("#deleteCustomRankIcon_"+e).html('<i  class="fa fa-spinner fa-spin" />'),sendDBDelete("ranks_customDelete","viewerRanks",e),setTimeout(function(){t()},TIMEOUT_WAIT_TIME)}function l(){var e=$("#addRankHoursInput").val(),i=$("#addRankNameInput").val();e.length>0&&i.length>0&&($("#addRankHoursInput").val(""),$("#addRankNameInput").val(""),sendDBUpdate("ranks_ranksAdd","ranksMapping",e,i),setTimeout(function(){t(),sendCommand("rankreloadtable")},TIMEOUT_WAIT_TIME))}function u(e){var i=$("#inlineRankNameEdit_"+e).val(),a=$("#inlineRankHoursEdit_"+e).val();sendDBDelete("ranks_ranksUpdate","ranksMapping",e),sendDBUpdate("ranks_ranksUpdate","ranksMapping",a,i),$("#inlineRankNameEdit_"+e).val(i),$("#inlineRankHoursEdit_"+e).val(a),setTimeout(function(){t(),sendCommand("rankreloadtable")},TIMEOUT_WAIT_TIME)}function h(e){$("#deleteRank_"+e).html('<i  class="fa fa-spinner fa-spin" />'),sendDBDelete("ranks_ranksDelete","ranksMapping",e),setTimeout(function(){t(),sendCommand("rankreloadtable")},TIMEOUT_WAIT_TIME)}$("#ranksPanel").load("/panel/ranks.html");var c=setInterval(function(){if(isConnected&&TABS_INITIALIZED){var e=$("#tabs").tabs("option","active");4==e&&(t(),clearInterval(c))}},INITIAL_WAIT_TIME);setInterval(function(){var e=$("#tabs").tabs("option","active");4==e&&isConnected&&!isInputFocus()&&(newPanelAlert("Refreshing Ranks Data","success",1e3),t())},3e4),$.ranksOnMessage=e,$.ranksDoQuery=t,$.updateCustomRank=r,$.deleteCustomRank=s,$.addCustomRank=o,$.updateRank=u,$.deleteRank=h,$.addRank=l,$.updateCustomRankTime=a,$.updateCustomRankCost=n}();